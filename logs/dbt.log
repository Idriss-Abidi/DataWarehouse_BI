[0m12:21:08.001490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E21657FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E216563C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E21657A70>]}


============================== 12:21:08.005532 | 20b65a4d-df47-4e7e-af2a-9503aacad60b ==============================
[0m12:21:08.005532 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:21:08.005532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:21:08.030119 [info ] [MainThread]: dbt version: 1.8.3
[0m12:21:08.036313 [info ] [MainThread]: python version: 3.12.2
[0m12:21:08.037343 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m12:21:08.039673 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m12:21:08.172418 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m12:21:08.172418 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m12:21:08.172418 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m12:21:08.172418 [info ] [MainThread]: adapter type: postgres
[0m12:21:08.172418 [info ] [MainThread]: adapter version: 1.8.2
[0m12:21:08.339321 [info ] [MainThread]: Configuration:
[0m12:21:08.339321 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:21:08.339321 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:21:08.339321 [info ] [MainThread]: Required dependencies:
[0m12:21:08.339321 [debug] [MainThread]: Executing "git --help"
[0m12:21:08.423687 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:21:08.425699 [debug] [MainThread]: STDERR: "b''"
[0m12:21:08.426700 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:21:08.427700 [info ] [MainThread]: Connection:
[0m12:21:08.429703 [info ] [MainThread]:   host: localhost
[0m12:21:08.430700 [info ] [MainThread]:   port: 5432
[0m12:21:08.431700 [info ] [MainThread]:   user: driss
[0m12:21:08.432702 [info ] [MainThread]:   database: res
[0m12:21:08.434728 [info ] [MainThread]:   schema: public
[0m12:21:08.435756 [info ] [MainThread]:   connect_timeout: 10
[0m12:21:08.437220 [info ] [MainThread]:   role: None
[0m12:21:08.440037 [info ] [MainThread]:   search_path: None
[0m12:21:08.442047 [info ] [MainThread]:   keepalives_idle: 0
[0m12:21:08.444047 [info ] [MainThread]:   sslmode: None
[0m12:21:08.445067 [info ] [MainThread]:   sslcert: None
[0m12:21:08.447048 [info ] [MainThread]:   sslkey: None
[0m12:21:08.449524 [info ] [MainThread]:   sslrootcert: None
[0m12:21:08.451518 [info ] [MainThread]:   application_name: dbt
[0m12:21:08.452521 [info ] [MainThread]:   retries: 1
[0m12:21:08.453518 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:21:08.455637 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:21:08.605339 [debug] [MainThread]: Using postgres connection "debug"
[0m12:21:08.605339 [debug] [MainThread]: On debug: select 1 as id
[0m12:21:08.605339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:08.689539 [debug] [MainThread]: SQL status: SELECT 1 in 0.080 seconds
[0m12:21:08.689539 [debug] [MainThread]: On debug: Close
[0m12:21:08.701052 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:21:08.703301 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:21:08.703301 [debug] [MainThread]: Command `dbt debug` succeeded at 12:21:08.703301 after 1.03 seconds
[0m12:21:08.706339 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:21:08.706339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E21397BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2168B2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2151A570>]}
[0m12:21:08.706339 [debug] [MainThread]: Flushing usage events
[0m12:25:07.909186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A626F4DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A625004A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6276D820>]}


============================== 12:25:07.917259 | e5e4b308-8e9d-4b20-8e68-7ce40fb9b493 ==============================
[0m12:25:07.917259 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:25:07.917770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:08.456829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5e4b308-8e9d-4b20-8e68-7ce40fb9b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A60300920>]}
[0m12:25:08.602753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5e4b308-8e9d-4b20-8e68-7ce40fb9b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A624956A0>]}
[0m12:25:08.604264 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:25:08.622324 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:25:08.625846 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:25:08.627860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e5e4b308-8e9d-4b20-8e68-7ce40fb9b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6299C830>]}
[0m12:25:12.193029 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.genre' which was not found
[0m12:25:12.197278 [debug] [MainThread]: Command `dbt run` failed at 12:25:12.195805 after 4.67 seconds
[0m12:25:12.197784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A61B7C980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A63FBA240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6299D790>]}
[0m12:25:12.199032 [debug] [MainThread]: Flushing usage events
[0m12:26:02.092124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23856B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23812E300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2385D1190>]}


============================== 12:26:02.100359 | 8d1cca5c-1e8c-4732-8fc7-c6831e02208c ==============================
[0m12:26:02.100359 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:26:02.102641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:26:02.481602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d1cca5c-1e8c-4732-8fc7-c6831e02208c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F238568650>]}
[0m12:26:02.585229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d1cca5c-1e8c-4732-8fc7-c6831e02208c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2380DB7A0>]}
[0m12:26:02.587231 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:26:02.600401 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:26:02.603186 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:26:02.605203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d1cca5c-1e8c-4732-8fc7-c6831e02208c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2393C3830>]}
[0m12:26:04.783874 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.film' which was not found
[0m12:26:04.787960 [debug] [MainThread]: Command `dbt run` failed at 12:26:04.786959 after 2.93 seconds
[0m12:26:04.788959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23812E300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23A5D5A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23A564A10>]}
[0m12:26:04.789960 [debug] [MainThread]: Flushing usage events
[0m12:26:11.572026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7BE0CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F646960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F646810>]}


============================== 12:26:11.577861 | f506197c-c5e5-4ab4-aa56-e8c6798854ae ==============================
[0m12:26:11.577861 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:26:11.578375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:26:11.952232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f506197c-c5e5-4ab4-aa56-e8c6798854ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F821730>]}
[0m12:26:12.079919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f506197c-c5e5-4ab4-aa56-e8c6798854ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F89B1D0>]}
[0m12:26:12.080918 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:26:12.096735 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:26:12.097743 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:26:12.099335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f506197c-c5e5-4ab4-aa56-e8c6798854ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7FDAEE70>]}
[0m12:26:14.449647 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.genre' which was not found
[0m12:26:14.453080 [debug] [MainThread]: Command `dbt run` failed at 12:26:14.453080 after 3.10 seconds
[0m12:26:14.454081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7BDE63C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7FE92A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF011604A0>]}
[0m12:26:14.455082 [debug] [MainThread]: Flushing usage events
[0m12:34:56.626211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D5EFEFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D618B66C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D618B66F0>]}


============================== 12:34:56.630223 | ba5249b0-cca3-4cd8-9381-692acf73c0a2 ==============================
[0m12:34:56.630223 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:34:56.630223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:34:57.012920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba5249b0-cca3-4cd8-9381-692acf73c0a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D61B10470>]}
[0m12:34:57.173507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba5249b0-cca3-4cd8-9381-692acf73c0a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D61A39A00>]}
[0m12:34:57.174571 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:34:57.189259 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:34:57.191066 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:34:57.191066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ba5249b0-cca3-4cd8-9381-692acf73c0a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D61C4FB30>]}
[0m12:34:59.262800 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.film' which was not found
[0m12:34:59.264750 [debug] [MainThread]: Command `dbt run` failed at 12:34:59.264750 after 2.95 seconds
[0m12:34:59.264750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D615CAA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D62226E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D61C4D790>]}
[0m12:34:59.264750 [debug] [MainThread]: Flushing usage events
[0m12:35:13.336808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1C576360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1C576570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1C576450>]}


============================== 12:35:13.336808 | eaf1dba1-2254-4954-86e8-64c936f24b97 ==============================
[0m12:35:13.336808 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:35:13.336808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:35:13.721539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaf1dba1-2254-4954-86e8-64c936f24b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1C220F50>]}
[0m12:35:13.849586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaf1dba1-2254-4954-86e8-64c936f24b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1C7F32F0>]}
[0m12:35:13.849586 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:35:13.878399 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:35:13.881543 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:35:13.882798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eaf1dba1-2254-4954-86e8-64c936f24b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1B6F17C0>]}
[0m12:35:16.266904 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.film' which was not found
[0m12:35:16.280588 [debug] [MainThread]: Command `dbt run` failed at 12:35:16.280040 after 3.14 seconds
[0m12:35:16.280588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B18E36EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1DF4C1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1C941C40>]}
[0m12:35:16.280588 [debug] [MainThread]: Flushing usage events
[0m12:35:35.320333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E679BBCF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67D326540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67D327FB0>]}


============================== 12:35:35.320333 | 03570196-68e3-4b17-9097-aa02c13d9033 ==============================
[0m12:35:35.320333 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:35:35.320333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:35:35.630749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03570196-68e3-4b17-9097-aa02c13d9033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67D4AD790>]}
[0m12:35:35.755998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03570196-68e3-4b17-9097-aa02c13d9033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67D567E30>]}
[0m12:35:35.758800 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:35:35.776832 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:35:35.778872 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:35:35.779938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03570196-68e3-4b17-9097-aa02c13d9033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67C63E780>]}
[0m12:35:38.097167 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.film' which was not found
[0m12:35:38.101087 [debug] [MainThread]: Command `dbt run` failed at 12:35:38.101087 after 2.99 seconds
[0m12:35:38.103099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67D4929F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67D6F18B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67EBA9280>]}
[0m12:35:38.104368 [debug] [MainThread]: Flushing usage events
[0m12:35:52.292806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B567FB95E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B567FBBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B564442720>]}


============================== 12:35:52.306212 | 714bb03b-087b-4069-a899-c4009e0a1b63 ==============================
[0m12:35:52.306212 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:35:52.308115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:52.527634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '714bb03b-087b-4069-a899-c4009e0a1b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B567C0C740>]}
[0m12:35:52.558082 [debug] [MainThread]: Command `dbt clean` succeeded at 12:35:52.558082 after 0.51 seconds
[0m12:35:52.558082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5676BDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5681601D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5677484A0>]}
[0m12:35:52.558082 [debug] [MainThread]: Flushing usage events
[0m12:36:02.662244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB43E9DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB43E9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB43EA6F0>]}


============================== 12:36:02.669259 | 7441572b-1256-412f-bdb6-0fc8bd9cd395 ==============================
[0m12:36:02.669259 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:36:02.672425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:36:03.044124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7441572b-1256-412f-bdb6-0fc8bd9cd395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB4590260>]}
[0m12:36:03.157085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7441572b-1256-412f-bdb6-0fc8bd9cd395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB3CCA2A0>]}
[0m12:36:03.157085 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:36:03.188022 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:36:03.190209 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:36:03.192309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7441572b-1256-412f-bdb6-0fc8bd9cd395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB4633F50>]}
[0m12:36:05.502777 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.film' which was not found
[0m12:36:05.502777 [debug] [MainThread]: Command `dbt run` failed at 12:36:05.502777 after 3.05 seconds
[0m12:36:05.502777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB40F54C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB4605790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB5CF1880>]}
[0m12:36:05.502777 [debug] [MainThread]: Flushing usage events
[0m12:37:09.991407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E0756F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E0756EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E0756F590>]}


============================== 12:37:09.997423 | 73582a9d-6baf-439b-9483-b13b48be35cd ==============================
[0m12:37:09.997423 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:37:09.998603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:37:10.023495 [info ] [MainThread]: dbt version: 1.8.3
[0m12:37:10.024547 [info ] [MainThread]: python version: 3.12.2
[0m12:37:10.025959 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m12:37:10.026970 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m12:37:10.151123 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m12:37:10.152124 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m12:37:10.154202 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m12:37:10.154202 [info ] [MainThread]: adapter type: postgres
[0m12:37:10.154202 [info ] [MainThread]: adapter version: 1.8.2
[0m12:37:10.324283 [info ] [MainThread]: Configuration:
[0m12:37:10.324283 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:37:10.327307 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:37:10.327307 [info ] [MainThread]: Required dependencies:
[0m12:37:10.328730 [debug] [MainThread]: Executing "git --help"
[0m12:37:10.396210 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:37:10.396210 [debug] [MainThread]: STDERR: "b''"
[0m12:37:10.396210 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:37:10.396210 [info ] [MainThread]: Connection:
[0m12:37:10.396210 [info ] [MainThread]:   host: localhost
[0m12:37:10.402725 [info ] [MainThread]:   port: 5432
[0m12:37:10.404116 [info ] [MainThread]:   user: driss
[0m12:37:10.405559 [info ] [MainThread]:   database: res
[0m12:37:10.407341 [info ] [MainThread]:   schema: public
[0m12:37:10.407341 [info ] [MainThread]:   connect_timeout: 10
[0m12:37:10.409163 [info ] [MainThread]:   role: None
[0m12:37:10.411248 [info ] [MainThread]:   search_path: None
[0m12:37:10.412260 [info ] [MainThread]:   keepalives_idle: 0
[0m12:37:10.413837 [info ] [MainThread]:   sslmode: None
[0m12:37:10.414157 [info ] [MainThread]:   sslcert: None
[0m12:37:10.416187 [info ] [MainThread]:   sslkey: None
[0m12:37:10.417188 [info ] [MainThread]:   sslrootcert: None
[0m12:37:10.418783 [info ] [MainThread]:   application_name: dbt
[0m12:37:10.420045 [info ] [MainThread]:   retries: 1
[0m12:37:10.422175 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:37:10.423185 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:37:10.582997 [debug] [MainThread]: Using postgres connection "debug"
[0m12:37:10.582997 [debug] [MainThread]: On debug: select 1 as id
[0m12:37:10.585411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:10.650360 [debug] [MainThread]: SQL status: SELECT 1 in 0.069 seconds
[0m12:37:10.650360 [debug] [MainThread]: On debug: Close
[0m12:37:10.650360 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:37:10.650360 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:37:10.650360 [debug] [MainThread]: Command `dbt debug` succeeded at 12:37:10.650360 after 0.93 seconds
[0m12:37:10.650360 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:37:10.650360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E07E5EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E07D0B2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E07CD6540>]}
[0m12:37:10.650360 [debug] [MainThread]: Flushing usage events
[0m12:38:43.373446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0A6B8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0A6B84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF076B2ED0>]}


============================== 12:38:43.373446 | 0900548d-5afc-4b0d-9a50-4509cde7356d ==============================
[0m12:38:43.373446 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:38:43.373446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:43.627026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0900548d-5afc-4b0d-9a50-4509cde7356d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0AC529C0>]}
[0m12:38:43.676801 [debug] [MainThread]: Command `dbt clean` succeeded at 12:38:43.676801 after 0.56 seconds
[0m12:38:43.677801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF08AE3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0A644EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0B047D70>]}
[0m12:38:43.678801 [debug] [MainThread]: Flushing usage events
[0m12:38:49.570974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A43C9FCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A45DB5F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A45E32C90>]}


============================== 12:38:49.574531 | 92e529c1-6484-45af-abd1-2b7c6de1cd6a ==============================
[0m12:38:49.574531 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:38:49.574531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:38:49.976664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92e529c1-6484-45af-abd1-2b7c6de1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A466EB410>]}
[0m12:38:50.103658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92e529c1-6484-45af-abd1-2b7c6de1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A46210A70>]}
[0m12:38:50.103658 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:38:50.119198 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:38:50.122069 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:38:50.123563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92e529c1-6484-45af-abd1-2b7c6de1cd6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A465E2930>]}
[0m12:38:52.396562 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.genre' which was not found
[0m12:38:52.408975 [debug] [MainThread]: Command `dbt run` failed at 12:38:52.408975 after 3.05 seconds
[0m12:38:52.410308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A464ED670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A47EE1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A46D2C890>]}
[0m12:38:52.410308 [debug] [MainThread]: Flushing usage events
[0m12:58:23.618480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A170F68A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A17CA42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A17CA6AE0>]}


============================== 12:58:23.620279 | b37ece39-5c80-4ef3-845d-72168089aaec ==============================
[0m12:58:23.620279 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:58:23.628200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:58:23.946726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b37ece39-5c80-4ef3-845d-72168089aaec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A17FD9E20>]}
[0m12:58:23.993854 [debug] [MainThread]: Command `dbt clean` succeeded at 12:58:23.993854 after 0.60 seconds
[0m12:58:23.995070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A178F6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A17E28950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A180CE330>]}
[0m12:58:23.997114 [debug] [MainThread]: Flushing usage events
[0m12:58:33.886702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234186BF320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234186BF440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234186BF560>]}


============================== 12:58:33.892396 | 7e904c3b-3021-46ac-9a3e-8c7f123b8fac ==============================
[0m12:58:33.892396 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:58:33.896920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:58:33.932026 [info ] [MainThread]: dbt version: 1.8.3
[0m12:58:33.932026 [info ] [MainThread]: python version: 3.12.2
[0m12:58:33.932026 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m12:58:33.937000 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m12:58:34.080075 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m12:58:34.080075 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m12:58:34.080075 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m12:58:34.087009 [info ] [MainThread]: adapter type: postgres
[0m12:58:34.087009 [info ] [MainThread]: adapter version: 1.8.2
[0m12:58:34.296749 [info ] [MainThread]: Configuration:
[0m12:58:34.296749 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:58:34.296749 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:58:34.301025 [info ] [MainThread]: Required dependencies:
[0m12:58:34.301025 [debug] [MainThread]: Executing "git --help"
[0m12:58:34.373448 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:58:34.373962 [debug] [MainThread]: STDERR: "b''"
[0m12:58:34.373962 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:58:34.373962 [info ] [MainThread]: Connection:
[0m12:58:34.378036 [info ] [MainThread]:   host: localhost
[0m12:58:34.378216 [info ] [MainThread]:   port: 5432
[0m12:58:34.380884 [info ] [MainThread]:   user: driss
[0m12:58:34.381447 [info ] [MainThread]:   database: res
[0m12:58:34.382493 [info ] [MainThread]:   schema: public
[0m12:58:34.383512 [info ] [MainThread]:   connect_timeout: 10
[0m12:58:34.384507 [info ] [MainThread]:   role: None
[0m12:58:34.385626 [info ] [MainThread]:   search_path: None
[0m12:58:34.386902 [info ] [MainThread]:   keepalives_idle: 0
[0m12:58:34.388092 [info ] [MainThread]:   sslmode: None
[0m12:58:34.389107 [info ] [MainThread]:   sslcert: None
[0m12:58:34.390522 [info ] [MainThread]:   sslkey: None
[0m12:58:34.391531 [info ] [MainThread]:   sslrootcert: None
[0m12:58:34.392575 [info ] [MainThread]:   application_name: dbt
[0m12:58:34.394158 [info ] [MainThread]:   retries: 1
[0m12:58:34.395220 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:58:34.397916 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:58:34.552077 [debug] [MainThread]: Using postgres connection "debug"
[0m12:58:34.557088 [debug] [MainThread]: On debug: select 1 as id
[0m12:58:34.557088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:34.628691 [debug] [MainThread]: SQL status: SELECT 1 in 0.072 seconds
[0m12:58:34.628691 [debug] [MainThread]: On debug: Close
[0m12:58:34.628691 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:58:34.628691 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:58:34.636912 [debug] [MainThread]: Command `dbt debug` succeeded at 12:58:34.635402 after 0.99 seconds
[0m12:58:34.637967 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:58:34.638978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023418070A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234190D2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234190D1040>]}
[0m12:58:34.640252 [debug] [MainThread]: Flushing usage events
[0m12:58:47.506660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001715096FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017153119280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017153119C70>]}


============================== 12:58:47.516732 | 58e05e83-55de-4a3c-8a26-5b78dccb2d64 ==============================
[0m12:58:47.516732 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:58:47.517266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m12:58:47.876199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58e05e83-55de-4a3c-8a26-5b78dccb2d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001715321BE00>]}
[0m12:58:48.019052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58e05e83-55de-4a3c-8a26-5b78dccb2d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017153411880>]}
[0m12:58:48.022006 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:58:48.044310 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:58:48.045310 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:58:48.047966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58e05e83-55de-4a3c-8a26-5b78dccb2d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171533BC830>]}
[0m12:58:50.506924 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.film' which was not found
[0m12:58:50.509931 [debug] [MainThread]: Command `dbt run` failed at 12:58:50.509931 after 3.22 seconds
[0m12:58:50.511628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171532AD4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017153B2CA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017153A705C0>]}
[0m12:58:50.511628 [debug] [MainThread]: Flushing usage events
[0m13:42:37.099577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB788F8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB92E3F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB92E1580>]}


============================== 13:42:37.107588 | 30f5b4c0-46ff-471a-bdb3-971d33afa3b8 ==============================
[0m13:42:37.107588 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:42:37.107588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:42:37.145042 [info ] [MainThread]: dbt version: 1.8.3
[0m13:42:37.145042 [info ] [MainThread]: python version: 3.12.2
[0m13:42:37.146946 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m13:42:37.146946 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m13:42:37.269444 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m13:42:37.269444 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m13:42:37.269444 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m13:42:37.269444 [info ] [MainThread]: adapter type: postgres
[0m13:42:37.285069 [info ] [MainThread]: adapter version: 1.8.2
[0m13:42:37.483613 [info ] [MainThread]: Configuration:
[0m13:42:37.483613 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:42:37.483613 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:42:37.483613 [info ] [MainThread]: Required dependencies:
[0m13:42:37.483613 [debug] [MainThread]: Executing "git --help"
[0m13:42:37.570899 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:42:37.570899 [debug] [MainThread]: STDERR: "b''"
[0m13:42:37.570899 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:42:37.570899 [info ] [MainThread]: Connection:
[0m13:42:37.570899 [info ] [MainThread]:   host: localhost
[0m13:42:37.570899 [info ] [MainThread]:   port: 5432
[0m13:42:37.580973 [info ] [MainThread]:   user: driss
[0m13:42:37.581718 [info ] [MainThread]:   database: res
[0m13:42:37.583767 [info ] [MainThread]:   schema: public
[0m13:42:37.585083 [info ] [MainThread]:   connect_timeout: 10
[0m13:42:37.586237 [info ] [MainThread]:   role: None
[0m13:42:37.588251 [info ] [MainThread]:   search_path: None
[0m13:42:37.589250 [info ] [MainThread]:   keepalives_idle: 0
[0m13:42:37.591252 [info ] [MainThread]:   sslmode: None
[0m13:42:37.592253 [info ] [MainThread]:   sslcert: None
[0m13:42:37.593967 [info ] [MainThread]:   sslkey: None
[0m13:42:37.595104 [info ] [MainThread]:   sslrootcert: None
[0m13:42:37.597150 [info ] [MainThread]:   application_name: dbt
[0m13:42:37.599319 [info ] [MainThread]:   retries: 1
[0m13:42:37.601292 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:42:37.602324 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:42:37.778786 [debug] [MainThread]: Using postgres connection "debug"
[0m13:42:37.778786 [debug] [MainThread]: On debug: select 1 as id
[0m13:42:37.778786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:42:37.969171 [debug] [MainThread]: SQL status: SELECT 1 in 0.182 seconds
[0m13:42:37.969171 [debug] [MainThread]: On debug: Close
[0m13:42:37.976935 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:42:37.976935 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:42:37.978634 [debug] [MainThread]: Command `dbt debug` succeeded at 13:42:37.978634 after 1.10 seconds
[0m13:42:37.978634 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:42:37.978634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBA370620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBA890E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB944B080>]}
[0m13:42:37.978634 [debug] [MainThread]: Flushing usage events
[0m13:43:05.472845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623FA9B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623FA9B4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623FA992E0>]}


============================== 13:43:05.478512 | 516f0ca6-0191-450a-9596-e08a536dbe15 ==============================
[0m13:43:05.478512 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:43:05.483657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:05.737485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '516f0ca6-0191-450a-9596-e08a536dbe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623FEA2930>]}
[0m13:43:05.782540 [debug] [MainThread]: Command `dbt clean` succeeded at 13:43:05.782540 after 0.52 seconds
[0m13:43:05.782540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623F30EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623FEA2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623F1BC740>]}
[0m13:43:05.782540 [debug] [MainThread]: Flushing usage events
[0m13:43:33.855994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A1265CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002299EB3E6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A1228170>]}


============================== 13:43:33.864943 | 375e1c55-21e1-49b3-a50e-4a78382b5130 ==============================
[0m13:43:33.864943 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:43:33.866448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:34.246963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '375e1c55-21e1-49b3-a50e-4a78382b5130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A094D8B0>]}
[0m13:43:34.368396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '375e1c55-21e1-49b3-a50e-4a78382b5130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A1154890>]}
[0m13:43:34.368396 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:43:34.388245 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:43:34.400258 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:43:34.402368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '375e1c55-21e1-49b3-a50e-4a78382b5130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A176F470>]}
[0m13:43:37.637606 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.film' which was not found
[0m13:43:37.639871 [debug] [MainThread]: Command `dbt run` failed at 13:43:37.639871 after 4.00 seconds
[0m13:43:37.639871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002299EB3E6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A2D32AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A1BDB440>]}
[0m13:43:37.639871 [debug] [MainThread]: Flushing usage events
[0m13:48:28.498768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A74AE9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A73F22FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7136B380>]}


============================== 13:48:28.505826 | 3d0861ce-e621-4573-9fd8-52208435e410 ==============================
[0m13:48:28.505826 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:48:28.505826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:28.885198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d0861ce-e621-4573-9fd8-52208435e410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A74C6B1A0>]}
[0m13:48:29.010865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d0861ce-e621-4573-9fd8-52208435e410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A74AEA930>]}
[0m13:48:29.013599 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:48:29.036474 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:48:29.039522 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:48:29.042044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d0861ce-e621-4573-9fd8-52208435e410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A74E0EF00>]}
[0m13:48:31.040719 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.genre' which was not found
[0m13:48:31.043042 [debug] [MainThread]: Command `dbt run` failed at 13:48:31.043042 after 2.80 seconds
[0m13:48:31.044105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A74998500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A76401A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A76413C20>]}
[0m13:48:31.044105 [debug] [MainThread]: Flushing usage events
[0m13:57:22.179873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288DFDF9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288DC682E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288DFDF9850>]}


============================== 13:57:22.184394 | 3d4dd142-a931-4501-ad90-4b1eb12de201 ==============================
[0m13:57:22.184394 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:57:22.184394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:57:22.220635 [info ] [MainThread]: dbt version: 1.8.3
[0m13:57:22.224623 [info ] [MainThread]: python version: 3.12.2
[0m13:57:22.226634 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m13:57:22.229147 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m13:57:22.379399 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m13:57:22.384439 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m13:57:22.384439 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m13:57:22.384439 [info ] [MainThread]: adapter type: postgres
[0m13:57:22.389659 [info ] [MainThread]: adapter version: 1.8.2
[0m13:57:22.626441 [info ] [MainThread]: Configuration:
[0m13:57:22.628092 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:57:22.629672 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:57:22.631332 [info ] [MainThread]: Required dependencies:
[0m13:57:22.632934 [debug] [MainThread]: Executing "git --help"
[0m13:57:22.699236 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:57:22.708958 [debug] [MainThread]: STDERR: "b''"
[0m13:57:22.708958 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:57:22.710763 [info ] [MainThread]: Connection:
[0m13:57:22.710763 [info ] [MainThread]:   host: localhost
[0m13:57:22.715285 [info ] [MainThread]:   port: 5432
[0m13:57:22.715285 [info ] [MainThread]:   user: driss
[0m13:57:22.715285 [info ] [MainThread]:   database: res
[0m13:57:22.719297 [info ] [MainThread]:   schema: public
[0m13:57:22.719297 [info ] [MainThread]:   connect_timeout: 10
[0m13:57:22.719297 [info ] [MainThread]:   role: None
[0m13:57:22.723344 [info ] [MainThread]:   search_path: None
[0m13:57:22.725276 [info ] [MainThread]:   keepalives_idle: 0
[0m13:57:22.726369 [info ] [MainThread]:   sslmode: None
[0m13:57:22.727533 [info ] [MainThread]:   sslcert: None
[0m13:57:22.729048 [info ] [MainThread]:   sslkey: None
[0m13:57:22.731061 [info ] [MainThread]:   sslrootcert: None
[0m13:57:22.732064 [info ] [MainThread]:   application_name: dbt
[0m13:57:22.734187 [info ] [MainThread]:   retries: 1
[0m13:57:22.736940 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:57:22.738950 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:57:22.923252 [debug] [MainThread]: Using postgres connection "debug"
[0m13:57:22.923252 [debug] [MainThread]: On debug: select 1 as id
[0m13:57:22.923252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:23.129094 [debug] [MainThread]: SQL status: SELECT 1 in 0.201 seconds
[0m13:57:23.130651 [debug] [MainThread]: On debug: Close
[0m13:57:23.130651 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:57:23.130651 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:57:23.130651 [debug] [MainThread]: Command `dbt debug` succeeded at 13:57:23.130651 after 1.25 seconds
[0m13:57:23.130651 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:57:23.130651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288DFA73CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288DF498B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288DFF2E750>]}
[0m13:57:23.139257 [debug] [MainThread]: Flushing usage events
[0m13:57:36.749335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA66AB9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA63342E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA66ABBB30>]}


============================== 13:57:36.749335 | 8d786a6f-f90f-46fd-994d-ebb0350838b3 ==============================
[0m13:57:36.749335 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:57:36.749335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:57:37.029163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d786a6f-f90f-46fd-994d-ebb0350838b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA66BEEA80>]}
[0m13:57:37.076024 [debug] [MainThread]: Command `dbt clean` succeeded at 13:57:37.076024 after 0.58 seconds
[0m13:57:37.077233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA669ACBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA6605E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA66CF4A10>]}
[0m13:57:37.078283 [debug] [MainThread]: Flushing usage events
[0m13:57:44.979289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9D746720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9D5D2BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9A002FC0>]}


============================== 13:57:44.982836 | 8635f83b-b3a3-4e18-9200-ba1611140d52 ==============================
[0m13:57:44.982836 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:57:44.982836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m13:57:45.353385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8635f83b-b3a3-4e18-9200-ba1611140d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9D8FB110>]}
[0m13:57:45.494612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8635f83b-b3a3-4e18-9200-ba1611140d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9CDCD130>]}
[0m13:57:45.497407 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:57:45.513892 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:57:45.515892 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:57:45.516891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8635f83b-b3a3-4e18-9200-ba1611140d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9D3F3C20>]}
[0m13:57:48.198977 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.genre' which was not found
[0m13:57:48.209166 [debug] [MainThread]: Command `dbt run` failed at 13:57:48.209166 after 3.48 seconds
[0m13:57:48.209166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9D7B9E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9F049BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9DDFEFC0>]}
[0m13:57:48.212713 [debug] [MainThread]: Flushing usage events
[0m14:14:53.154982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DD678170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DD2B2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DCF08560>]}


============================== 14:14:53.162187 | bf6b3785-bee9-4146-8f68-eabd4b2e5dd2 ==============================
[0m14:14:53.162187 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:14:53.163320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:53.572637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf6b3785-bee9-4146-8f68-eabd4b2e5dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DD7FB830>]}
[0m14:14:53.708292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf6b3785-bee9-4146-8f68-eabd4b2e5dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DD8A3EF0>]}
[0m14:14:53.710300 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:53.725627 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:14:53.727145 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:14:53.729147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf6b3785-bee9-4146-8f68-eabd4b2e5dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DD7AFBF0>]}
[0m14:14:56.194826 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.genre' which was not found
[0m14:14:56.198096 [debug] [MainThread]: Command `dbt run` failed at 14:14:56.197084 after 3.38 seconds
[0m14:14:56.198096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DD4A1E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DDE65BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DDDF4FB0>]}
[0m14:14:56.199107 [debug] [MainThread]: Flushing usage events
[0m14:15:05.050275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024220EC7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024220C8CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242213BF6B0>]}


============================== 14:15:05.059347 | 71a67e40-ea2d-4406-bb33-db0ff9718763 ==============================
[0m14:15:05.059347 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:15:05.061350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:05.321201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71a67e40-ea2d-4406-bb33-db0ff9718763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024223D542C0>]}
[0m14:15:05.369473 [debug] [MainThread]: Command `dbt clean` succeeded at 14:15:05.369473 after 0.55 seconds
[0m14:15:05.371473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024220EC7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024223D0E330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024223E59FD0>]}
[0m14:15:05.372580 [debug] [MainThread]: Flushing usage events
[0m14:15:14.862937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6B37B440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6B5F92B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D68A6F170>]}


============================== 14:15:14.868708 | 50e311d4-0e81-4ffc-a557-f16740cd2e53 ==============================
[0m14:15:14.868708 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:15:14.869707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:15:15.250757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50e311d4-0e81-4ffc-a557-f16740cd2e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6921CAA0>]}
[0m14:15:15.350391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50e311d4-0e81-4ffc-a557-f16740cd2e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6B870AA0>]}
[0m14:15:15.351353 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:15.365590 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:15:15.367600 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:15:15.369660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '50e311d4-0e81-4ffc-a557-f16740cd2e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6BDD6AE0>]}
[0m14:15:17.223085 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.film' which was not found
[0m14:15:17.226610 [debug] [MainThread]: Command `dbt run` failed at 14:15:17.225595 after 2.58 seconds
[0m14:15:17.227613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6AF409E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6CFC2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6BEB4770>]}
[0m14:15:17.228611 [debug] [MainThread]: Flushing usage events
[0m14:16:10.227238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FF7AA7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FF3E2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FEB081D0>]}


============================== 14:16:10.235324 | cb328231-d890-451a-8afa-6a285acef91b ==============================
[0m14:16:10.235324 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:16:10.236744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:16:10.630734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb328231-d890-451a-8afa-6a285acef91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FE920140>]}
[0m14:16:10.755707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb328231-d890-451a-8afa-6a285acef91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FF064EC0>]}
[0m14:16:10.760749 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:10.778902 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:16:10.785508 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:16:10.786579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cb328231-d890-451a-8afa-6a285acef91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FD331670>]}
[0m14:16:13.265557 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.genre' which was not found
[0m14:16:13.265557 [debug] [MainThread]: Command `dbt run` failed at 14:16:13.265557 after 3.27 seconds
[0m14:16:13.265557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FE58ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FF92AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2810DFA70>]}
[0m14:16:13.274403 [debug] [MainThread]: Flushing usage events
[0m14:16:19.643609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002798E4E2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027990F492B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279911CFE60>]}


============================== 14:16:19.645618 | b0207e8d-f247-4be0-a076-a690fdf03ca9 ==============================
[0m14:16:19.645618 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:16:19.645618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:16:20.016603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0207e8d-f247-4be0-a076-a690fdf03ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279912A7860>]}
[0m14:16:20.115672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0207e8d-f247-4be0-a076-a690fdf03ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027990E059A0>]}
[0m14:16:20.118889 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:20.135302 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:16:20.140337 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:16:20.140337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0207e8d-f247-4be0-a076-a690fdf03ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279912A6AE0>]}
[0m14:16:22.510887 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.genre' which was not found
[0m14:16:22.510887 [debug] [MainThread]: Command `dbt run` failed at 14:16:22.510887 after 3.11 seconds
[0m14:16:22.515401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279911CEDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279917781D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799299A420>]}
[0m14:16:22.515401 [debug] [MainThread]: Flushing usage events
[0m14:26:19.042576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3872E6ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3872E63C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3872E4C80>]}


============================== 14:26:19.051418 | 8c002575-f21f-46ca-851d-921f42942357 ==============================
[0m14:26:19.051418 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:26:19.053428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:19.383589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c002575-f21f-46ca-851d-921f42942357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3873189B0>]}
[0m14:26:19.463528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c002575-f21f-46ca-851d-921f42942357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3870845F0>]}
[0m14:26:19.463528 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:26:19.483202 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:26:19.484902 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:26:19.484902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8c002575-f21f-46ca-851d-921f42942357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3872CADE0>]}
[0m14:26:22.423443 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.film' which was not found
[0m14:26:22.428476 [debug] [MainThread]: Command `dbt run` failed at 14:26:22.428476 after 3.74 seconds
[0m14:26:22.428476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3872CB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F388B03080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F388AE8EC0>]}
[0m14:26:22.428476 [debug] [MainThread]: Flushing usage events
[0m14:26:29.129177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E767D4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E78FE3F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E7932B2F0>]}


============================== 14:26:29.138421 | 791e5f4d-e011-49c3-a490-681cfdcfc4d7 ==============================
[0m14:26:29.138421 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:26:29.141118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:29.418535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '791e5f4d-e011-49c3-a490-681cfdcfc4d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E796E9EB0>]}
[0m14:26:29.457324 [debug] [MainThread]: Command `dbt clean` succeeded at 14:26:29.457324 after 0.58 seconds
[0m14:26:29.457324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E78898D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E78845340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E78846480>]}
[0m14:26:29.457324 [debug] [MainThread]: Flushing usage events
[0m14:26:37.972229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014323766600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143236492B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014322BD3B00>]}


============================== 14:26:37.976744 | 426e99c5-e05d-4f06-a56a-db87a2c184b7 ==============================
[0m14:26:37.976744 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:26:37.982496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:26:38.323641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '426e99c5-e05d-4f06-a56a-db87a2c184b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014323940440>]}
[0m14:26:38.430262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '426e99c5-e05d-4f06-a56a-db87a2c184b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143237DDDF0>]}
[0m14:26:38.433771 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:26:38.453675 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:26:38.453675 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:26:38.458689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '426e99c5-e05d-4f06-a56a-db87a2c184b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143239B6AE0>]}
[0m14:26:40.848385 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.genre' which was not found
[0m14:26:40.853405 [debug] [MainThread]: Command `dbt run` failed at 14:26:40.852326 after 3.08 seconds
[0m14:26:40.853405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014323766600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143239418E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143238EBF20>]}
[0m14:26:40.853405 [debug] [MainThread]: Flushing usage events
[0m14:27:04.798673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93F72B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93F21FC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E941942E70>]}


============================== 14:27:04.803283 | 6e7c487c-8a1e-45d9-b62f-010cd764477c ==============================
[0m14:27:04.803283 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:27:04.808330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:04.838630 [info ] [MainThread]: dbt version: 1.8.3
[0m14:27:04.838630 [info ] [MainThread]: python version: 3.12.2
[0m14:27:04.843644 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m14:27:04.843644 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m14:27:04.968943 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m14:27:04.968943 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m14:27:04.971271 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m14:27:04.973278 [info ] [MainThread]: adapter type: postgres
[0m14:27:04.973278 [info ] [MainThread]: adapter version: 1.8.2
[0m14:27:05.163267 [info ] [MainThread]: Configuration:
[0m14:27:05.163267 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:27:05.168417 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:27:05.168417 [info ] [MainThread]: Required dependencies:
[0m14:27:05.171024 [debug] [MainThread]: Executing "git --help"
[0m14:27:05.242582 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:27:05.243595 [debug] [MainThread]: STDERR: "b''"
[0m14:27:05.245127 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:27:05.247502 [info ] [MainThread]: Connection:
[0m14:27:05.248533 [info ] [MainThread]:   host: localhost
[0m14:27:05.248533 [info ] [MainThread]:   port: 5432
[0m14:27:05.248533 [info ] [MainThread]:   user: driss
[0m14:27:05.253430 [info ] [MainThread]:   database: res
[0m14:27:05.254468 [info ] [MainThread]:   schema: public
[0m14:27:05.255479 [info ] [MainThread]:   connect_timeout: 10
[0m14:27:05.257491 [info ] [MainThread]:   role: None
[0m14:27:05.259044 [info ] [MainThread]:   search_path: None
[0m14:27:05.260072 [info ] [MainThread]:   keepalives_idle: 0
[0m14:27:05.261084 [info ] [MainThread]:   sslmode: None
[0m14:27:05.262091 [info ] [MainThread]:   sslcert: None
[0m14:27:05.264616 [info ] [MainThread]:   sslkey: None
[0m14:27:05.265614 [info ] [MainThread]:   sslrootcert: None
[0m14:27:05.266625 [info ] [MainThread]:   application_name: dbt
[0m14:27:05.268624 [info ] [MainThread]:   retries: 1
[0m14:27:05.270625 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:27:05.272138 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:27:05.423346 [debug] [MainThread]: Using postgres connection "debug"
[0m14:27:05.423346 [debug] [MainThread]: On debug: select 1 as id
[0m14:27:05.423346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:05.508533 [debug] [MainThread]: SQL status: SELECT 1 in 0.085 seconds
[0m14:27:05.513558 [debug] [MainThread]: On debug: Close
[0m14:27:05.513558 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:27:05.513558 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:27:05.518598 [debug] [MainThread]: Command `dbt debug` succeeded at 14:27:05.518598 after 0.94 seconds
[0m14:27:05.518598 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:27:05.518598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E941C97200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9409E27E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E941B63320>]}
[0m14:27:05.518598 [debug] [MainThread]: Flushing usage events
[0m14:32:27.889945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F2A23D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F8A4C6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F619E6F0>]}


============================== 14:32:27.898418 | a03fefe0-fb01-4608-9646-fb7b598a2713 ==============================
[0m14:32:27.898418 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:32:27.899609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:32:28.134140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a03fefe0-fb01-4608-9646-fb7b598a2713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F8B24A70>]}
[0m14:32:28.176041 [debug] [MainThread]: Command `dbt clean` succeeded at 14:32:28.176041 after 0.62 seconds
[0m14:32:28.176041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F8C8E900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F8CA80B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F8CAA810>]}
[0m14:32:28.176041 [debug] [MainThread]: Flushing usage events
[0m14:32:34.731334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A40EE666F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A411842FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41174D430>]}


============================== 14:32:34.738279 | 4e57f3ef-13db-4f03-bae2-bd38a0fef954 ==============================
[0m14:32:34.738279 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:32:34.742290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:32:35.072183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e57f3ef-13db-4f03-bae2-bd38a0fef954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A411C67F20>]}
[0m14:32:35.197465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e57f3ef-13db-4f03-bae2-bd38a0fef954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A411C27FB0>]}
[0m14:32:35.203029 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:32:35.218982 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:32:35.221599 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:32:35.223456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e57f3ef-13db-4f03-bae2-bd38a0fef954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4120D2DE0>]}
[0m14:32:37.677189 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.film' which was not found
[0m14:32:37.682204 [debug] [MainThread]: Command `dbt run` failed at 14:32:37.682204 after 3.16 seconds
[0m14:32:37.682204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41181CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4132F1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A411C912E0>]}
[0m14:32:37.682204 [debug] [MainThread]: Flushing usage events
[0m14:33:19.790791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA0B06600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA0B06510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA0B06570>]}


============================== 14:33:19.795344 | 54b0c5c0-3cb7-40af-b6cd-686e19b13a4b ==============================
[0m14:33:19.795344 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:33:19.795344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:33:20.142078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54b0c5c0-3cb7-40af-b6cd-686e19b13a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA0938E60>]}
[0m14:33:20.267399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54b0c5c0-3cb7-40af-b6cd-686e19b13a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA0AEA3F0>]}
[0m14:33:20.267399 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:33:20.282150 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:33:20.282150 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:33:20.291780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54b0c5c0-3cb7-40af-b6cd-686e19b13a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA11C0410>]}
[0m14:33:22.847304 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.genre' which was not found
[0m14:33:22.847304 [debug] [MainThread]: Command `dbt run` failed at 14:33:22.847304 after 3.27 seconds
[0m14:33:22.851948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA01DBB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA23E5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC9E87C7D0>]}
[0m14:33:22.852469 [debug] [MainThread]: Flushing usage events
[0m14:33:29.242430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F1A39F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F19532F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F1A2DE930>]}


============================== 14:33:29.244998 | 0b1fb888-c2ee-4c15-9dfd-1e7a42af509d ==============================
[0m14:33:29.244998 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:33:29.244998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:33:29.279291 [info ] [MainThread]: dbt version: 1.8.3
[0m14:33:29.280350 [info ] [MainThread]: python version: 3.12.2
[0m14:33:29.281819 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m14:33:29.283368 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m14:33:29.413268 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m14:33:29.413268 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m14:33:29.417600 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m14:33:29.419580 [info ] [MainThread]: adapter type: postgres
[0m14:33:29.420091 [info ] [MainThread]: adapter version: 1.8.2
[0m14:33:29.618006 [info ] [MainThread]: Configuration:
[0m14:33:29.618515 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:33:29.620537 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:33:29.620537 [info ] [MainThread]: Required dependencies:
[0m14:33:29.622047 [debug] [MainThread]: Executing "git --help"
[0m14:33:29.688766 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:33:29.689538 [debug] [MainThread]: STDERR: "b''"
[0m14:33:29.692085 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:33:29.692085 [info ] [MainThread]: Connection:
[0m14:33:29.692085 [info ] [MainThread]:   host: localhost
[0m14:33:29.695312 [info ] [MainThread]:   port: 5432
[0m14:33:29.697056 [info ] [MainThread]:   user: postgres
[0m14:33:29.699361 [info ] [MainThread]:   database: res
[0m14:33:29.700790 [info ] [MainThread]:   schema: public
[0m14:33:29.700790 [info ] [MainThread]:   connect_timeout: 10
[0m14:33:29.702302 [info ] [MainThread]:   role: None
[0m14:33:29.704321 [info ] [MainThread]:   search_path: None
[0m14:33:29.705443 [info ] [MainThread]:   keepalives_idle: 0
[0m14:33:29.706201 [info ] [MainThread]:   sslmode: None
[0m14:33:29.706201 [info ] [MainThread]:   sslcert: None
[0m14:33:29.706201 [info ] [MainThread]:   sslkey: None
[0m14:33:29.706201 [info ] [MainThread]:   sslrootcert: None
[0m14:33:29.712217 [info ] [MainThread]:   application_name: dbt
[0m14:33:29.714341 [info ] [MainThread]:   retries: 1
[0m14:33:29.715986 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:33:29.717595 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:33:29.883075 [debug] [MainThread]: Using postgres connection "debug"
[0m14:33:29.883075 [debug] [MainThread]: On debug: select 1 as id
[0m14:33:29.883075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:29.966376 [debug] [MainThread]: SQL status: SELECT 1 in 0.083 seconds
[0m14:33:29.966376 [debug] [MainThread]: On debug: Close
[0m14:33:29.970887 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:33:29.973662 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:33:29.975974 [debug] [MainThread]: Command `dbt debug` succeeded at 14:33:29.975974 after 0.97 seconds
[0m14:33:29.975974 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:33:29.977921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F1A39F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F1CFD2AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F1CC99DF0>]}
[0m14:33:29.977921 [debug] [MainThread]: Flushing usage events
[0m14:33:41.562146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB0263FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB047F4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB046CB380>]}


============================== 14:33:41.566427 | 630f1871-6cb5-4303-b829-b750ea7530d1 ==============================
[0m14:33:41.566427 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:33:41.566427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:41.958374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '630f1871-6cb5-4303-b829-b750ea7530d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB02B10A70>]}
[0m14:33:42.103337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '630f1871-6cb5-4303-b829-b750ea7530d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB04CA5BB0>]}
[0m14:33:42.106051 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:33:42.118179 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:33:42.122774 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:33:42.124351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '630f1871-6cb5-4303-b829-b750ea7530d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB05187E30>]}
[0m14:33:44.619985 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.public.genre' which was not found
[0m14:33:44.623672 [debug] [MainThread]: Command `dbt run` failed at 14:33:44.623672 after 3.29 seconds
[0m14:33:44.624940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB01FBB110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB052E74A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB068B8140>]}
[0m14:33:44.624940 [debug] [MainThread]: Flushing usage events
[0m14:43:50.347391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AAEBE4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AAF4EF1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AB0DB75F0>]}


============================== 14:43:50.357683 | 0fbdc044-0181-40e9-9c97-90f2f3e07a13 ==============================
[0m14:43:50.357683 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:43:50.357683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:43:50.646905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fbdc044-0181-40e9-9c97-90f2f3e07a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AB17EA540>]}
[0m14:43:50.690118 [debug] [MainThread]: Command `dbt clean` succeeded at 14:43:50.690118 after 0.68 seconds
[0m14:43:50.690118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AAEBE4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AB1935040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AB15B35F0>]}
[0m14:43:50.690118 [debug] [MainThread]: Flushing usage events
[0m14:43:58.126122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6C173680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6C228620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E68C1F0E0>]}


============================== 14:43:58.135232 | 872dfcb3-f381-48e2-869f-268796ae8089 ==============================
[0m14:43:58.135232 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:43:58.135232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:43:58.170401 [info ] [MainThread]: dbt version: 1.8.3
[0m14:43:58.171411 [info ] [MainThread]: python version: 3.12.2
[0m14:43:58.172773 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m14:43:58.174836 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m14:43:58.300295 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m14:43:58.305335 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m14:43:58.305335 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m14:43:58.308706 [info ] [MainThread]: adapter type: postgres
[0m14:43:58.310218 [info ] [MainThread]: adapter version: 1.8.2
[0m14:43:58.525303 [info ] [MainThread]: Configuration:
[0m14:43:58.525303 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:43:58.529218 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:43:58.531704 [info ] [MainThread]: Required dependencies:
[0m14:43:58.532216 [debug] [MainThread]: Executing "git --help"
[0m14:43:58.620729 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:43:58.622756 [debug] [MainThread]: STDERR: "b''"
[0m14:43:58.623765 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:43:58.625765 [info ] [MainThread]: Connection:
[0m14:43:58.626765 [info ] [MainThread]:   host: localhost
[0m14:43:58.627841 [info ] [MainThread]:   port: 5432
[0m14:43:58.629237 [info ] [MainThread]:   user: postgres
[0m14:43:58.631591 [info ] [MainThread]:   database: res
[0m14:43:58.633508 [info ] [MainThread]:   schema: public
[0m14:43:58.634612 [info ] [MainThread]:   connect_timeout: 10
[0m14:43:58.636257 [info ] [MainThread]:   role: None
[0m14:43:58.637882 [info ] [MainThread]:   search_path: None
[0m14:43:58.639511 [info ] [MainThread]:   keepalives_idle: 0
[0m14:43:58.641115 [info ] [MainThread]:   sslmode: None
[0m14:43:58.642848 [info ] [MainThread]:   sslcert: None
[0m14:43:58.644505 [info ] [MainThread]:   sslkey: None
[0m14:43:58.645522 [info ] [MainThread]:   sslrootcert: None
[0m14:43:58.646964 [info ] [MainThread]:   application_name: dbt
[0m14:43:58.650021 [info ] [MainThread]:   retries: 1
[0m14:43:58.652294 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:43:58.653306 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:43:58.795229 [debug] [MainThread]: Using postgres connection "debug"
[0m14:43:58.795229 [debug] [MainThread]: On debug: select 1 as id
[0m14:43:58.797749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:58.877311 [debug] [MainThread]: SQL status: SELECT 1 in 0.080 seconds
[0m14:43:58.880068 [debug] [MainThread]: On debug: Close
[0m14:43:58.880068 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:43:58.882576 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:43:58.886335 [debug] [MainThread]: Command `dbt debug` succeeded at 14:43:58.882576 after 1.00 seconds
[0m14:43:58.886335 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:43:58.886335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6B9AC2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6B9AEFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6BA9DAC0>]}
[0m14:43:58.886335 [debug] [MainThread]: Flushing usage events
[0m14:44:10.454433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C9C583E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C9C5B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C9C58590>]}


============================== 14:44:10.464100 | 5116b0c6-60d4-4ea7-8098-fb619994bd3a ==============================
[0m14:44:10.464100 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:44:10.465116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:44:10.865743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5116b0c6-60d4-4ea7-8098-fb619994bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265CA6C20C0>]}
[0m14:44:10.990408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5116b0c6-60d4-4ea7-8098-fb619994bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C7BCF170>]}
[0m14:44:10.992345 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:44:11.013869 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:44:11.016693 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:44:11.017762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5116b0c6-60d4-4ea7-8098-fb619994bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265CA0FF6B0>]}
[0m14:44:12.890173 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'res' in the 'models' section of file 'models\example\schema.yml'
[0m14:44:13.134960 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.genre' which was not found
[0m14:44:13.139981 [debug] [MainThread]: Command `dbt run` failed at 14:44:13.139981 after 2.91 seconds
[0m14:44:13.139981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C954ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265CA6EB2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265CBCFAF30>]}
[0m14:44:13.139981 [debug] [MainThread]: Flushing usage events
[0m14:44:40.614653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7176DE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7176DE960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7176DE930>]}


============================== 14:44:40.619825 | 1d991638-9bf8-4df5-a22c-e16b78cf716b ==============================
[0m14:44:40.619825 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:44:40.625203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:44:41.025792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d991638-9bf8-4df5-a22c-e16b78cf716b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7178D3230>]}
[0m14:44:41.162517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d991638-9bf8-4df5-a22c-e16b78cf716b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7173159A0>]}
[0m14:44:41.162517 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:44:41.182943 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:44:41.184732 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:44:41.186648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1d991638-9bf8-4df5-a22c-e16b78cf716b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7152C73E0>]}
[0m14:44:43.662913 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models\example\schema.yml @ sources: {'name': 'res', 'schema': 'public', 'quoting': {'database': 'res', 'schema': 'public'}, 'tables': [{'name': 'film'}, {'name': 'genre'}, {'name': 'actor'}, {'name': 'mysql_film_actor'}, {'name': 'mysql_film'}, {'name': 'csv_test'}]} - at path ['quoting']['database']: 'res' is not valid under any of the given schemas
[0m14:44:43.662913 [debug] [MainThread]: Command `dbt run` failed at 14:44:43.662913 after 3.28 seconds
[0m14:44:43.662913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C717918920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C718EDC1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C718ED42C0>]}
[0m14:44:43.670023 [debug] [MainThread]: Flushing usage events
[0m14:45:31.312775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4A15B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4787B2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4ADDCF20>]}


============================== 14:45:31.319986 | 27c22e36-50ab-4790-b6da-e94a01a02c41 ==============================
[0m14:45:31.319986 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:45:31.319986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m14:45:31.750119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27c22e36-50ab-4790-b6da-e94a01a02c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4A768440>]}
[0m14:45:31.860064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27c22e36-50ab-4790-b6da-e94a01a02c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C48BACA40>]}
[0m14:45:31.860064 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:45:31.877925 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:45:31.879935 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:45:31.879935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27c22e36-50ab-4790-b6da-e94a01a02c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4AC2C7A0>]}
[0m14:45:34.384296 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models\example\schema.yml @ sources: {'name': 'res', 'quoting': {'database': 'res', 'schema': 'public'}, 'tables': [{'name': 'film'}, {'name': 'genre'}, {'name': 'actor'}, {'name': 'mysql_film_actor'}, {'name': 'mysql_film'}, {'name': 'csv_test'}]} - at path ['quoting']['database']: 'res' is not valid under any of the given schemas
[0m14:45:34.384296 [debug] [MainThread]: Command `dbt run` failed at 14:45:34.384296 after 3.55 seconds
[0m14:45:34.389812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4A15B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4C92BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4B7515B0>]}
[0m14:45:34.389812 [debug] [MainThread]: Flushing usage events
[0m14:47:00.655344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B73EF800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B9483A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B9480F20>]}


============================== 14:47:00.662952 | 98b2fff5-43f5-4b7d-a706-de569ae527e6 ==============================
[0m14:47:00.662952 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:47:00.664950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:01.028267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98b2fff5-43f5-4b7d-a706-de569ae527e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B9CEAF00>]}
[0m14:47:01.132388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98b2fff5-43f5-4b7d-a706-de569ae527e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B9F13FB0>]}
[0m14:47:01.134395 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:47:01.162943 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:47:01.165216 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:47:01.167217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98b2fff5-43f5-4b7d-a706-de569ae527e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B9F36AE0>]}
[0m14:47:03.786016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98b2fff5-43f5-4b7d-a706-de569ae527e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B78FB560>]}
[0m14:47:03.971945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98b2fff5-43f5-4b7d-a706-de569ae527e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BB5BFAD0>]}
[0m14:47:03.974436 [info ] [MainThread]: Found 3 models, 6 sources, 415 macros
[0m14:47:03.976859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98b2fff5-43f5-4b7d-a706-de569ae527e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BB5CFA70>]}
[0m14:47:03.981400 [info ] [MainThread]: 
[0m14:47:03.983895 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:47:03.996386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m14:47:04.195639 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m14:47:04.196639 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m14:47:04.197640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:04.278798 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.081 seconds
[0m14:47:04.282128 [debug] [ThreadPool]: On list_res: Close
[0m14:47:04.284888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m14:47:04.300170 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:47:04.301179 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m14:47:04.302302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:04.387453 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m14:47:04.388456 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:47:04.389963 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:47:04.402808 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m14:47:04.406813 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m14:47:04.408656 [debug] [ThreadPool]: On list_res_public: Close
[0m14:47:04.421032 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:04.423055 [debug] [MainThread]: On master: BEGIN
[0m14:47:04.424055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:04.505760 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m14:47:04.507072 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:04.508087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:47:04.527218 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m14:47:04.530746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98b2fff5-43f5-4b7d-a706-de569ae527e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BB5E7E90>]}
[0m14:47:04.531743 [debug] [MainThread]: On master: ROLLBACK
[0m14:47:04.533780 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:04.534789 [debug] [MainThread]: On master: BEGIN
[0m14:47:04.536810 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:47:04.537809 [debug] [MainThread]: On master: COMMIT
[0m14:47:04.538949 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:04.539462 [debug] [MainThread]: On master: COMMIT
[0m14:47:04.540507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:47:04.542521 [debug] [MainThread]: On master: Close
[0m14:47:04.543530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:04.544532 [info ] [MainThread]: 
[0m14:47:04.553554 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_first_dbt_model
[0m14:47:04.555661 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:47:04.558739 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.my_first_dbt_model'
[0m14:47:04.559753 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_first_dbt_model
[0m14:47:04.580961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_first_dbt_model"
[0m14:47:04.584152 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_first_dbt_model
[0m14:47:04.794099 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_first_dbt_model"
[0m14:47:04.797321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:47:04.798332 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: BEGIN
[0m14:47:04.799901 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:04.889658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.089 seconds
[0m14:47:04.890668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:47:04.891669 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

  
    

  create  table "res"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:47:04.910806 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.018 seconds
[0m14:47:04.929500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:47:04.931015 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
alter table "res"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:47:04.934454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:47:04.985392 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m14:47:04.986396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:47:04.987394 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m14:47:04.989410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:47:05.000638 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."my_first_dbt_model__dbt_backup"
[0m14:47:05.015180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:47:05.016181 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
drop table if exists "res"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:47:05.018178 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:47:05.022743 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: Close
[0m14:47:05.025744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98b2fff5-43f5-4b7d-a706-de569ae527e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B9578CE0>]}
[0m14:47:05.027742 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.47s]
[0m14:47:05.030764 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_first_dbt_model
[0m14:47:05.031776 [debug] [Thread-1 (]: Began running node model.dbt_proj.new_film
[0m14:47:05.032772 [info ] [Thread-1 (]: 2 of 3 START sql table model public.new_film ................................... [RUN]
[0m14:47:05.035456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.my_first_dbt_model, now model.dbt_proj.new_film)
[0m14:47:05.036467 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.new_film
[0m14:47:05.042544 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.new_film"
[0m14:47:05.044658 [debug] [Thread-1 (]: Began executing node model.dbt_proj.new_film
[0m14:47:05.051789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.new_film"
[0m14:47:05.054038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:47:05.056034 [debug] [Thread-1 (]: On model.dbt_proj.new_film: BEGIN
[0m14:47:05.057036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:05.141329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.085 seconds
[0m14:47:05.142330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:47:05.144345 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */

  
    

  create  table "res"."public"."new_film__dbt_tmp"
  
  
    as
  
  (
    -- models/result/film.sql
with film_data as (
    select
        f.id,
        f.name,
        g.name as genre,
        f.release_date as date,
    from "res"."public"."film" f
    join "res"."public"."genre" g on f.genre_id = g.id
)
select * from film_data;
  );
  
[0m14:47:05.149852 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « from »
LINE 19:     from "res"."public"."film" f
             ^

[0m14:47:05.152380 [debug] [Thread-1 (]: On model.dbt_proj.new_film: ROLLBACK
[0m14:47:05.153388 [debug] [Thread-1 (]: On model.dbt_proj.new_film: Close
[0m14:47:05.169783 [debug] [Thread-1 (]: Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « from »
  LINE 19:     from "res"."public"."film" f
               ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:47:05.170826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98b2fff5-43f5-4b7d-a706-de569ae527e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BA39C710>]}
[0m14:47:05.173455 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.new_film .......................... [[31mERROR[0m in 0.14s]
[0m14:47:05.175782 [debug] [Thread-1 (]: Finished running node model.dbt_proj.new_film
[0m14:47:05.177797 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_second_dbt_model
[0m14:47:05.180306 [info ] [Thread-1 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:47:05.182316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.new_film, now model.dbt_proj.my_second_dbt_model)
[0m14:47:05.184484 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_second_dbt_model
[0m14:47:05.191018 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_second_dbt_model"
[0m14:47:05.193508 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_second_dbt_model
[0m14:47:05.202198 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_second_dbt_model"
[0m14:47:05.204212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:47:05.206208 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: BEGIN
[0m14:47:05.207208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:05.297436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.090 seconds
[0m14:47:05.298804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:47:05.300826 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

  
    

  create  table "res"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "res"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:47:05.306841 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:47:05.314385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:47:05.315386 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
alter table "res"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:47:05.317711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:47:05.322745 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m14:47:05.325016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:47:05.326027 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m14:47:05.328029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:47:05.335844 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."my_second_dbt_model__dbt_backup"
[0m14:47:05.337857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:47:05.339369 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
drop table if exists "res"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:47:05.341380 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:47:05.344770 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: Close
[0m14:47:05.346785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98b2fff5-43f5-4b7d-a706-de569ae527e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BB698E90>]}
[0m14:47:05.348784 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.16s]
[0m14:47:05.351304 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_second_dbt_model
[0m14:47:05.354711 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:05.356710 [debug] [MainThread]: On master: BEGIN
[0m14:47:05.357710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:05.457299 [debug] [MainThread]: SQL status: BEGIN in 0.100 seconds
[0m14:47:05.458313 [debug] [MainThread]: On master: COMMIT
[0m14:47:05.459823 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:05.459823 [debug] [MainThread]: On master: COMMIT
[0m14:47:05.462529 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:47:05.462529 [debug] [MainThread]: On master: Close
[0m14:47:05.464818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:05.465820 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m14:47:05.466821 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m14:47:05.467823 [debug] [MainThread]: Connection 'model.dbt_proj.my_second_dbt_model' was properly closed.
[0m14:47:05.469820 [info ] [MainThread]: 
[0m14:47:05.471564 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m14:47:05.476562 [debug] [MainThread]: Command end result
[0m14:47:05.579640 [info ] [MainThread]: 
[0m14:47:05.591568 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:47:05.595721 [info ] [MainThread]: 
[0m14:47:05.598058 [error] [MainThread]:   Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « from »
  LINE 19:     from "res"."public"."film" f
               ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:47:05.602940 [info ] [MainThread]: 
[0m14:47:05.603940 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:47:05.608060 [debug] [MainThread]: Command `dbt run` failed at 14:47:05.608060 after 5.21 seconds
[0m14:47:05.609571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B904ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B95DEDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BB5F0D40>]}
[0m14:47:05.611587 [debug] [MainThread]: Flushing usage events
[0m14:50:39.440439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537F6CEC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537F6CEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537F6CE8D0>]}


============================== 14:50:39.448520 | b4b7787a-bd87-495e-8e69-5fc96aed5f10 ==============================
[0m14:50:39.448520 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:50:39.449029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:39.826102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4b7787a-bd87-495e-8e69-5fc96aed5f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537F599B50>]}
[0m14:50:39.921228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4b7787a-bd87-495e-8e69-5fc96aed5f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537F7180B0>]}
[0m14:50:39.921228 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:50:39.948773 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:50:40.228716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:50:40.228716 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\schema.yml
[0m14:50:40.798897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4b7787a-bd87-495e-8e69-5fc96aed5f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002530103AE10>]}
[0m14:50:41.013413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4b7787a-bd87-495e-8e69-5fc96aed5f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537FE370B0>]}
[0m14:50:41.013413 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 415 macros
[0m14:50:41.014961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b7787a-bd87-495e-8e69-5fc96aed5f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537FCFB140>]}
[0m14:50:41.019042 [info ] [MainThread]: 
[0m14:50:41.019042 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:41.022270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m14:50:41.199013 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m14:50:41.199013 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m14:50:41.204054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:41.271782 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.069 seconds
[0m14:50:41.273793 [debug] [ThreadPool]: On list_res: Close
[0m14:50:41.273793 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m14:50:41.278803 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:50:41.278803 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m14:50:41.278803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:41.348671 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m14:50:41.348671 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:50:41.348671 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:50:41.358918 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m14:50:41.362563 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m14:50:41.364632 [debug] [ThreadPool]: On list_res_public: Close
[0m14:50:41.373937 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:41.373937 [debug] [MainThread]: On master: BEGIN
[0m14:50:41.378950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:41.449915 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m14:50:41.453924 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:41.453924 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:41.468844 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m14:50:41.468844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b7787a-bd87-495e-8e69-5fc96aed5f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537F2279B0>]}
[0m14:50:41.468844 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:41.468844 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:41.468844 [debug] [MainThread]: On master: BEGIN
[0m14:50:41.468844 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:50:41.468844 [debug] [MainThread]: On master: COMMIT
[0m14:50:41.468844 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:41.468844 [debug] [MainThread]: On master: COMMIT
[0m14:50:41.478931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:41.478931 [debug] [MainThread]: On master: Close
[0m14:50:41.478931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:41.481472 [info ] [MainThread]: 
[0m14:50:41.486629 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_first_dbt_model
[0m14:50:41.487803 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:50:41.488811 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.my_first_dbt_model'
[0m14:50:41.490012 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_first_dbt_model
[0m14:50:41.504575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_first_dbt_model"
[0m14:50:41.505966 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_first_dbt_model
[0m14:50:41.584353 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_first_dbt_model"
[0m14:50:41.584353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:50:41.588867 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: BEGIN
[0m14:50:41.588867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:41.765082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.176 seconds
[0m14:50:41.766920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:50:41.766920 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

  
    

  create  table "res"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:50:41.769969 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m14:50:41.790107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:50:41.790107 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
alter table "res"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:50:41.794120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:41.839035 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m14:50:41.841314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:50:41.841314 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m14:50:41.841314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:41.858680 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."my_first_dbt_model__dbt_backup"
[0m14:50:41.873840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:50:41.873840 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
drop table if exists "res"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:50:41.873840 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:50:41.878758 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: Close
[0m14:50:41.885817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7787a-bd87-495e-8e69-5fc96aed5f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537D147AA0>]}
[0m14:50:41.885817 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.39s]
[0m14:50:41.890330 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_first_dbt_model
[0m14:50:41.890330 [debug] [Thread-1 (]: Began running node model.dbt_proj.new_film
[0m14:50:41.890330 [info ] [Thread-1 (]: 2 of 3 START sql table model public.new_film ................................... [RUN]
[0m14:50:41.893840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.my_first_dbt_model, now model.dbt_proj.new_film)
[0m14:50:41.893840 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.new_film
[0m14:50:41.901582 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.new_film"
[0m14:50:41.904131 [debug] [Thread-1 (]: Began executing node model.dbt_proj.new_film
[0m14:50:41.913526 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.new_film"
[0m14:50:41.916525 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:50:41.917525 [debug] [Thread-1 (]: On model.dbt_proj.new_film: BEGIN
[0m14:50:41.919036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:42.003693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.085 seconds
[0m14:50:42.003693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:50:42.003693 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */

  
    

  create  table "res"."public"."new_film__dbt_tmp"
  
  
    as
  
  (
    -- models/result/film.sql
with film_data as (
    select
        f.id,
        f.name,
        g.name as genre,
        f.release_date as date,
    from "res"."public"."film" f
    join "res"."public"."genre" g on f.genre_id = g.id
)
select * from film_data;
  );
  
[0m14:50:42.008703 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « from »
LINE 19:     from "res"."public"."film" f
             ^

[0m14:50:42.010113 [debug] [Thread-1 (]: On model.dbt_proj.new_film: ROLLBACK
[0m14:50:42.010113 [debug] [Thread-1 (]: On model.dbt_proj.new_film: Close
[0m14:50:42.022003 [debug] [Thread-1 (]: Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « from »
  LINE 19:     from "res"."public"."film" f
               ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:50:42.022003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7787a-bd87-495e-8e69-5fc96aed5f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253016AD2B0>]}
[0m14:50:42.022003 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.new_film .......................... [[31mERROR[0m in 0.13s]
[0m14:50:42.028919 [debug] [Thread-1 (]: Finished running node model.dbt_proj.new_film
[0m14:50:42.028919 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_second_dbt_model
[0m14:50:42.032010 [info ] [Thread-1 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:50:42.032010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.new_film, now model.dbt_proj.my_second_dbt_model)
[0m14:50:42.036109 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_second_dbt_model
[0m14:50:42.044658 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_second_dbt_model"
[0m14:50:42.046950 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_second_dbt_model
[0m14:50:42.057481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_second_dbt_model"
[0m14:50:42.060970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:50:42.062701 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: BEGIN
[0m14:50:42.063757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:42.148776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m14:50:42.148776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:50:42.148776 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

  
    

  create  table "res"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "res"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:50:42.153792 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:50:42.158866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:50:42.158866 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
alter table "res"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:50:42.165197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:42.168751 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m14:50:42.168751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:50:42.168751 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m14:50:42.168751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:42.178805 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."my_second_dbt_model__dbt_backup"
[0m14:50:42.180345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:50:42.182604 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
drop table if exists "res"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:50:42.182604 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:50:42.182604 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: Close
[0m14:50:42.188034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7787a-bd87-495e-8e69-5fc96aed5f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253016AC470>]}
[0m14:50:42.189048 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.16s]
[0m14:50:42.191469 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_second_dbt_model
[0m14:50:42.193629 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:42.193629 [debug] [MainThread]: On master: BEGIN
[0m14:50:42.194847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:42.278876 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m14:50:42.278876 [debug] [MainThread]: On master: COMMIT
[0m14:50:42.278876 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:42.282183 [debug] [MainThread]: On master: COMMIT
[0m14:50:42.283207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:42.284230 [debug] [MainThread]: On master: Close
[0m14:50:42.286232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:42.287230 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m14:50:42.287230 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m14:50:42.288740 [debug] [MainThread]: Connection 'model.dbt_proj.my_second_dbt_model' was properly closed.
[0m14:50:42.289752 [info ] [MainThread]: 
[0m14:50:42.291753 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m14:50:42.294762 [debug] [MainThread]: Command end result
[0m14:50:42.359792 [info ] [MainThread]: 
[0m14:50:42.359792 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:42.366150 [info ] [MainThread]: 
[0m14:50:42.367507 [error] [MainThread]:   Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « from »
  LINE 19:     from "res"."public"."film" f
               ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:50:42.371053 [info ] [MainThread]: 
[0m14:50:42.373099 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:50:42.375098 [debug] [MainThread]: Command `dbt run` failed at 14:50:42.375098 after 3.25 seconds
[0m14:50:42.376157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537FD79A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002537FCDE960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253010D9370>]}
[0m14:50:42.376157 [debug] [MainThread]: Flushing usage events
[0m14:51:51.808858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CDE66000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CDE66780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CDE666F0>]}


============================== 14:51:51.813660 | 58c69099-17b1-4e3e-bcd3-bf709a1115dd ==============================
[0m14:51:51.813660 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:51:51.818668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:51:52.072533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58c69099-17b1-4e3e-bcd3-bf709a1115dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CDFE92E0>]}
[0m14:51:52.121682 [debug] [MainThread]: Command `dbt clean` succeeded at 14:51:52.121682 after 0.56 seconds
[0m14:51:52.122745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CDEE2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CE097E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CD3835F0>]}
[0m14:51:52.123757 [debug] [MainThread]: Flushing usage events
[0m14:51:59.608752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002381FBB2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023821FF8C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023821FFA780>]}


============================== 14:51:59.611682 | d1cf33f3-bef5-4fee-9bab-70a37e8d98ac ==============================
[0m14:51:59.611682 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:51:59.618740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:51:59.943744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1cf33f3-bef5-4fee-9bab-70a37e8d98ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382289FC20>]}
[0m14:52:00.048665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1cf33f3-bef5-4fee-9bab-70a37e8d98ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023821833C80>]}
[0m14:52:00.053707 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:00.073730 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:52:00.078200 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:52:00.079363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1cf33f3-bef5-4fee-9bab-70a37e8d98ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023822EAB740>]}
[0m14:52:02.609677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1cf33f3-bef5-4fee-9bab-70a37e8d98ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023822993230>]}
[0m14:52:02.758558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1cf33f3-bef5-4fee-9bab-70a37e8d98ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023824190CB0>]}
[0m14:52:02.758558 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 415 macros
[0m14:52:02.763564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1cf33f3-bef5-4fee-9bab-70a37e8d98ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382431C320>]}
[0m14:52:02.763564 [info ] [MainThread]: 
[0m14:52:02.768625 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:02.774337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m14:52:02.932642 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m14:52:02.934703 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m14:52:02.934703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:02.985476 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.052 seconds
[0m14:52:02.988490 [debug] [ThreadPool]: On list_res: Close
[0m14:52:02.988490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m14:52:02.998490 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:52:02.998490 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m14:52:02.998490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:03.049667 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m14:52:03.053149 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:52:03.053149 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:52:03.058861 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m14:52:03.058861 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m14:52:03.058861 [debug] [ThreadPool]: On list_res_public: Close
[0m14:52:03.068738 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:03.068738 [debug] [MainThread]: On master: BEGIN
[0m14:52:03.068738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:03.118638 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m14:52:03.118638 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:03.118638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:03.128809 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m14:52:03.129874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1cf33f3-bef5-4fee-9bab-70a37e8d98ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238241902F0>]}
[0m14:52:03.129874 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:03.129874 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:03.129874 [debug] [MainThread]: On master: BEGIN
[0m14:52:03.133815 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:52:03.133815 [debug] [MainThread]: On master: COMMIT
[0m14:52:03.135497 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:03.135497 [debug] [MainThread]: On master: COMMIT
[0m14:52:03.135497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:03.137716 [debug] [MainThread]: On master: Close
[0m14:52:03.138727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:03.140273 [info ] [MainThread]: 
[0m14:52:03.145450 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_first_dbt_model
[0m14:52:03.146457 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:52:03.148554 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.my_first_dbt_model'
[0m14:52:03.149562 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_first_dbt_model
[0m14:52:03.160661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_first_dbt_model"
[0m14:52:03.163772 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_first_dbt_model
[0m14:52:03.241696 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_first_dbt_model"
[0m14:52:03.244889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:52:03.247699 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: BEGIN
[0m14:52:03.248715 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:03.325676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m14:52:03.327676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:52:03.328617 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */

  
    

  create  table "res"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:52:03.333746 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m14:52:03.347478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:52:03.348982 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
alter table "res"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:52:03.350993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:52:03.383704 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m14:52:03.388768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:52:03.389797 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: COMMIT
[0m14:52:03.389797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:52:03.398927 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."my_first_dbt_model__dbt_backup"
[0m14:52:03.408695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_first_dbt_model"
[0m14:52:03.408695 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_first_dbt_model"} */
drop table if exists "res"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:52:03.408695 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:52:03.414517 [debug] [Thread-1 (]: On model.dbt_proj.my_first_dbt_model: Close
[0m14:52:03.417673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1cf33f3-bef5-4fee-9bab-70a37e8d98ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023824778890>]}
[0m14:52:03.418681 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.27s]
[0m14:52:03.419715 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_first_dbt_model
[0m14:52:03.419715 [debug] [Thread-1 (]: Began running node model.dbt_proj.new_film
[0m14:52:03.423052 [info ] [Thread-1 (]: 2 of 3 START sql table model public.new_film ................................... [RUN]
[0m14:52:03.423052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.my_first_dbt_model, now model.dbt_proj.new_film)
[0m14:52:03.425578 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.new_film
[0m14:52:03.429772 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.new_film"
[0m14:52:03.432415 [debug] [Thread-1 (]: Began executing node model.dbt_proj.new_film
[0m14:52:03.438678 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.new_film"
[0m14:52:03.440692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:52:03.441775 [debug] [Thread-1 (]: On model.dbt_proj.new_film: BEGIN
[0m14:52:03.444036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:03.525825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m14:52:03.526825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:52:03.527826 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */

  
    

  create  table "res"."public"."new_film__dbt_tmp"
  
  
    as
  
  (
    -- models/result/film.sql
with film_data as (
    select
        f.id,
        f.name,
        g.name as genre,
        f.release_date as date,
    from "res"."public"."film" f
    join "res"."public"."genre" g on f.genre_id = g.id
)
select * from film_data;
  );
  
[0m14:52:03.529335 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « from »
LINE 19:     from "res"."public"."film" f
             ^

[0m14:52:03.530715 [debug] [Thread-1 (]: On model.dbt_proj.new_film: ROLLBACK
[0m14:52:03.532749 [debug] [Thread-1 (]: On model.dbt_proj.new_film: Close
[0m14:52:03.544723 [debug] [Thread-1 (]: Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « from »
  LINE 19:     from "res"."public"."film" f
               ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:52:03.545722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1cf33f3-bef5-4fee-9bab-70a37e8d98ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238230CD070>]}
[0m14:52:03.547723 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.new_film .......................... [[31mERROR[0m in 0.12s]
[0m14:52:03.549743 [debug] [Thread-1 (]: Finished running node model.dbt_proj.new_film
[0m14:52:03.550761 [debug] [Thread-1 (]: Began running node model.dbt_proj.my_second_dbt_model
[0m14:52:03.554112 [info ] [Thread-1 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m14:52:03.555585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj.new_film, now model.dbt_proj.my_second_dbt_model)
[0m14:52:03.557633 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.my_second_dbt_model
[0m14:52:03.563161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.my_second_dbt_model"
[0m14:52:03.565166 [debug] [Thread-1 (]: Began executing node model.dbt_proj.my_second_dbt_model
[0m14:52:03.573503 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.my_second_dbt_model"
[0m14:52:03.575503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:52:03.577501 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: BEGIN
[0m14:52:03.579010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:03.665406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m14:52:03.666722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:52:03.667232 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */

  
    

  create  table "res"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "res"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m14:52:03.672019 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:52:03.678505 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:52:03.679583 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
alter table "res"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:52:03.679583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:52:03.679583 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m14:52:03.679583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:52:03.679583 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: COMMIT
[0m14:52:03.688861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:52:03.693882 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."my_second_dbt_model__dbt_backup"
[0m14:52:03.694882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.my_second_dbt_model"
[0m14:52:03.695883 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.my_second_dbt_model"} */
drop table if exists "res"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:52:03.696881 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:52:03.700933 [debug] [Thread-1 (]: On model.dbt_proj.my_second_dbt_model: Close
[0m14:52:03.701929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1cf33f3-bef5-4fee-9bab-70a37e8d98ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238248394C0>]}
[0m14:52:03.703932 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.15s]
[0m14:52:03.706698 [debug] [Thread-1 (]: Finished running node model.dbt_proj.my_second_dbt_model
[0m14:52:03.709742 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:03.710740 [debug] [MainThread]: On master: BEGIN
[0m14:52:03.712014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:03.800851 [debug] [MainThread]: SQL status: BEGIN in 0.091 seconds
[0m14:52:03.804026 [debug] [MainThread]: On master: COMMIT
[0m14:52:03.804865 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:03.805887 [debug] [MainThread]: On master: COMMIT
[0m14:52:03.807900 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:03.808902 [debug] [MainThread]: On master: Close
[0m14:52:03.810426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:03.811428 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m14:52:03.812440 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m14:52:03.813440 [debug] [MainThread]: Connection 'model.dbt_proj.my_second_dbt_model' was properly closed.
[0m14:52:03.814951 [info ] [MainThread]: 
[0m14:52:03.817007 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m14:52:03.819528 [debug] [MainThread]: Command end result
[0m14:52:03.899382 [info ] [MainThread]: 
[0m14:52:03.903293 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:52:03.904429 [info ] [MainThread]: 
[0m14:52:03.906481 [error] [MainThread]:   Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « from »
  LINE 19:     from "res"."public"."film" f
               ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:52:03.908902 [info ] [MainThread]: 
[0m14:52:03.909948 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:52:03.912721 [debug] [MainThread]: Command `dbt run` failed at 14:52:03.912721 after 4.53 seconds
[0m14:52:03.913720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382289E7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023822022270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023823007B00>]}
[0m14:52:03.915289 [debug] [MainThread]: Flushing usage events
[0m14:52:50.376277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4D0E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4D0E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4D0E840>]}


============================== 14:52:50.386197 | ed7eff3a-bf0e-4727-8074-941a671ec90c ==============================
[0m14:52:50.386197 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:52:50.388711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:50.663400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed7eff3a-bf0e-4727-8074-941a671ec90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4DD3290>]}
[0m14:52:50.717542 [debug] [MainThread]: Command `dbt clean` succeeded at 14:52:50.717542 after 0.58 seconds
[0m14:52:50.719055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F3C4ADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4BD54F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F417EFF0>]}
[0m14:52:50.719055 [debug] [MainThread]: Flushing usage events
[0m14:53:02.508339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB33E2E420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB33C80170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB33BAFCB0>]}


============================== 14:53:02.516663 | d20c37c7-340a-4c1a-832f-d8be7965007e ==============================
[0m14:53:02.516663 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:53:02.519175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:02.927380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd20c37c7-340a-4c1a-832f-d8be7965007e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB3471B1D0>]}
[0m14:53:03.043628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd20c37c7-340a-4c1a-832f-d8be7965007e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB34808F50>]}
[0m14:53:03.046627 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:53:03.066527 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:53:03.068657 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:53:03.070909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd20c37c7-340a-4c1a-832f-d8be7965007e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB347E7D40>]}
[0m14:53:05.627103 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m14:53:05.630657 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m14:53:05.940816 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m14:53:05.942831 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m14:53:05.943822 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m14:53:05.944828 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_proj.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m14:53:06.124648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd20c37c7-340a-4c1a-832f-d8be7965007e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB35EF0DD0>]}
[0m14:53:06.340437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd20c37c7-340a-4c1a-832f-d8be7965007e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB3605A9F0>]}
[0m14:53:06.341944 [info ] [MainThread]: Found 1 model, 6 sources, 415 macros
[0m14:53:06.342954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd20c37c7-340a-4c1a-832f-d8be7965007e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB3608C4A0>]}
[0m14:53:06.344956 [info ] [MainThread]: 
[0m14:53:06.347083 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:06.348594 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m14:53:06.605460 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m14:53:06.606349 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m14:53:06.607373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:06.695964 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.088 seconds
[0m14:53:06.698688 [debug] [ThreadPool]: On list_res: Close
[0m14:53:06.702164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m14:53:06.713342 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:53:06.714336 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m14:53:06.714336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:06.794091 [debug] [ThreadPool]: SQL status: BEGIN in 0.079 seconds
[0m14:53:06.795266 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:53:06.797666 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:53:06.807516 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m14:53:06.811039 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m14:53:06.812048 [debug] [ThreadPool]: On list_res_public: Close
[0m14:53:06.825740 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:06.826815 [debug] [MainThread]: On master: BEGIN
[0m14:53:06.828329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:06.902308 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m14:53:06.903764 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:06.905021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:06.921859 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m14:53:06.924663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd20c37c7-340a-4c1a-832f-d8be7965007e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB36142F30>]}
[0m14:53:06.926702 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:06.926702 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:06.928213 [debug] [MainThread]: On master: BEGIN
[0m14:53:06.930280 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:53:06.931294 [debug] [MainThread]: On master: COMMIT
[0m14:53:06.932302 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:06.933315 [debug] [MainThread]: On master: COMMIT
[0m14:53:06.934316 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:53:06.935656 [debug] [MainThread]: On master: Close
[0m14:53:06.937168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:06.945812 [info ] [MainThread]: 
[0m14:53:06.983801 [debug] [Thread-1 (]: Began running node model.dbt_proj.new_film
[0m14:53:06.984316 [info ] [Thread-1 (]: 1 of 1 START sql table model public.new_film ................................... [RUN]
[0m14:53:06.988667 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.new_film'
[0m14:53:06.990681 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.new_film
[0m14:53:07.013466 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.new_film"
[0m14:53:07.017464 [debug] [Thread-1 (]: Began executing node model.dbt_proj.new_film
[0m14:53:07.130860 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.new_film"
[0m14:53:07.135033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:53:07.136037 [debug] [Thread-1 (]: On model.dbt_proj.new_film: BEGIN
[0m14:53:07.138252 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:53:07.224769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.086 seconds
[0m14:53:07.225770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:53:07.226770 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */

  
    

  create  table "res"."public"."new_film__dbt_tmp"
  
  
    as
  
  (
    -- models/result/film.sql
with film_data as (
    select
        f.id,
        f.name,
        g.name as genre,
        f.release_date as date,
    from "res"."public"."film" f
    join "res"."public"."genre" g on f.genre_id = g.id
)
select * from film_data;
  );
  
[0m14:53:07.228285 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « from »
LINE 19:     from "res"."public"."film" f
             ^

[0m14:53:07.230297 [debug] [Thread-1 (]: On model.dbt_proj.new_film: ROLLBACK
[0m14:53:07.231294 [debug] [Thread-1 (]: On model.dbt_proj.new_film: Close
[0m14:53:07.241331 [debug] [Thread-1 (]: Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « from »
  LINE 19:     from "res"."public"."film" f
               ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:53:07.244852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd20c37c7-340a-4c1a-832f-d8be7965007e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB33E2C980>]}
[0m14:53:07.245850 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.new_film .......................... [[31mERROR[0m in 0.25s]
[0m14:53:07.248364 [debug] [Thread-1 (]: Finished running node model.dbt_proj.new_film
[0m14:53:07.252377 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:07.253377 [debug] [MainThread]: On master: BEGIN
[0m14:53:07.254540 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:07.342377 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m14:53:07.343379 [debug] [MainThread]: On master: COMMIT
[0m14:53:07.344378 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:07.345381 [debug] [MainThread]: On master: COMMIT
[0m14:53:07.347379 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:53:07.348381 [debug] [MainThread]: On master: Close
[0m14:53:07.350011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:07.351025 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m14:53:07.351025 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m14:53:07.352365 [debug] [MainThread]: Connection 'model.dbt_proj.new_film' was properly closed.
[0m14:53:07.353578 [info ] [MainThread]: 
[0m14:53:07.355726 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m14:53:07.358234 [debug] [MainThread]: Command end result
[0m14:53:07.434328 [info ] [MainThread]: 
[0m14:53:07.435329 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:07.436839 [info ] [MainThread]: 
[0m14:53:07.439427 [error] [MainThread]:   Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « from »
  LINE 19:     from "res"."public"."film" f
               ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:53:07.441581 [info ] [MainThread]: 
[0m14:53:07.442701 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:53:07.446508 [debug] [MainThread]: Command `dbt run` failed at 14:53:07.445497 after 5.18 seconds
[0m14:53:07.447507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB35E35460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB3385CB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB31C9F830>]}
[0m14:53:07.449017 [debug] [MainThread]: Flushing usage events
[0m14:53:48.628635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC06A2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC3398170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC34E7620>]}


============================== 14:53:48.631860 | cc59cd67-ed3b-4375-afc0-93e336bdcbc7 ==============================
[0m14:53:48.631860 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:53:48.631860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:49.009125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc59cd67-ed3b-4375-afc0-93e336bdcbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC32ED310>]}
[0m14:53:49.133544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc59cd67-ed3b-4375-afc0-93e336bdcbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC3540170>]}
[0m14:53:49.133544 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:53:49.151005 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:53:49.488272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:49.493308 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\schema.yml
[0m14:53:50.053535 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.new_film' (models\example\new_film.sql) depends on a source named 'res.genre' which was not found
[0m14:53:50.060542 [debug] [MainThread]: Command `dbt run` failed at 14:53:50.060542 after 1.66 seconds
[0m14:53:50.061909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC29ECF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC3A932C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC25495B0>]}
[0m14:53:50.064468 [debug] [MainThread]: Flushing usage events
[0m14:54:36.015575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338C63CE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338C11B0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338F0665A0>]}


============================== 14:54:36.021109 | c87acdc8-efdb-4774-a2bf-4d3c0f80b3f7 ==============================
[0m14:54:36.021109 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:54:36.025125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:54:36.415476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c87acdc8-efdb-4774-a2bf-4d3c0f80b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338F2E7DA0>]}
[0m14:54:36.542941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c87acdc8-efdb-4774-a2bf-4d3c0f80b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338EFEC830>]}
[0m14:54:36.542941 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:54:36.567987 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:54:36.858153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:54:36.867157 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\schema.yml
[0m14:54:36.868167 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\new_film.sql
[0m14:54:37.531629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c87acdc8-efdb-4774-a2bf-4d3c0f80b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023390A59970>]}
[0m14:54:37.728304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c87acdc8-efdb-4774-a2bf-4d3c0f80b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023390B44BF0>]}
[0m14:54:37.738340 [info ] [MainThread]: Found 1 model, 6 sources, 415 macros
[0m14:54:37.739984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87acdc8-efdb-4774-a2bf-4d3c0f80b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233909D8FE0>]}
[0m14:54:37.739984 [info ] [MainThread]: 
[0m14:54:37.739984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:37.739984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m14:54:37.918606 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m14:54:37.919618 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m14:54:37.919618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:38.001788 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.085 seconds
[0m14:54:38.008302 [debug] [ThreadPool]: On list_res: Close
[0m14:54:38.012296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m14:54:38.024604 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:54:38.028118 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m14:54:38.028118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:38.112423 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m14:54:38.113933 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:54:38.115325 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:54:38.123943 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m14:54:38.126739 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m14:54:38.129326 [debug] [ThreadPool]: On list_res_public: Close
[0m14:54:38.141430 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:38.141430 [debug] [MainThread]: On master: BEGIN
[0m14:54:38.144801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:38.338037 [debug] [MainThread]: SQL status: BEGIN in 0.194 seconds
[0m14:54:38.339686 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:38.339686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:38.355107 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m14:54:38.358177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87acdc8-efdb-4774-a2bf-4d3c0f80b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233907EDCD0>]}
[0m14:54:38.358177 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:38.363189 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:38.363189 [debug] [MainThread]: On master: BEGIN
[0m14:54:38.364198 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:54:38.364198 [debug] [MainThread]: On master: COMMIT
[0m14:54:38.364198 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:38.368212 [debug] [MainThread]: On master: COMMIT
[0m14:54:38.369895 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:54:38.369895 [debug] [MainThread]: On master: Close
[0m14:54:38.369895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:38.369895 [info ] [MainThread]: 
[0m14:54:38.378738 [debug] [Thread-1 (]: Began running node model.dbt_proj.new_film
[0m14:54:38.378738 [info ] [Thread-1 (]: 1 of 1 START sql table model public.new_film ................................... [RUN]
[0m14:54:38.381437 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.new_film'
[0m14:54:38.382302 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.new_film
[0m14:54:38.399363 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.new_film"
[0m14:54:38.405205 [debug] [Thread-1 (]: Began executing node model.dbt_proj.new_film
[0m14:54:38.521160 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.new_film"
[0m14:54:38.521160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:54:38.528180 [debug] [Thread-1 (]: On model.dbt_proj.new_film: BEGIN
[0m14:54:38.528180 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:54:38.605874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m14:54:38.608393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:54:38.609940 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */

  
    

  create  table "res"."public"."new_film__dbt_tmp"
  
  
    as
  
  (
    -- models/result/film.sql
with film_data as (
    select
        f.id,
        f.name,
        g.name as genre,
        f.release_date as date,
    from "res"."public"."film" f
    join "res"."public"."genre" g on f.genre_id = g.id
)
select * from film_data;
  );
  
[0m14:54:38.609940 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « from »
LINE 19:     from "res"."public"."film" f
             ^

[0m14:54:38.612954 [debug] [Thread-1 (]: On model.dbt_proj.new_film: ROLLBACK
[0m14:54:38.614885 [debug] [Thread-1 (]: On model.dbt_proj.new_film: Close
[0m14:54:38.627398 [debug] [Thread-1 (]: Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « from »
  LINE 19:     from "res"."public"."film" f
               ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:54:38.627906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87acdc8-efdb-4774-a2bf-4d3c0f80b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338E928BF0>]}
[0m14:54:38.632446 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.new_film .......................... [[31mERROR[0m in 0.25s]
[0m14:54:38.632446 [debug] [Thread-1 (]: Finished running node model.dbt_proj.new_film
[0m14:54:38.639005 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:38.639005 [debug] [MainThread]: On master: BEGIN
[0m14:54:38.641235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:38.724337 [debug] [MainThread]: SQL status: BEGIN in 0.084 seconds
[0m14:54:38.725338 [debug] [MainThread]: On master: COMMIT
[0m14:54:38.726336 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:38.727343 [debug] [MainThread]: On master: COMMIT
[0m14:54:38.728336 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:54:38.729410 [debug] [MainThread]: On master: Close
[0m14:54:38.730929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:38.731930 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m14:54:38.731930 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m14:54:38.732932 [debug] [MainThread]: Connection 'model.dbt_proj.new_film' was properly closed.
[0m14:54:38.733929 [info ] [MainThread]: 
[0m14:54:38.735930 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m14:54:38.737729 [debug] [MainThread]: Command end result
[0m14:54:38.797936 [info ] [MainThread]: 
[0m14:54:38.804193 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:54:38.806327 [info ] [MainThread]: 
[0m14:54:38.806891 [error] [MainThread]:   Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « from »
  LINE 19:     from "res"."public"."film" f
               ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:54:38.810162 [info ] [MainThread]: 
[0m14:54:38.812280 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:54:38.814735 [debug] [MainThread]: Command `dbt run` failed at 14:54:38.814735 after 3.05 seconds
[0m14:54:38.815816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338E79ECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002339079A3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233909D8E30>]}
[0m14:54:38.816834 [debug] [MainThread]: Flushing usage events
[0m14:56:04.498086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA20AFAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA3E7AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA4746BA0>]}


============================== 14:56:04.500805 | 28e5a90a-d8ca-4a32-a28c-d1deba7e4045 ==============================
[0m14:56:04.500805 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:56:04.505324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:56:04.867863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28e5a90a-d8ca-4a32-a28c-d1deba7e4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA4CCFC20>]}
[0m14:56:05.001155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28e5a90a-d8ca-4a32-a28c-d1deba7e4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA4ADE9F0>]}
[0m14:56:05.001155 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:56:05.026290 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:56:05.381790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:56:05.381790 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\new_film.sql
[0m14:56:05.906425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28e5a90a-d8ca-4a32-a28c-d1deba7e4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA640CAD0>]}
[0m14:56:06.141018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28e5a90a-d8ca-4a32-a28c-d1deba7e4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA613AF90>]}
[0m14:56:06.142178 [info ] [MainThread]: Found 1 model, 6 sources, 415 macros
[0m14:56:06.142178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28e5a90a-d8ca-4a32-a28c-d1deba7e4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA4D56780>]}
[0m14:56:06.147198 [info ] [MainThread]: 
[0m14:56:06.147706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:56:06.150817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m14:56:06.330868 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m14:56:06.337942 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m14:56:06.338477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:06.420618 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.088 seconds
[0m14:56:06.427632 [debug] [ThreadPool]: On list_res: Close
[0m14:56:06.433735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m14:56:06.444369 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:56:06.444369 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m14:56:06.447881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:06.522684 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m14:56:06.522684 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:56:06.527701 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:56:06.532965 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m14:56:06.541125 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m14:56:06.541125 [debug] [ThreadPool]: On list_res_public: Close
[0m14:56:06.551071 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:06.551071 [debug] [MainThread]: On master: BEGIN
[0m14:56:06.551071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:06.632587 [debug] [MainThread]: SQL status: BEGIN in 0.077 seconds
[0m14:56:06.635445 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:06.635445 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:56:06.652890 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m14:56:06.657917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28e5a90a-d8ca-4a32-a28c-d1deba7e4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA644BC50>]}
[0m14:56:06.657917 [debug] [MainThread]: On master: ROLLBACK
[0m14:56:06.657917 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:06.657917 [debug] [MainThread]: On master: BEGIN
[0m14:56:06.657917 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:56:06.663416 [debug] [MainThread]: On master: COMMIT
[0m14:56:06.663416 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:06.663416 [debug] [MainThread]: On master: COMMIT
[0m14:56:06.665629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:56:06.666141 [debug] [MainThread]: On master: Close
[0m14:56:06.667648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:06.667648 [info ] [MainThread]: 
[0m14:56:06.671190 [debug] [Thread-1 (]: Began running node model.dbt_proj.new_film
[0m14:56:06.675416 [info ] [Thread-1 (]: 1 of 1 START sql table model public.new_film ................................... [RUN]
[0m14:56:06.677615 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.new_film'
[0m14:56:06.678430 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.new_film
[0m14:56:06.695706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.new_film"
[0m14:56:06.697707 [debug] [Thread-1 (]: Began executing node model.dbt_proj.new_film
[0m14:56:06.790491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.new_film"
[0m14:56:06.791571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:56:06.791571 [debug] [Thread-1 (]: On model.dbt_proj.new_film: BEGIN
[0m14:56:06.791571 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:56:06.881093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m14:56:06.881093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:56:06.881093 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */

  
    

  create  table "res"."public"."new_film__dbt_tmp"
  
  
    as
  
  (
    -- models/result/film.sql
with film_data as (
    select
        f.id,
        f.name,
        g.name as genre,
        f.release_date as date  -- Removed the trailing comma here
    from "res"."public"."film" f
    join "res"."public"."genre" g on f.genre_id = g.id
)
select * from film_data;
  );
  
[0m14:56:06.887408 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 22: select * from film_data;
                                ^

[0m14:56:06.887669 [debug] [Thread-1 (]: On model.dbt_proj.new_film: ROLLBACK
[0m14:56:06.889862 [debug] [Thread-1 (]: On model.dbt_proj.new_film: Close
[0m14:56:06.900549 [debug] [Thread-1 (]: Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 22: select * from film_data;
                                  ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:56:06.903668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28e5a90a-d8ca-4a32-a28c-d1deba7e4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA6A370E0>]}
[0m14:56:06.906119 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.new_film .......................... [[31mERROR[0m in 0.23s]
[0m14:56:06.907643 [debug] [Thread-1 (]: Finished running node model.dbt_proj.new_film
[0m14:56:06.911376 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:06.911376 [debug] [MainThread]: On master: BEGIN
[0m14:56:06.911376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:56:06.995254 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m14:56:06.996481 [debug] [MainThread]: On master: COMMIT
[0m14:56:06.996481 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:06.997993 [debug] [MainThread]: On master: COMMIT
[0m14:56:07.000006 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:56:07.001024 [debug] [MainThread]: On master: Close
[0m14:56:07.002287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:07.003300 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m14:56:07.003300 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m14:56:07.004654 [debug] [MainThread]: Connection 'model.dbt_proj.new_film' was properly closed.
[0m14:56:07.006559 [info ] [MainThread]: 
[0m14:56:07.007895 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m14:56:07.010033 [debug] [MainThread]: Command end result
[0m14:56:07.081227 [info ] [MainThread]: 
[0m14:56:07.081227 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:56:07.083088 [info ] [MainThread]: 
[0m14:56:07.085104 [error] [MainThread]:   Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 22: select * from film_data;
                                  ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:56:07.088833 [info ] [MainThread]: 
[0m14:56:07.089844 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:56:07.094124 [debug] [MainThread]: Command `dbt run` failed at 14:56:07.094124 after 2.85 seconds
[0m14:56:07.095125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA20AFAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA62D16A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA4CCD730>]}
[0m14:56:07.096124 [debug] [MainThread]: Flushing usage events
[0m14:56:51.293464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9D8BFD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9FFE2E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DA0109820>]}


============================== 14:56:51.297475 | 91c6e384-bb04-44ec-863c-8226a0fea4b8 ==============================
[0m14:56:51.297475 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:56:51.297475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:56:51.542492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91c6e384-bb04-44ec-863c-8226a0fea4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9DD909E0>]}
[0m14:56:51.586264 [debug] [MainThread]: Command `dbt clean` succeeded at 14:56:51.585251 after 0.52 seconds
[0m14:56:51.586264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DA01BBF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9F0D0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DA083F590>]}
[0m14:56:51.588786 [debug] [MainThread]: Flushing usage events
[0m14:56:57.882339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BEF576780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BEF5766F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BEF576600>]}


============================== 14:56:57.890272 | 2958b1a3-95d0-4688-a0f4-d4ec3bd63938 ==============================
[0m14:56:57.890272 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:56:57.891507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:56:58.262647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2958b1a3-95d0-4688-a0f4-d4ec3bd63938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BEF2B7920>]}
[0m14:56:58.397712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2958b1a3-95d0-4688-a0f4-d4ec3bd63938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BEF3157F0>]}
[0m14:56:58.398817 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:56:58.417830 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:56:58.419890 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:56:58.420954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2958b1a3-95d0-4688-a0f4-d4ec3bd63938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BEFC2C7A0>]}
[0m14:57:00.765898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2958b1a3-95d0-4688-a0f4-d4ec3bd63938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF0ED2990>]}
[0m14:57:00.982245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2958b1a3-95d0-4688-a0f4-d4ec3bd63938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF0EBA540>]}
[0m14:57:00.986055 [info ] [MainThread]: Found 1 model, 6 sources, 415 macros
[0m14:57:00.988100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2958b1a3-95d0-4688-a0f4-d4ec3bd63938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF0DF6ED0>]}
[0m14:57:00.992393 [info ] [MainThread]: 
[0m14:57:00.995842 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:57:00.997826 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m14:57:01.177791 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m14:57:01.182831 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m14:57:01.182831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:01.255047 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.073 seconds
[0m14:57:01.258782 [debug] [ThreadPool]: On list_res: Close
[0m14:57:01.261299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m14:57:01.274449 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:57:01.274449 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m14:57:01.274449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:01.338806 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m14:57:01.338806 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:57:01.338806 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:57:01.347657 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m14:57:01.350029 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m14:57:01.351988 [debug] [ThreadPool]: On list_res_public: Close
[0m14:57:01.362397 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:01.363443 [debug] [MainThread]: On master: BEGIN
[0m14:57:01.363443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:01.429795 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m14:57:01.430855 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:01.431900 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:57:01.443622 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m14:57:01.446644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2958b1a3-95d0-4688-a0f4-d4ec3bd63938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF1558770>]}
[0m14:57:01.447787 [debug] [MainThread]: On master: ROLLBACK
[0m14:57:01.447787 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:01.447787 [debug] [MainThread]: On master: BEGIN
[0m14:57:01.447787 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:57:01.452188 [debug] [MainThread]: On master: COMMIT
[0m14:57:01.452702 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:01.454365 [debug] [MainThread]: On master: COMMIT
[0m14:57:01.455546 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:57:01.456739 [debug] [MainThread]: On master: Close
[0m14:57:01.457751 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:01.457751 [info ] [MainThread]: 
[0m14:57:01.463767 [debug] [Thread-1 (]: Began running node model.dbt_proj.new_film
[0m14:57:01.465746 [info ] [Thread-1 (]: 1 of 1 START sql table model public.new_film ................................... [RUN]
[0m14:57:01.467761 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.new_film'
[0m14:57:01.468210 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.new_film
[0m14:57:01.483285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.new_film"
[0m14:57:01.487506 [debug] [Thread-1 (]: Began executing node model.dbt_proj.new_film
[0m14:57:01.575872 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.new_film"
[0m14:57:01.581247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:57:01.581247 [debug] [Thread-1 (]: On model.dbt_proj.new_film: BEGIN
[0m14:57:01.583476 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:01.777852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.194 seconds
[0m14:57:01.777852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:57:01.777852 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */

  
    

  create  table "res"."public"."new_film__dbt_tmp"
  
  
    as
  
  (
    -- models/result/film.sql
with film_data as (
    select
        f.id,
        f.name,
        g.name as genre,
        f.release_date as date  -- Removed the trailing comma here
    from "res"."public"."film" f
    join "res"."public"."genre" g on f.genre_id = g.id
)
select * from film_data;
  );
  
[0m14:57:01.777852 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 22: select * from film_data;
                                ^

[0m14:57:01.783683 [debug] [Thread-1 (]: On model.dbt_proj.new_film: ROLLBACK
[0m14:57:01.785195 [debug] [Thread-1 (]: On model.dbt_proj.new_film: Close
[0m14:57:01.797505 [debug] [Thread-1 (]: Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 22: select * from film_data;
                                  ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:57:01.801050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2958b1a3-95d0-4688-a0f4-d4ec3bd63938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF15D8EC0>]}
[0m14:57:01.801050 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.new_film .......................... [[31mERROR[0m in 0.33s]
[0m14:57:01.805161 [debug] [Thread-1 (]: Finished running node model.dbt_proj.new_film
[0m14:57:01.809338 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:01.809338 [debug] [MainThread]: On master: BEGIN
[0m14:57:01.809338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:01.897724 [debug] [MainThread]: SQL status: BEGIN in 0.086 seconds
[0m14:57:01.897724 [debug] [MainThread]: On master: COMMIT
[0m14:57:01.898963 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:01.900166 [debug] [MainThread]: On master: COMMIT
[0m14:57:01.901368 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:57:01.902382 [debug] [MainThread]: On master: Close
[0m14:57:01.904381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:01.905382 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m14:57:01.906385 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m14:57:01.907900 [debug] [MainThread]: Connection 'model.dbt_proj.new_film' was properly closed.
[0m14:57:01.908913 [info ] [MainThread]: 
[0m14:57:01.910645 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m14:57:01.913021 [debug] [MainThread]: Command end result
[0m14:57:02.064810 [info ] [MainThread]: 
[0m14:57:02.066810 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:57:02.069471 [info ] [MainThread]: 
[0m14:57:02.071009 [error] [MainThread]:   Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 22: select * from film_data;
                                  ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m14:57:02.073606 [info ] [MainThread]: 
[0m14:57:02.075611 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:57:02.078120 [debug] [MainThread]: Command `dbt run` failed at 14:57:02.078120 after 4.42 seconds
[0m14:57:02.080133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BEE9AB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BEE9AB680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BF15DF5F0>]}
[0m14:57:02.081146 [debug] [MainThread]: Flushing usage events
[0m14:57:48.807952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA42310A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA3EB2E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA4233350>]}


============================== 14:57:48.817531 | a90405a4-ac85-4b94-94c4-7783ac82b37d ==============================
[0m14:57:48.817531 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:57:48.817531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:57:49.060962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a90405a4-ac85-4b94-94c4-7783ac82b37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA42EBAA0>]}
[0m14:57:49.103610 [debug] [MainThread]: Command `dbt clean` succeeded at 14:57:49.103610 after 0.54 seconds
[0m14:57:49.104621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA4569400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA4469A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA1DBD550>]}
[0m14:57:49.105622 [debug] [MainThread]: Flushing usage events
[0m14:57:55.937479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A4589070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A4434C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A1A255B0>]}


============================== 14:57:55.940520 | ed5c4b47-83c8-4866-ac3d-b07c512b9c84 ==============================
[0m14:57:55.940520 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:57:55.940520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:57:56.322384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed5c4b47-83c8-4866-ac3d-b07c512b9c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A475B170>]}
[0m14:57:56.429410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed5c4b47-83c8-4866-ac3d-b07c512b9c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A3DF4200>]}
[0m14:57:56.431227 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:57:56.453506 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:57:56.456504 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:57:56.457505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed5c4b47-83c8-4866-ac3d-b07c512b9c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A470F170>]}
[0m14:57:58.888220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed5c4b47-83c8-4866-ac3d-b07c512b9c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A4D44080>]}
[0m14:57:59.087293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed5c4b47-83c8-4866-ac3d-b07c512b9c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A5F49C70>]}
[0m14:57:59.091194 [info ] [MainThread]: Found 1 model, 6 sources, 415 macros
[0m14:57:59.092349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed5c4b47-83c8-4866-ac3d-b07c512b9c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A5FE8770>]}
[0m14:57:59.095121 [info ] [MainThread]: 
[0m14:57:59.097643 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:57:59.100259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m14:57:59.261177 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m14:57:59.261177 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m14:57:59.261177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:59.352585 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.087 seconds
[0m14:57:59.356634 [debug] [ThreadPool]: On list_res: Close
[0m14:57:59.358838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m14:57:59.374114 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:57:59.374620 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m14:57:59.374620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:59.440548 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m14:57:59.443917 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:57:59.443917 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:57:59.454079 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m14:57:59.457593 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m14:57:59.457593 [debug] [ThreadPool]: On list_res_public: Close
[0m14:57:59.471401 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:59.472996 [debug] [MainThread]: On master: BEGIN
[0m14:57:59.474403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:59.557676 [debug] [MainThread]: SQL status: BEGIN in 0.084 seconds
[0m14:57:59.557676 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:59.561178 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:57:59.567476 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m14:57:59.567476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed5c4b47-83c8-4866-ac3d-b07c512b9c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A5E4D3A0>]}
[0m14:57:59.567476 [debug] [MainThread]: On master: ROLLBACK
[0m14:57:59.577665 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:59.579248 [debug] [MainThread]: On master: BEGIN
[0m14:57:59.580259 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:57:59.581370 [debug] [MainThread]: On master: COMMIT
[0m14:57:59.582639 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:59.584018 [debug] [MainThread]: On master: COMMIT
[0m14:57:59.584018 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:57:59.584018 [debug] [MainThread]: On master: Close
[0m14:57:59.587528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:59.587528 [info ] [MainThread]: 
[0m14:57:59.593080 [debug] [Thread-1 (]: Began running node model.dbt_proj.new_film
[0m14:57:59.595925 [info ] [Thread-1 (]: 1 of 1 START sql table model public.new_film ................................... [RUN]
[0m14:57:59.597436 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.new_film'
[0m14:57:59.598448 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.new_film
[0m14:57:59.613602 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.new_film"
[0m14:57:59.617529 [debug] [Thread-1 (]: Began executing node model.dbt_proj.new_film
[0m14:57:59.729926 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.new_film"
[0m14:57:59.732141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:57:59.732141 [debug] [Thread-1 (]: On model.dbt_proj.new_film: BEGIN
[0m14:57:59.732141 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:59.797325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m14:57:59.797325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:57:59.800894 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */

  
    

  create  table "res"."public"."new_film__dbt_tmp"
  
  
    as
  
  (
    -- models/result/film.sql
with film_data as (
    select
        f.id,
        f.name,
        g.name as genre,
        f.release_date as date  -- Removed the trailing comma here
    from "res"."public"."film" f
    join "res"."public"."genre" g on f.genre_id = g.id
)
select * from film_data
  );
  
[0m14:57:59.809198 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.011 seconds
[0m14:57:59.882619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:57:59.887699 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */
alter table "res"."public"."new_film__dbt_tmp" rename to "new_film"
[0m14:57:59.888719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:57:59.935421 [debug] [Thread-1 (]: On model.dbt_proj.new_film: COMMIT
[0m14:57:59.937441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:57:59.938475 [debug] [Thread-1 (]: On model.dbt_proj.new_film: COMMIT
[0m14:57:59.938475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:57:59.953035 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."new_film__dbt_backup"
[0m14:57:59.968679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m14:57:59.968679 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */
drop table if exists "res"."public"."new_film__dbt_backup" cascade
[0m14:57:59.968679 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:57:59.975170 [debug] [Thread-1 (]: On model.dbt_proj.new_film: Close
[0m14:57:59.979057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed5c4b47-83c8-4866-ac3d-b07c512b9c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A667BFE0>]}
[0m14:57:59.980134 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.new_film .............................. [[32mSELECT 20[0m in 0.38s]
[0m14:57:59.982460 [debug] [Thread-1 (]: Finished running node model.dbt_proj.new_film
[0m14:57:59.982460 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:59.985746 [debug] [MainThread]: On master: BEGIN
[0m14:57:59.987270 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:00.070486 [debug] [MainThread]: SQL status: BEGIN in 0.086 seconds
[0m14:58:00.070486 [debug] [MainThread]: On master: COMMIT
[0m14:58:00.070486 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:00.075559 [debug] [MainThread]: On master: COMMIT
[0m14:58:00.076070 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:58:00.077587 [debug] [MainThread]: On master: Close
[0m14:58:00.077587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:00.079392 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m14:58:00.080413 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m14:58:00.081425 [debug] [MainThread]: Connection 'model.dbt_proj.new_film' was properly closed.
[0m14:58:00.082435 [info ] [MainThread]: 
[0m14:58:00.084430 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m14:58:00.086431 [debug] [MainThread]: Command end result
[0m14:58:00.146620 [info ] [MainThread]: 
[0m14:58:00.149233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:58:00.151305 [info ] [MainThread]: 
[0m14:58:00.153303 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:58:00.157304 [debug] [MainThread]: Command `dbt run` succeeded at 14:58:00.156305 after 4.46 seconds
[0m14:58:00.157814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A448C500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A2187B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A430CB00>]}
[0m14:58:00.160267 [debug] [MainThread]: Flushing usage events
[0m01:10:25.517716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E989E6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EC2266C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EC2265D0>]}


============================== 01:10:25.531182 | 3e451ed3-899c-4f71-8b3a-5a07019f2d7a ==============================
[0m01:10:25.531182 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:10:25.533893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:10:26.032908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e451ed3-899c-4f71-8b3a-5a07019f2d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EC38A5A0>]}
[0m01:10:26.182187 [debug] [MainThread]: Command `dbt clean` succeeded at 01:10:26.181116 after 1.14 seconds
[0m01:10:26.187290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E989E6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EC3DBF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EC3DBB00>]}
[0m01:10:26.199383 [debug] [MainThread]: Flushing usage events
[0m01:10:36.462110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F68B665D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F68B649E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F68B66AE0>]}


============================== 01:10:36.473284 | d96eed36-0bd0-47dc-9fbe-f4c754cc3db1 ==============================
[0m01:10:36.473284 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:10:36.476059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:10:36.549534 [info ] [MainThread]: dbt version: 1.8.3
[0m01:10:36.551881 [info ] [MainThread]: python version: 3.12.2
[0m01:10:36.554544 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m01:10:36.556792 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:10:36.774075 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m01:10:36.775209 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m01:10:36.775209 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m01:10:36.780376 [info ] [MainThread]: adapter type: postgres
[0m01:10:36.785795 [info ] [MainThread]: adapter version: 1.8.2
[0m01:10:37.084067 [info ] [MainThread]: Configuration:
[0m01:10:37.084067 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:10:37.093382 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:10:37.094398 [info ] [MainThread]: Required dependencies:
[0m01:10:37.095771 [debug] [MainThread]: Executing "git --help"
[0m01:10:37.212882 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:10:37.215015 [debug] [MainThread]: STDERR: "b''"
[0m01:10:37.216042 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:10:37.220848 [info ] [MainThread]: Connection:
[0m01:10:37.222237 [info ] [MainThread]:   host: localhost
[0m01:10:37.224305 [info ] [MainThread]:   port: 5432
[0m01:10:37.230548 [info ] [MainThread]:   user: postgres
[0m01:10:37.237891 [info ] [MainThread]:   database: res
[0m01:10:37.252058 [info ] [MainThread]:   schema: public
[0m01:10:37.255856 [info ] [MainThread]:   connect_timeout: 10
[0m01:10:37.262381 [info ] [MainThread]:   role: None
[0m01:10:37.264416 [info ] [MainThread]:   search_path: None
[0m01:10:37.269766 [info ] [MainThread]:   keepalives_idle: 0
[0m01:10:37.273214 [info ] [MainThread]:   sslmode: None
[0m01:10:37.275064 [info ] [MainThread]:   sslcert: None
[0m01:10:37.279184 [info ] [MainThread]:   sslkey: None
[0m01:10:37.281564 [info ] [MainThread]:   sslrootcert: None
[0m01:10:37.284292 [info ] [MainThread]:   application_name: dbt
[0m01:10:37.293628 [info ] [MainThread]:   retries: 1
[0m01:10:37.311291 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:10:37.319512 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:10:37.737175 [debug] [MainThread]: Using postgres connection "debug"
[0m01:10:37.739661 [debug] [MainThread]: On debug: select 1 as id
[0m01:10:37.741776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:10:37.876852 [debug] [MainThread]: SQL status: SELECT 1 in 0.136 seconds
[0m01:10:37.880946 [debug] [MainThread]: On debug: Close
[0m01:10:37.882027 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:10:37.884539 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:10:37.889107 [debug] [MainThread]: Command `dbt debug` succeeded at 01:10:37.886066 after 1.78 seconds
[0m01:10:37.890550 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:10:37.890550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F68FB1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F6877C200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F68F8E630>]}
[0m01:10:37.890550 [debug] [MainThread]: Flushing usage events
[0m02:39:55.623849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DBCD4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DEC786B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DEC78C20>]}


============================== 02:39:55.632278 | 94da252f-854f-4ff9-b62a-0eda26148dc1 ==============================
[0m02:39:55.632278 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:39:55.634286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:39:55.955749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94da252f-854f-4ff9-b62a-0eda26148dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DF540050>]}
[0m02:39:56.023864 [debug] [MainThread]: Command `dbt clean` succeeded at 02:39:56.023864 after 0.84 seconds
[0m02:39:56.025493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD02B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DF540050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DF543440>]}
[0m02:39:56.027151 [debug] [MainThread]: Flushing usage events
[0m02:40:03.695032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B670A3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B67B62FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B647B2EA0>]}


============================== 02:40:03.703641 | ebcb3b65-6c7c-4eb8-b472-724784a99bc6 ==============================
[0m02:40:03.703641 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:40:03.705641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:40:04.183133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebcb3b65-6c7c-4eb8-b472-724784a99bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B68148620>]}
[0m02:40:04.348270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebcb3b65-6c7c-4eb8-b472-724784a99bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B67C94230>]}
[0m02:40:04.351399 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:40:04.372455 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:40:04.375210 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:40:04.376735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebcb3b65-6c7c-4eb8-b472-724784a99bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B67DB2E70>]}
[0m02:40:04.389568 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_proj: example\schema.yml - Runtime Error
    Syntax error near line 14
    ------------------------------
    11 |       - name: mysql_film
    12 |       - name: csv_test
    13 | 
    14 | version: 2
    15 | 
    16 | sources:
    17 |   - name: SC1
    
    Raw Error:
    ------------------------------
    did not find expected <document start>
      in "<unicode string>", line 14, column 1
[0m02:40:04.395994 [debug] [MainThread]: Command `dbt run` failed at 02:40:04.395994 after 0.96 seconds
[0m02:40:04.397011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B6805E7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B67DB2E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B68699BE0>]}
[0m02:40:04.398520 [debug] [MainThread]: Flushing usage events
[0m02:41:07.659981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6977BFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A699948D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A69994A570>]}


============================== 02:41:07.671058 | 023972f7-3d6c-4dd3-986c-579f415da993 ==============================
[0m02:41:07.671058 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:41:07.673066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:41:07.714291 [info ] [MainThread]: dbt version: 1.8.3
[0m02:41:07.715458 [info ] [MainThread]: python version: 3.12.2
[0m02:41:07.717861 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m02:41:07.720131 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m02:41:07.990646 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m02:41:07.992207 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m02:41:07.994581 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m02:41:07.996577 [info ] [MainThread]: adapter type: postgres
[0m02:41:08.004610 [info ] [MainThread]: adapter version: 1.8.2
[0m02:41:08.301293 [info ] [MainThread]: Configuration:
[0m02:41:08.304137 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:41:08.311253 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:41:08.314522 [info ] [MainThread]: Required dependencies:
[0m02:41:08.317685 [debug] [MainThread]: Executing "git --help"
[0m02:41:08.415241 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:41:08.416908 [debug] [MainThread]: STDERR: "b''"
[0m02:41:08.419132 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:41:08.420143 [info ] [MainThread]: Connection:
[0m02:41:08.422167 [info ] [MainThread]:   host: localhost
[0m02:41:08.423175 [info ] [MainThread]:   port: 5432
[0m02:41:08.425362 [info ] [MainThread]:   user: postgres
[0m02:41:08.426061 [info ] [MainThread]:   database: res
[0m02:41:08.427896 [info ] [MainThread]:   schema: public
[0m02:41:08.429378 [info ] [MainThread]:   connect_timeout: 10
[0m02:41:08.431400 [info ] [MainThread]:   role: None
[0m02:41:08.432399 [info ] [MainThread]:   search_path: None
[0m02:41:08.434231 [info ] [MainThread]:   keepalives_idle: 0
[0m02:41:08.436507 [info ] [MainThread]:   sslmode: None
[0m02:41:08.438030 [info ] [MainThread]:   sslcert: None
[0m02:41:08.441149 [info ] [MainThread]:   sslkey: None
[0m02:41:08.442190 [info ] [MainThread]:   sslrootcert: None
[0m02:41:08.444313 [info ] [MainThread]:   application_name: dbt
[0m02:41:08.446411 [info ] [MainThread]:   retries: 1
[0m02:41:08.450775 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:41:08.454161 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m02:41:08.907255 [debug] [MainThread]: Using postgres connection "debug"
[0m02:41:08.908367 [debug] [MainThread]: On debug: select 1 as id
[0m02:41:08.909466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:41:09.013923 [debug] [MainThread]: SQL status: SELECT 1 in 0.104 seconds
[0m02:41:09.016214 [debug] [MainThread]: On debug: Close
[0m02:41:09.017723 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:41:09.019200 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:41:09.022668 [debug] [MainThread]: Command `dbt debug` succeeded at 02:41:09.019200 after 1.78 seconds
[0m02:41:09.023183 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:41:09.023183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6994F42C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A69A234560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A69713B2C0>]}
[0m02:41:09.023183 [debug] [MainThread]: Flushing usage events
[0m02:41:35.865029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F0C17110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4ED65FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4EFDF21E0>]}


============================== 02:41:35.872272 | e0525cd9-041d-47b1-bb5a-1da9a3f739cd ==============================
[0m02:41:35.872272 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:41:35.873273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m02:41:36.299745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0525cd9-041d-47b1-bb5a-1da9a3f739cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F108B230>]}
[0m02:41:36.478058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0525cd9-041d-47b1-bb5a-1da9a3f739cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F0B5EBD0>]}
[0m02:41:36.480899 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:41:36.508257 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:41:36.510900 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:41:36.512392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0525cd9-041d-47b1-bb5a-1da9a3f739cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F0F52DE0>]}
[0m02:41:36.527582 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_proj: example\schema.yml - Runtime Error
    Syntax error near line 14
    ------------------------------
    11 |       - name: mysql_film
    12 |       - name: csv_test
    13 | 
    14 | version: 2
    15 | 
    16 | sources:
    17 |   - name: SC1
    
    Raw Error:
    ------------------------------
    did not find expected <document start>
      in "<unicode string>", line 14, column 1
[0m02:41:36.543635 [debug] [MainThread]: Command `dbt run` failed at 02:41:36.543084 after 1.00 seconds
[0m02:41:36.547043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F035ECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F0F52DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F1156EA0>]}
[0m02:41:36.548721 [debug] [MainThread]: Flushing usage events
[0m02:42:04.584944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001596B6966F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001596AFC2E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001596A456AB0>]}


============================== 02:42:04.594811 | 5a4dc4ff-6e66-4cdf-86d9-4b6d890d201d ==============================
[0m02:42:04.594811 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:42:04.596812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m02:42:04.876650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a4dc4ff-6e66-4cdf-86d9-4b6d890d201d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159692A47D0>]}
[0m02:42:04.929649 [debug] [MainThread]: Command `dbt clean` succeeded at 02:42:04.929649 after 0.62 seconds
[0m02:42:04.931669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001596B70DA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159692A47D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001596B7FE330>]}
[0m02:42:04.932670 [debug] [MainThread]: Flushing usage events
[0m02:42:15.771934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160358FB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016035E17110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016035E16450>]}


============================== 02:42:15.781400 | e543ead1-7902-4bc4-b132-c2b079c088bf ==============================
[0m02:42:15.781400 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:42:15.783563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:42:16.272814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e543ead1-7902-4bc4-b132-c2b079c088bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016033CE4740>]}
[0m02:42:16.408775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e543ead1-7902-4bc4-b132-c2b079c088bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001603605E030>]}
[0m02:42:16.412917 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:42:16.447775 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:42:16.452094 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:42:16.453758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e543ead1-7902-4bc4-b132-c2b079c088bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001603683B020>]}
[0m02:42:20.165941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e543ead1-7902-4bc4-b132-c2b079c088bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016037AA0FE0>]}
[0m02:42:20.435630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e543ead1-7902-4bc4-b132-c2b079c088bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016037A50170>]}
[0m02:42:20.438390 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m02:42:20.438390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e543ead1-7902-4bc4-b132-c2b079c088bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016035E165A0>]}
[0m02:42:20.445689 [info ] [MainThread]: 
[0m02:42:20.448741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:42:20.450738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m02:42:20.819965 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m02:42:20.821068 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m02:42:20.822207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:20.926448 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.104 seconds
[0m02:42:20.931312 [debug] [ThreadPool]: On list_res: Close
[0m02:42:20.935004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m02:42:20.950989 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:42:20.951989 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m02:42:20.952991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:21.034170 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m02:42:21.035357 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:42:21.036995 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:42:21.052085 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m02:42:21.054900 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m02:42:21.056518 [debug] [ThreadPool]: On list_res_public: Close
[0m02:42:21.068743 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:21.068743 [debug] [MainThread]: On master: BEGIN
[0m02:42:21.068743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:21.286362 [debug] [MainThread]: SQL status: BEGIN in 0.216 seconds
[0m02:42:21.288389 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:21.289535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:42:21.322933 [debug] [MainThread]: SQL status: SELECT 0 in 0.031 seconds
[0m02:42:21.326358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e543ead1-7902-4bc4-b132-c2b079c088bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016037AA07D0>]}
[0m02:42:21.327956 [debug] [MainThread]: On master: ROLLBACK
[0m02:42:21.327956 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:21.327956 [debug] [MainThread]: On master: BEGIN
[0m02:42:21.331337 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:42:21.331337 [debug] [MainThread]: On master: COMMIT
[0m02:42:21.331337 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:21.335595 [debug] [MainThread]: On master: COMMIT
[0m02:42:21.337608 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:42:21.339384 [debug] [MainThread]: On master: Close
[0m02:42:21.341143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:42:21.342618 [info ] [MainThread]: 
[0m02:42:21.351798 [debug] [Thread-1 (]: Began running node model.dbt_proj.new_film
[0m02:42:21.353825 [info ] [Thread-1 (]: 1 of 1 START sql table model public.new_film ................................... [RUN]
[0m02:42:21.355934 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.new_film'
[0m02:42:21.357447 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.new_film
[0m02:42:21.416290 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.new_film"
[0m02:42:21.424110 [debug] [Thread-1 (]: Began executing node model.dbt_proj.new_film
[0m02:42:21.607459 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.new_film"
[0m02:42:21.616236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m02:42:21.617842 [debug] [Thread-1 (]: On model.dbt_proj.new_film: BEGIN
[0m02:42:21.618853 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:42:21.705889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m02:42:21.707058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m02:42:21.709335 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */

  
    

  create  table "res"."public"."new_film__dbt_tmp"
  
  
    as
  
  (
    -- models/film_query.sql

-- This dbt model retrieves film details with actor count, genre name, release date, and average rating

-- Define the source tables
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id  -- Using cf.id as film_id for joining with average ratings
    FROM ""res"."SC2"."m_film_actor"" a
    INNER JOIN ""res"."SC2"."m_film"" fa ON a.film_id = fa.id 
    INNER JOIN ""res"."SC1"."p_film"" f ON f.name = fa.name 
    INNER JOIN ""res"."SC1"."p_genre"" gr ON f.genre_id = gr.id 
    INNER JOIN ""res"."SC3"."c_films"" cf ON cf.name = fa.name
    GROUP BY fa.name, gr.name, f.release_date, cf.id
),

-- Subquery to calculate average ratings
avg_ratings AS (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM ""res"."SC3"."c_ratings"" r
    GROUP BY r.film_id
)

-- Join film_data with avg_ratings to get final results
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    ar.avg_rating
FROM film_data fd
LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
  );
  
[0m02:42:21.714922 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  identifiant délimité de longueur nulle sur ou près de « "" »
LINE 24:     FROM ""res"."SC2"."m_film_actor"" a
                  ^

[0m02:42:21.716895 [debug] [Thread-1 (]: On model.dbt_proj.new_film: ROLLBACK
[0m02:42:21.718748 [debug] [Thread-1 (]: On model.dbt_proj.new_film: Close
[0m02:42:21.739485 [debug] [Thread-1 (]: Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  identifiant délimité de longueur nulle sur ou près de « "" »
  LINE 24:     FROM ""res"."SC2"."m_film_actor"" a
                    ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m02:42:21.742690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e543ead1-7902-4bc4-b132-c2b079c088bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016038174530>]}
[0m02:42:21.746130 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.new_film .......................... [[31mERROR[0m in 0.38s]
[0m02:42:21.748979 [debug] [Thread-1 (]: Finished running node model.dbt_proj.new_film
[0m02:42:21.752296 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:21.753398 [debug] [MainThread]: On master: BEGIN
[0m02:42:21.754036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:21.881415 [debug] [MainThread]: SQL status: BEGIN in 0.127 seconds
[0m02:42:21.884513 [debug] [MainThread]: On master: COMMIT
[0m02:42:21.888106 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:21.890784 [debug] [MainThread]: On master: COMMIT
[0m02:42:21.892781 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:42:21.893289 [debug] [MainThread]: On master: Close
[0m02:42:21.900145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:21.901762 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m02:42:21.902599 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m02:42:21.904149 [debug] [MainThread]: Connection 'model.dbt_proj.new_film' was properly closed.
[0m02:42:21.905929 [info ] [MainThread]: 
[0m02:42:21.908565 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.46 seconds (1.46s).
[0m02:42:21.913762 [debug] [MainThread]: Command end result
[0m02:42:22.003569 [info ] [MainThread]: 
[0m02:42:22.004568 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:42:22.006575 [info ] [MainThread]: 
[0m02:42:22.007578 [error] [MainThread]:   Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  identifiant délimité de longueur nulle sur ou près de « "" »
  LINE 24:     FROM ""res"."SC2"."m_film_actor"" a
                    ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m02:42:22.011726 [info ] [MainThread]: 
[0m02:42:22.013728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:42:22.017473 [debug] [MainThread]: Command `dbt run` failed at 02:42:22.017473 after 6.56 seconds
[0m02:42:22.018712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160359C1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160359C0B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001603795C6B0>]}
[0m02:42:22.019221 [debug] [MainThread]: Flushing usage events
[0m02:42:54.129032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E79EF920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E9BE2E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E6B6AFC0>]}


============================== 02:42:54.129032 | 79082b24-abbb-4bb5-8b72-4806540cb112 ==============================
[0m02:42:54.129032 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:42:54.137252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:42:54.346878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79082b24-abbb-4bb5-8b72-4806540cb112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EA46B830>]}
[0m02:42:54.413803 [debug] [MainThread]: Command `dbt clean` succeeded at 02:42:54.413803 after 0.46 seconds
[0m02:42:54.414883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EA19A480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EA2605C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247EA4E35F0>]}
[0m02:42:54.416514 [debug] [MainThread]: Flushing usage events
[0m02:42:54.727313 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m02:43:02.387865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC7B88260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC833D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC4B7B140>]}


============================== 02:43:02.398750 | 09cf62ed-32f3-46c0-aadb-c3da19302477 ==============================
[0m02:43:02.398750 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:43:02.401058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:43:02.811309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09cf62ed-32f3-46c0-aadb-c3da19302477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC84A07D0>]}
[0m02:43:02.946178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09cf62ed-32f3-46c0-aadb-c3da19302477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC7B146E0>]}
[0m02:43:02.948698 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:43:02.971298 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:43:02.974298 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:43:02.975317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09cf62ed-32f3-46c0-aadb-c3da19302477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC802D760>]}
[0m02:43:06.036492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09cf62ed-32f3-46c0-aadb-c3da19302477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC9C6C470>]}
[0m02:43:06.244393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09cf62ed-32f3-46c0-aadb-c3da19302477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC9C2F2C0>]}
[0m02:43:06.245398 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m02:43:06.247319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09cf62ed-32f3-46c0-aadb-c3da19302477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC8690170>]}
[0m02:43:06.250461 [info ] [MainThread]: 
[0m02:43:06.252473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:43:06.255168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m02:43:06.581176 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m02:43:06.582794 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m02:43:06.583906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:06.705535 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.121 seconds
[0m02:43:06.710991 [debug] [ThreadPool]: On list_res: Close
[0m02:43:06.715377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m02:43:06.733099 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:43:06.735483 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m02:43:06.737430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:06.836745 [debug] [ThreadPool]: SQL status: BEGIN in 0.099 seconds
[0m02:43:06.837270 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:43:06.838372 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:43:06.846501 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m02:43:06.848988 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m02:43:06.849987 [debug] [ThreadPool]: On list_res_public: Close
[0m02:43:06.858467 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:06.858467 [debug] [MainThread]: On master: BEGIN
[0m02:43:06.860510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:43:06.943674 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m02:43:06.943674 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:06.946186 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:43:06.971075 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m02:43:06.974103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09cf62ed-32f3-46c0-aadb-c3da19302477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC9C9EBA0>]}
[0m02:43:06.975107 [debug] [MainThread]: On master: ROLLBACK
[0m02:43:06.976620 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:06.977631 [debug] [MainThread]: On master: BEGIN
[0m02:43:06.979642 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:43:06.980881 [debug] [MainThread]: On master: COMMIT
[0m02:43:06.981897 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:06.982903 [debug] [MainThread]: On master: COMMIT
[0m02:43:06.983896 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:43:06.986105 [debug] [MainThread]: On master: Close
[0m02:43:06.987614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:43:06.987614 [info ] [MainThread]: 
[0m02:43:06.995004 [debug] [Thread-1 (]: Began running node model.dbt_proj.new_film
[0m02:43:06.998413 [info ] [Thread-1 (]: 1 of 1 START sql table model public.new_film ................................... [RUN]
[0m02:43:07.002082 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.new_film'
[0m02:43:07.003813 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.new_film
[0m02:43:07.030256 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.new_film"
[0m02:43:07.040981 [debug] [Thread-1 (]: Began executing node model.dbt_proj.new_film
[0m02:43:07.258284 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.new_film"
[0m02:43:07.266325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m02:43:07.269353 [debug] [Thread-1 (]: On model.dbt_proj.new_film: BEGIN
[0m02:43:07.271365 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:43:07.355153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m02:43:07.357894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.new_film"
[0m02:43:07.359784 [debug] [Thread-1 (]: On model.dbt_proj.new_film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.new_film"} */

  
    

  create  table "res"."public"."new_film__dbt_tmp"
  
  
    as
  
  (
    -- models/film_query.sql

-- This dbt model retrieves film details with actor count, genre name, release date, and average rating

-- Define the source tables
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id  -- Using cf.id as film_id for joining with average ratings
    FROM ""res"."SC2"."m_film_actor"" a
    INNER JOIN ""res"."SC2"."m_film"" fa ON a.film_id = fa.id 
    INNER JOIN ""res"."SC1"."p_film"" f ON f.name = fa.name 
    INNER JOIN ""res"."SC1"."p_genre"" gr ON f.genre_id = gr.id 
    INNER JOIN ""res"."SC3"."c_films"" cf ON cf.name = fa.name
    GROUP BY fa.name, gr.name, f.release_date, cf.id
),

-- Subquery to calculate average ratings
avg_ratings AS (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM ""res"."SC3"."c_ratings"" r
    GROUP BY r.film_id
)

-- Join film_data with avg_ratings to get final results
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    ar.avg_rating
FROM film_data fd
LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
  );
  
[0m02:43:07.362635 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  identifiant délimité de longueur nulle sur ou près de « "" »
LINE 24:     FROM ""res"."SC2"."m_film_actor"" a
                  ^

[0m02:43:07.365005 [debug] [Thread-1 (]: On model.dbt_proj.new_film: ROLLBACK
[0m02:43:07.367378 [debug] [Thread-1 (]: On model.dbt_proj.new_film: Close
[0m02:43:07.381961 [debug] [Thread-1 (]: Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  identifiant délimité de longueur nulle sur ou près de « "" »
  LINE 24:     FROM ""res"."SC2"."m_film_actor"" a
                    ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m02:43:07.385214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09cf62ed-32f3-46c0-aadb-c3da19302477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC9C9F230>]}
[0m02:43:07.387019 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.new_film .......................... [[31mERROR[0m in 0.38s]
[0m02:43:07.389238 [debug] [Thread-1 (]: Finished running node model.dbt_proj.new_film
[0m02:43:07.393521 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:07.394559 [debug] [MainThread]: On master: BEGIN
[0m02:43:07.395092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:43:07.490053 [debug] [MainThread]: SQL status: BEGIN in 0.095 seconds
[0m02:43:07.491677 [debug] [MainThread]: On master: COMMIT
[0m02:43:07.492741 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:07.493818 [debug] [MainThread]: On master: COMMIT
[0m02:43:07.494902 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:43:07.495967 [debug] [MainThread]: On master: Close
[0m02:43:07.497586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:07.498683 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m02:43:07.499755 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m02:43:07.500831 [debug] [MainThread]: Connection 'model.dbt_proj.new_film' was properly closed.
[0m02:43:07.501975 [info ] [MainThread]: 
[0m02:43:07.503489 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m02:43:07.506042 [debug] [MainThread]: Command end result
[0m02:43:07.582818 [info ] [MainThread]: 
[0m02:43:07.585028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:43:07.593085 [info ] [MainThread]: 
[0m02:43:07.595240 [error] [MainThread]:   Database Error in model new_film (models\example\new_film.sql)
  ERREUR:  identifiant délimité de longueur nulle sur ou près de « "" »
  LINE 24:     FROM ""res"."SC2"."m_film_actor"" a
                    ^
  compiled Code at target\run\dbt_proj\models\example\new_film.sql
[0m02:43:07.598194 [info ] [MainThread]: 
[0m02:43:07.600991 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:43:07.608075 [debug] [MainThread]: Command `dbt run` failed at 02:43:07.607555 after 5.56 seconds
[0m02:43:07.609783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC833D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CCA1A31A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CC7776540>]}
[0m02:43:07.610292 [debug] [MainThread]: Flushing usage events
[0m02:44:37.661043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF5D5F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF829AE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF85092B0>]}


============================== 02:44:37.670310 | b84393e4-a2bb-4752-9a50-ae229cbe0ba1 ==============================
[0m02:44:37.670310 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:44:37.672210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:44:37.972553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b84393e4-a2bb-4752-9a50-ae229cbe0ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF7AAD820>]}
[0m02:44:38.027823 [debug] [MainThread]: Command `dbt clean` succeeded at 02:44:38.027281 after 0.74 seconds
[0m02:44:38.027823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF5D5F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF7AAD820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF878E330>]}
[0m02:44:38.027823 [debug] [MainThread]: Flushing usage events
[0m02:44:46.902371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D4D92B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774CCECEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D4F6630>]}


============================== 02:44:46.912011 | 5c565461-8482-4ace-a9c5-47480aed6d6d ==============================
[0m02:44:46.912011 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:44:46.912011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:44:47.438755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c565461-8482-4ace-a9c5-47480aed6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D6AB170>]}
[0m02:44:47.599470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c565461-8482-4ace-a9c5-47480aed6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D572930>]}
[0m02:44:47.602482 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:44:47.630340 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:44:47.633341 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:44:47.634549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c565461-8482-4ace-a9c5-47480aed6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D295880>]}
[0m02:44:51.809099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c565461-8482-4ace-a9c5-47480aed6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774DD57740>]}
[0m02:44:52.175271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c565461-8482-4ace-a9c5-47480aed6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774EEBD490>]}
[0m02:44:52.178121 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m02:44:52.184693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c565461-8482-4ace-a9c5-47480aed6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774EE5EC00>]}
[0m02:44:52.190904 [info ] [MainThread]: 
[0m02:44:52.193759 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:44:52.203281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m02:44:52.706495 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m02:44:52.707596 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m02:44:52.708750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:52.814576 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.106 seconds
[0m02:44:52.818576 [debug] [ThreadPool]: On list_res: Close
[0m02:44:52.824136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m02:44:52.841817 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:44:52.842829 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m02:44:52.843829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:52.956593 [debug] [ThreadPool]: SQL status: BEGIN in 0.113 seconds
[0m02:44:52.959042 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:44:52.961552 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:44:52.975110 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m02:44:52.982149 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m02:44:52.984535 [debug] [ThreadPool]: On list_res_public: Close
[0m02:44:52.996617 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:52.998348 [debug] [MainThread]: On master: BEGIN
[0m02:44:53.000918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:53.084517 [debug] [MainThread]: SQL status: BEGIN in 0.086 seconds
[0m02:44:53.088147 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:53.088147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:53.112561 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m02:44:53.116945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c565461-8482-4ace-a9c5-47480aed6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774DE5C860>]}
[0m02:44:53.118249 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:53.118249 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:53.120307 [debug] [MainThread]: On master: BEGIN
[0m02:44:53.121319 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:44:53.121319 [debug] [MainThread]: On master: COMMIT
[0m02:44:53.121319 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:53.121319 [debug] [MainThread]: On master: COMMIT
[0m02:44:53.126356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:44:53.127867 [debug] [MainThread]: On master: Close
[0m02:44:53.131042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:53.132210 [info ] [MainThread]: 
[0m02:44:53.137233 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m02:44:53.141247 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m02:44:53.141247 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m02:44:53.146043 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m02:44:53.170933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m02:44:53.175969 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m02:44:53.473999 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m02:44:53.486417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:44:53.487918 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m02:44:53.489943 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:44:53.608561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m02:44:53.609667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:44:53.611925 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film_query.sql

-- This dbt model retrieves film details with actor count, genre name, release date, and average rating

-- Define the source tables
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id  -- Using cf.id as film_id for joining with average ratings
    FROM ""res"."SC2"."m_film_actor"" a
    INNER JOIN ""res"."SC2"."m_film"" fa ON a.film_id = fa.id 
    INNER JOIN ""res"."SC1"."p_film"" f ON f.name = fa.name 
    INNER JOIN ""res"."SC1"."p_genre"" gr ON f.genre_id = gr.id 
    INNER JOIN ""res"."SC3"."c_films"" cf ON cf.name = fa.name
    GROUP BY fa.name, gr.name, f.release_date, cf.id
),

-- Subquery to calculate average ratings
avg_ratings AS (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM ""res"."SC3"."c_ratings"" r
    GROUP BY r.film_id
)

-- Join film_data with avg_ratings to get final results
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    ar.avg_rating
FROM film_data fd
LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
  );
  
[0m02:44:53.614390 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  identifiant délimité de longueur nulle sur ou près de « "" »
LINE 24:     FROM ""res"."SC2"."m_film_actor"" a
                  ^

[0m02:44:53.616790 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m02:44:53.618619 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m02:44:53.632656 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  identifiant délimité de longueur nulle sur ou près de « "" »
  LINE 24:     FROM ""res"."SC2"."m_film_actor"" a
                    ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:44:53.636379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c565461-8482-4ace-a9c5-47480aed6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774EE8A150>]}
[0m02:44:53.638378 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.49s]
[0m02:44:53.640887 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m02:44:53.645952 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:53.646955 [debug] [MainThread]: On master: BEGIN
[0m02:44:53.649054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:53.769390 [debug] [MainThread]: SQL status: BEGIN in 0.121 seconds
[0m02:44:53.770899 [debug] [MainThread]: On master: COMMIT
[0m02:44:53.772923 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:53.773922 [debug] [MainThread]: On master: COMMIT
[0m02:44:53.774933 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:44:53.776868 [debug] [MainThread]: On master: Close
[0m02:44:53.778389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:53.779405 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m02:44:53.781973 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m02:44:53.782996 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m02:44:53.785001 [info ] [MainThread]: 
[0m02:44:53.786000 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m02:44:53.789051 [debug] [MainThread]: Command end result
[0m02:44:53.927792 [info ] [MainThread]: 
[0m02:44:53.930201 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:44:53.932299 [info ] [MainThread]: 
[0m02:44:53.934322 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  identifiant délimité de longueur nulle sur ou près de « "" »
  LINE 24:     FROM ""res"."SC2"."m_film_actor"" a
                    ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:44:53.937333 [info ] [MainThread]: 
[0m02:44:53.939400 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:44:53.943454 [debug] [MainThread]: Command `dbt run` failed at 02:44:53.943454 after 7.41 seconds
[0m02:44:53.946471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D2C6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774DD3F680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774DD3CA10>]}
[0m02:44:53.948471 [debug] [MainThread]: Flushing usage events
[0m02:49:45.374408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD1C18380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD1C1AE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD1C187D0>]}


============================== 02:49:45.385808 | 81365df0-ff47-42be-bd14-90b1edbea78c ==============================
[0m02:49:45.385808 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:49:45.389316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m02:49:45.681759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81365df0-ff47-42be-bd14-90b1edbea78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD20BBB00>]}
[0m02:49:45.737700 [debug] [MainThread]: Command `dbt clean` succeeded at 02:49:45.736803 after 0.74 seconds
[0m02:49:45.739445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD22DD790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD1A73230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD266ECF0>]}
[0m02:49:45.742607 [debug] [MainThread]: Flushing usage events
[0m02:49:53.921017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BF637920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BED7AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BF6379E0>]}


============================== 02:49:53.931410 | f14470da-4e8a-4978-904e-2c9683bbc66f ==============================
[0m02:49:53.931410 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:49:53.933329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:49:54.395999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f14470da-4e8a-4978-904e-2c9683bbc66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BE804B00>]}
[0m02:49:54.541416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f14470da-4e8a-4978-904e-2c9683bbc66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BF637B00>]}
[0m02:49:54.543571 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:49:54.566022 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:49:54.570050 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:49:54.572050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f14470da-4e8a-4978-904e-2c9683bbc66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BCE478F0>]}
[0m02:49:57.585908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f14470da-4e8a-4978-904e-2c9683bbc66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C0E2A300>]}
[0m02:49:57.829270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f14470da-4e8a-4978-904e-2c9683bbc66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C0C53D40>]}
[0m02:49:57.829270 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m02:49:57.831297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14470da-4e8a-4978-904e-2c9683bbc66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C0DF1760>]}
[0m02:49:57.834315 [info ] [MainThread]: 
[0m02:49:57.834315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:49:57.839137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m02:49:58.107470 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m02:49:58.108546 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m02:49:58.110163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:58.186507 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.083 seconds
[0m02:49:58.195913 [debug] [ThreadPool]: On list_res: Close
[0m02:49:58.198591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m02:49:58.205652 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:49:58.214118 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m02:49:58.216268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:58.370800 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m02:49:58.372442 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:49:58.374071 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:49:58.387565 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m02:49:58.391447 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m02:49:58.392514 [debug] [ThreadPool]: On list_res_public: Close
[0m02:49:58.408151 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:58.411081 [debug] [MainThread]: On master: BEGIN
[0m02:49:58.412770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:58.520491 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m02:49:58.522001 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:58.522001 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:49:58.557287 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m02:49:58.560578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14470da-4e8a-4978-904e-2c9683bbc66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C0D4FBC0>]}
[0m02:49:58.562328 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:58.564089 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:58.566323 [debug] [MainThread]: On master: BEGIN
[0m02:49:58.569141 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:49:58.570792 [debug] [MainThread]: On master: COMMIT
[0m02:49:58.571889 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:58.573058 [debug] [MainThread]: On master: COMMIT
[0m02:49:58.574688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:49:58.576326 [debug] [MainThread]: On master: Close
[0m02:49:58.577970 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:58.580540 [info ] [MainThread]: 
[0m02:49:58.589268 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m02:49:58.590435 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m02:49:58.593045 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m02:49:58.593975 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m02:49:58.623312 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m02:49:58.627504 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m02:49:58.819131 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m02:49:58.824862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:49:58.825885 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m02:49:58.825885 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:49:58.909301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m02:49:58.909301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:49:58.909301 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film_query.sql

-- This dbt model retrieves film details with actor count, genre name, release date, and average rating

-- Define the source tables
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id  -- Using cf.id as film_id for joining with average ratings
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, gr.name, f.release_date, cf.id
),

-- Subquery to calculate average ratings
avg_ratings AS (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    GROUP BY r.film_id
)

-- Join film_data with avg_ratings to get final results
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    ar.avg_rating
FROM film_data fd
LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
  );
  
[0m02:49:58.915362 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                            ^

[0m02:49:58.915362 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m02:49:58.915362 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m02:49:58.927053 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                              ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:49:58.930067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14470da-4e8a-4978-904e-2c9683bbc66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C15177A0>]}
[0m02:49:58.930067 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.34s]
[0m02:49:58.935286 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m02:49:58.939393 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:58.939393 [debug] [MainThread]: On master: BEGIN
[0m02:49:58.939393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:59.003970 [debug] [MainThread]: SQL status: BEGIN in 0.070 seconds
[0m02:49:59.003970 [debug] [MainThread]: On master: COMMIT
[0m02:49:59.014165 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:59.015682 [debug] [MainThread]: On master: COMMIT
[0m02:49:59.016470 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:49:59.017990 [debug] [MainThread]: On master: Close
[0m02:49:59.017990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:59.017990 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m02:49:59.017990 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m02:49:59.017990 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m02:49:59.024000 [info ] [MainThread]: 
[0m02:49:59.024000 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m02:49:59.030445 [debug] [MainThread]: Command end result
[0m02:49:59.148044 [info ] [MainThread]: 
[0m02:49:59.149838 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:49:59.154933 [info ] [MainThread]: 
[0m02:49:59.158710 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                              ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:49:59.161395 [info ] [MainThread]: 
[0m02:49:59.163005 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:49:59.166893 [debug] [MainThread]: Command `dbt run` failed at 02:49:59.166893 after 5.50 seconds
[0m02:49:59.167979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BEBECB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C0DD3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BE58B6E0>]}
[0m02:49:59.169476 [debug] [MainThread]: Flushing usage events
[0m02:51:08.416839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E1EE0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E24F92B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E23F4800>]}


============================== 02:51:08.425438 | d552918c-ca1f-47dd-8cd8-f689f86defdf ==============================
[0m02:51:08.425438 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:51:08.429430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:51:08.489028 [info ] [MainThread]: dbt version: 1.8.3
[0m02:51:08.490632 [info ] [MainThread]: python version: 3.12.2
[0m02:51:08.491786 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m02:51:08.493996 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m02:51:08.666857 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m02:51:08.666857 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m02:51:08.673872 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m02:51:08.678278 [info ] [MainThread]: adapter type: postgres
[0m02:51:08.682704 [info ] [MainThread]: adapter version: 1.8.2
[0m02:51:08.928060 [info ] [MainThread]: Configuration:
[0m02:51:08.928060 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:51:08.928060 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:51:08.932361 [info ] [MainThread]: Required dependencies:
[0m02:51:08.934909 [debug] [MainThread]: Executing "git --help"
[0m02:51:09.028210 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:51:09.030222 [debug] [MainThread]: STDERR: "b''"
[0m02:51:09.031215 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:51:09.032214 [info ] [MainThread]: Connection:
[0m02:51:09.033723 [info ] [MainThread]:   host: localhost
[0m02:51:09.035765 [info ] [MainThread]:   port: 5432
[0m02:51:09.036763 [info ] [MainThread]:   user: postgres
[0m02:51:09.038277 [info ] [MainThread]:   database: res
[0m02:51:09.039292 [info ] [MainThread]:   schema: public
[0m02:51:09.041288 [info ] [MainThread]:   connect_timeout: 10
[0m02:51:09.042290 [info ] [MainThread]:   role: None
[0m02:51:09.044840 [info ] [MainThread]:   search_path: None
[0m02:51:09.045952 [info ] [MainThread]:   keepalives_idle: 0
[0m02:51:09.052539 [info ] [MainThread]:   sslmode: None
[0m02:51:09.057947 [info ] [MainThread]:   sslcert: None
[0m02:51:09.065245 [info ] [MainThread]:   sslkey: None
[0m02:51:09.067982 [info ] [MainThread]:   sslrootcert: None
[0m02:51:09.080163 [info ] [MainThread]:   application_name: dbt
[0m02:51:09.082331 [info ] [MainThread]:   retries: 1
[0m02:51:09.084480 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:51:09.087226 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m02:51:09.258293 [debug] [MainThread]: Using postgres connection "debug"
[0m02:51:09.260306 [debug] [MainThread]: On debug: select 1 as id
[0m02:51:09.260306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:51:09.348091 [debug] [MainThread]: SQL status: SELECT 1 in 0.087 seconds
[0m02:51:09.350090 [debug] [MainThread]: On debug: Close
[0m02:51:09.351092 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:51:09.352553 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:51:09.356089 [debug] [MainThread]: Command `dbt debug` succeeded at 02:51:09.356089 after 1.22 seconds
[0m02:51:09.357100 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:51:09.358099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E1EE0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247DFC14F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E28308F0>]}
[0m02:51:09.359448 [debug] [MainThread]: Flushing usage events
[0m02:51:17.721273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E811C7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFF6BD520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFFDA5CD0>]}


============================== 02:51:17.731023 | 921df58b-81b4-4a30-ae46-7c3b1c0f865c ==============================
[0m02:51:17.731023 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:51:17.732660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:51:18.060397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '921df58b-81b4-4a30-ae46-7c3b1c0f865c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E8204A030>]}
[0m02:51:18.119453 [debug] [MainThread]: Command `dbt clean` succeeded at 02:51:18.118433 after 0.71 seconds
[0m02:51:18.120466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E8204A030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E810DAC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E810D9B80>]}
[0m02:51:18.121930 [debug] [MainThread]: Flushing usage events
[0m02:51:26.559232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C38D3E870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C38D3E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C38D3EB10>]}


============================== 02:51:26.565515 | 8b160b01-0c32-4948-96be-60e07fe879ee ==============================
[0m02:51:26.565515 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:51:26.567153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m02:51:27.045809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b160b01-0c32-4948-96be-60e07fe879ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C38D8B0E0>]}
[0m02:51:27.168782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b160b01-0c32-4948-96be-60e07fe879ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C38D57770>]}
[0m02:51:27.171794 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:51:27.191806 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:51:27.195029 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:51:27.197147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b160b01-0c32-4948-96be-60e07fe879ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C38A30A40>]}
[0m02:51:30.363965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b160b01-0c32-4948-96be-60e07fe879ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C3A5075C0>]}
[0m02:51:30.569210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b160b01-0c32-4948-96be-60e07fe879ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C36980C20>]}
[0m02:51:30.573653 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m02:51:30.576765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b160b01-0c32-4948-96be-60e07fe879ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C3A4DE450>]}
[0m02:51:30.581148 [info ] [MainThread]: 
[0m02:51:30.583177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:51:30.585700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m02:51:30.835609 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m02:51:30.836623 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m02:51:30.837634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:30.937676 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.100 seconds
[0m02:51:30.941223 [debug] [ThreadPool]: On list_res: Close
[0m02:51:30.944755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m02:51:30.973705 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:51:30.975482 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m02:51:30.976505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:31.088325 [debug] [ThreadPool]: SQL status: BEGIN in 0.111 seconds
[0m02:51:31.089323 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:51:31.091577 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:51:31.104356 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m02:51:31.108813 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m02:51:31.110553 [debug] [ThreadPool]: On list_res_public: Close
[0m02:51:31.125636 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:31.126664 [debug] [MainThread]: On master: BEGIN
[0m02:51:31.127676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:51:31.233903 [debug] [MainThread]: SQL status: BEGIN in 0.106 seconds
[0m02:51:31.233903 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:31.235672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:51:31.264368 [debug] [MainThread]: SQL status: SELECT 0 in 0.026 seconds
[0m02:51:31.267735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b160b01-0c32-4948-96be-60e07fe879ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C37E0E660>]}
[0m02:51:31.269384 [debug] [MainThread]: On master: ROLLBACK
[0m02:51:31.270489 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:31.271026 [debug] [MainThread]: On master: BEGIN
[0m02:51:31.272165 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:51:31.273216 [debug] [MainThread]: On master: COMMIT
[0m02:51:31.273734 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:31.274813 [debug] [MainThread]: On master: COMMIT
[0m02:51:31.275372 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:51:31.275372 [debug] [MainThread]: On master: Close
[0m02:51:31.277510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:51:31.278583 [info ] [MainThread]: 
[0m02:51:31.285163 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m02:51:31.286170 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m02:51:31.288294 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m02:51:31.289304 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m02:51:31.314851 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m02:51:31.319211 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m02:51:31.534834 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m02:51:31.538839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:51:31.540051 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m02:51:31.541432 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:51:31.635563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m02:51:31.639073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:51:31.640081 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film_query.sql

-- This dbt model retrieves film details with actor count, genre name, release date, and average rating

-- Define the source tables
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id  -- Using cf.id as film_id for joining with average ratings
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, gr.name, f.release_date, cf.id
),

-- Subquery to calculate average ratings
avg_ratings AS (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    GROUP BY r.film_id
)

-- Join film_data with avg_ratings to get final results
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    ar.avg_rating
FROM film_data fd
LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
  );
  
[0m02:51:31.641680 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                            ^

[0m02:51:31.643690 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m02:51:31.645528 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m02:51:31.658767 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                              ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:51:31.662635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b160b01-0c32-4948-96be-60e07fe879ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C384A09B0>]}
[0m02:51:31.663656 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.37s]
[0m02:51:31.666933 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m02:51:31.671088 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:31.672268 [debug] [MainThread]: On master: BEGIN
[0m02:51:31.672268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:51:31.786054 [debug] [MainThread]: SQL status: BEGIN in 0.113 seconds
[0m02:51:31.787787 [debug] [MainThread]: On master: COMMIT
[0m02:51:31.789630 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:31.790138 [debug] [MainThread]: On master: COMMIT
[0m02:51:31.791943 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:51:31.793231 [debug] [MainThread]: On master: Close
[0m02:51:31.794847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:31.795391 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m02:51:31.796751 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m02:51:31.797851 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m02:51:31.799218 [info ] [MainThread]: 
[0m02:51:31.800820 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m02:51:31.803547 [debug] [MainThread]: Command end result
[0m02:51:31.883952 [info ] [MainThread]: 
[0m02:51:31.885145 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:51:31.887344 [info ] [MainThread]: 
[0m02:51:31.889357 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                              ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:51:31.892356 [info ] [MainThread]: 
[0m02:51:31.893869 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:51:31.896880 [debug] [MainThread]: Command `dbt run` failed at 02:51:31.896880 after 5.62 seconds
[0m02:51:31.897741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C3A5AA1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C3AA813A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C384EB200>]}
[0m02:51:31.897741 [debug] [MainThread]: Flushing usage events
[0m02:54:33.727909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF227E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF227DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF2344980>]}


============================== 02:54:33.736679 | b1fe6f46-9a45-4ca2-a4bc-8b3a546c7813 ==============================
[0m02:54:33.736679 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:54:33.738682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:54:34.192820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1fe6f46-9a45-4ca2-a4bc-8b3a546c7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF2C107D0>]}
[0m02:54:34.284659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1fe6f46-9a45-4ca2-a4bc-8b3a546c7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF2B6BC80>]}
[0m02:54:34.286350 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:54:34.300431 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:54:34.560648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:54:34.562309 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\film.sql
[0m02:54:35.012116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1fe6f46-9a45-4ca2-a4bc-8b3a546c7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF30A6C30>]}
[0m02:54:35.239229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1fe6f46-9a45-4ca2-a4bc-8b3a546c7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF43E5A90>]}
[0m02:54:35.241311 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m02:54:35.242539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1fe6f46-9a45-4ca2-a4bc-8b3a546c7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF2660830>]}
[0m02:54:35.245608 [info ] [MainThread]: 
[0m02:54:35.247049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:54:35.249628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m02:54:35.465510 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m02:54:35.466592 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m02:54:35.467606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:35.563759 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.096 seconds
[0m02:54:35.567888 [debug] [ThreadPool]: On list_res: Close
[0m02:54:35.572203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m02:54:35.587014 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:54:35.588666 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m02:54:35.590139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:35.687485 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m02:54:35.688954 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:54:35.690195 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:54:35.701527 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m02:54:35.704592 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m02:54:35.706612 [debug] [ThreadPool]: On list_res_public: Close
[0m02:54:35.718097 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:35.719102 [debug] [MainThread]: On master: BEGIN
[0m02:54:35.720612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:54:35.819225 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m02:54:35.820311 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:35.821971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:54:35.847782 [debug] [MainThread]: SQL status: SELECT 0 in 0.024 seconds
[0m02:54:35.850425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1fe6f46-9a45-4ca2-a4bc-8b3a546c7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF492B650>]}
[0m02:54:35.851481 [debug] [MainThread]: On master: ROLLBACK
[0m02:54:35.852557 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:35.853079 [debug] [MainThread]: On master: BEGIN
[0m02:54:35.854691 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:54:35.855230 [debug] [MainThread]: On master: COMMIT
[0m02:54:35.856295 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:35.856815 [debug] [MainThread]: On master: COMMIT
[0m02:54:35.857876 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:54:35.857876 [debug] [MainThread]: On master: Close
[0m02:54:35.859890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:54:35.867400 [info ] [MainThread]: 
[0m02:54:35.877411 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m02:54:35.878567 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m02:54:35.881253 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m02:54:35.882314 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m02:54:35.909954 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m02:54:35.913047 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m02:54:36.074117 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m02:54:36.076262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:54:36.078252 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m02:54:36.079327 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:54:36.173936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m02:54:36.174950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:54:36.177086 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film_query.sql

-- This dbt model retrieves film details with actor count, genre name, release date, and average rating

-- Define the source tables
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id  -- Using cf.id as film_id for joining with average ratings
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, gr.name, f.release_date, cf.id
),

-- Subquery to calculate average ratings
avg_ratings AS (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    GROUP BY r.film_id
)

-- Final query combining film_data with avg_ratings
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    ar.avg_rating
FROM film_data fd
LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
  );
  
[0m02:54:36.182465 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                            ^

[0m02:54:36.184730 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m02:54:36.186900 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m02:54:36.203102 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                              ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:54:36.207549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1fe6f46-9a45-4ca2-a4bc-8b3a546c7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF42DA5A0>]}
[0m02:54:36.209791 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.32s]
[0m02:54:36.212478 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m02:54:36.217593 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:36.218814 [debug] [MainThread]: On master: BEGIN
[0m02:54:36.219829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:54:36.314088 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m02:54:36.315114 [debug] [MainThread]: On master: COMMIT
[0m02:54:36.317567 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:36.318565 [debug] [MainThread]: On master: COMMIT
[0m02:54:36.319566 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:54:36.320567 [debug] [MainThread]: On master: Close
[0m02:54:36.321569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:54:36.323081 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m02:54:36.324135 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m02:54:36.325569 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m02:54:36.326583 [info ] [MainThread]: 
[0m02:54:36.327588 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m02:54:36.329643 [debug] [MainThread]: Command end result
[0m02:54:36.388806 [info ] [MainThread]: 
[0m02:54:36.390864 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:54:36.391862 [info ] [MainThread]: 
[0m02:54:36.391862 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                              ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:54:36.394073 [info ] [MainThread]: 
[0m02:54:36.396585 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:54:36.399633 [debug] [MainThread]: Command `dbt run` failed at 02:54:36.399633 after 3.07 seconds
[0m02:54:36.400629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF2623F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF2873C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF22E2CF0>]}
[0m02:54:36.401624 [debug] [MainThread]: Flushing usage events
[0m02:54:55.000642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D928146720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D92587FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9249FB3E0>]}


============================== 02:54:55.008802 | f59fd038-d34d-4a5e-bf8a-ec8e471b6311 ==============================
[0m02:54:55.008802 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:54:55.011819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:54:55.331078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f59fd038-d34d-4a5e-bf8a-ec8e471b6311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9282CA330>]}
[0m02:54:55.381832 [debug] [MainThread]: Command `dbt clean` succeeded at 02:54:55.380816 after 0.64 seconds
[0m02:54:55.383343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D92812BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D928029A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9282AEB40>]}
[0m02:54:55.384356 [debug] [MainThread]: Flushing usage events
[0m02:55:06.462965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F62A58170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F5F5B6CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F62D29010>]}


============================== 02:55:06.468669 | 7f50d9c8-c40f-4618-bea0-444926677903 ==============================
[0m02:55:06.468669 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:55:06.470677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:55:06.809638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f50d9c8-c40f-4618-bea0-444926677903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F621D3080>]}
[0m02:55:06.968565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f50d9c8-c40f-4618-bea0-444926677903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F62D29A30>]}
[0m02:55:06.970751 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:55:06.990646 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:55:06.993164 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:55:06.995182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f50d9c8-c40f-4618-bea0-444926677903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F633E8140>]}
[0m02:55:09.863260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f50d9c8-c40f-4618-bea0-444926677903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F64691070>]}
[0m02:55:10.137059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f50d9c8-c40f-4618-bea0-444926677903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F64712A50>]}
[0m02:55:10.139218 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m02:55:10.140245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f50d9c8-c40f-4618-bea0-444926677903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F63526C60>]}
[0m02:55:10.146603 [info ] [MainThread]: 
[0m02:55:10.150528 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:55:10.158114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m02:55:10.451481 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m02:55:10.454103 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m02:55:10.457209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:10.552127 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.095 seconds
[0m02:55:10.555201 [debug] [ThreadPool]: On list_res: Close
[0m02:55:10.557213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m02:55:10.568153 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:55:10.569150 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m02:55:10.570150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:10.638231 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m02:55:10.638231 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:55:10.638231 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:55:10.645723 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m02:55:10.648748 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m02:55:10.649751 [debug] [ThreadPool]: On list_res_public: Close
[0m02:55:10.660050 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:10.661387 [debug] [MainThread]: On master: BEGIN
[0m02:55:10.663723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:55:10.754670 [debug] [MainThread]: SQL status: BEGIN in 0.091 seconds
[0m02:55:10.755968 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:10.756979 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:55:10.790693 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m02:55:10.796832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f50d9c8-c40f-4618-bea0-444926677903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F634772C0>]}
[0m02:55:10.798432 [debug] [MainThread]: On master: ROLLBACK
[0m02:55:10.801798 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:10.802562 [debug] [MainThread]: On master: BEGIN
[0m02:55:10.805715 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:55:10.806799 [debug] [MainThread]: On master: COMMIT
[0m02:55:10.807895 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:10.811162 [debug] [MainThread]: On master: COMMIT
[0m02:55:10.812616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:55:10.814787 [debug] [MainThread]: On master: Close
[0m02:55:10.816533 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:55:10.819275 [info ] [MainThread]: 
[0m02:55:10.830360 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m02:55:10.831374 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m02:55:10.834164 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m02:55:10.835677 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m02:55:10.863891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m02:55:10.868520 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m02:55:11.072328 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m02:55:11.077242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:55:11.080562 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m02:55:11.081608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:55:11.173208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m02:55:11.174309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:55:11.175320 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film_query.sql

-- This dbt model retrieves film details with actor count, genre name, release date, and average rating

-- Define the source tables
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id  -- Using cf.id as film_id for joining with average ratings
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, gr.name, f.release_date, cf.id
),

-- Subquery to calculate average ratings
avg_ratings AS (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    GROUP BY r.film_id
)

-- Final query combining film_data with avg_ratings
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    ar.avg_rating
FROM film_data fd
LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
  );
  
[0m02:55:11.177659 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                            ^

[0m02:55:11.179861 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m02:55:11.180874 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m02:55:11.203939 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                              ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:55:11.214375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f50d9c8-c40f-4618-bea0-444926677903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F625B8F50>]}
[0m02:55:11.216766 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.37s]
[0m02:55:11.219107 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m02:55:11.228028 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:11.231315 [debug] [MainThread]: On master: BEGIN
[0m02:55:11.232929 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:55:11.344300 [debug] [MainThread]: SQL status: BEGIN in 0.111 seconds
[0m02:55:11.345895 [debug] [MainThread]: On master: COMMIT
[0m02:55:11.348300 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:11.350488 [debug] [MainThread]: On master: COMMIT
[0m02:55:11.351586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:55:11.353246 [debug] [MainThread]: On master: Close
[0m02:55:11.356320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:55:11.357384 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m02:55:11.358481 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m02:55:11.360110 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m02:55:11.365826 [info ] [MainThread]: 
[0m02:55:11.369203 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m02:55:11.372537 [debug] [MainThread]: Command end result
[0m02:55:11.470113 [info ] [MainThread]: 
[0m02:55:11.471693 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:55:11.473361 [info ] [MainThread]: 
[0m02:55:11.475445 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 49: LEFT JOIN avg_ratings ar ON fd.film_id = ar.film_id;
                                                              ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:55:11.478992 [info ] [MainThread]: 
[0m02:55:11.496213 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:55:11.505445 [debug] [MainThread]: Command `dbt run` failed at 02:55:11.502632 after 5.25 seconds
[0m02:55:11.508242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F63681880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F62A58F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F62A59130>]}
[0m02:55:11.513815 [debug] [MainThread]: Flushing usage events
[0m02:57:48.389567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135AC3B3AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135AC3B2BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135AC3B2C30>]}


============================== 02:57:48.400016 | 7196b644-ba75-4e16-8d45-03e62ab86016 ==============================
[0m02:57:48.400016 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:57:48.402193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:57:48.974646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7196b644-ba75-4e16-8d45-03e62ab86016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135A9F40A40>]}
[0m02:57:49.047848 [debug] [MainThread]: Command `dbt clean` succeeded at 02:57:49.046845 after 1.10 seconds
[0m02:57:49.048844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135ABBFA810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135AC218950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135ABC20080>]}
[0m02:57:49.049849 [debug] [MainThread]: Flushing usage events
[0m02:57:57.578788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CF648560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CCF04AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CFDB92B0>]}


============================== 02:57:57.587474 | 288b2d3a-c90f-44cf-b1ce-0827de580d17 ==============================
[0m02:57:57.587474 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:57:57.590318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:57:58.102277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '288b2d3a-c90f-44cf-b1ce-0827de580d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D002C620>]}
[0m02:57:58.317053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '288b2d3a-c90f-44cf-b1ce-0827de580d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CFF63C80>]}
[0m02:57:58.320357 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:57:58.353672 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:57:58.358693 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:57:58.359710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '288b2d3a-c90f-44cf-b1ce-0827de580d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D00016D0>]}
[0m02:58:02.384189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '288b2d3a-c90f-44cf-b1ce-0827de580d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D1792300>]}
[0m02:58:02.697026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '288b2d3a-c90f-44cf-b1ce-0827de580d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D156D550>]}
[0m02:58:02.698281 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m02:58:02.700685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '288b2d3a-c90f-44cf-b1ce-0827de580d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D1686660>]}
[0m02:58:02.706182 [info ] [MainThread]: 
[0m02:58:02.708206 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:58:02.711824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m02:58:03.026760 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m02:58:03.027903 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m02:58:03.029538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:03.156427 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.127 seconds
[0m02:58:03.160580 [debug] [ThreadPool]: On list_res: Close
[0m02:58:03.167250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m02:58:03.192271 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:58:03.193346 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m02:58:03.194443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:03.287404 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m02:58:03.288013 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:58:03.289026 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:58:03.298555 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m02:58:03.302621 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m02:58:03.303862 [debug] [ThreadPool]: On list_res_public: Close
[0m02:58:03.314443 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:03.316455 [debug] [MainThread]: On master: BEGIN
[0m02:58:03.317455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:03.406593 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m02:58:03.407593 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:03.408594 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:03.438081 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m02:58:03.441391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '288b2d3a-c90f-44cf-b1ce-0827de580d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D1CB2990>]}
[0m02:58:03.442404 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:03.444415 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:03.445636 [debug] [MainThread]: On master: BEGIN
[0m02:58:03.446650 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:58:03.448745 [debug] [MainThread]: On master: COMMIT
[0m02:58:03.449761 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:03.450761 [debug] [MainThread]: On master: COMMIT
[0m02:58:03.453271 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:58:03.453271 [debug] [MainThread]: On master: Close
[0m02:58:03.455784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:03.457243 [info ] [MainThread]: 
[0m02:58:03.476413 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m02:58:03.477424 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m02:58:03.479494 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m02:58:03.481511 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m02:58:03.505698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m02:58:03.509762 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m02:58:03.780176 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m02:58:03.785003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:58:03.786640 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m02:58:03.787735 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:58:03.888390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.101 seconds
[0m02:58:03.890418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:58:03.891405 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film.sql

-- This model calculates film-related statistics including actor count, release date, genre name,
-- and average rating from different schemas.

WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, gr.name, f.release_date, cf.id
)

SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    ar.avg_rating
FROM film_data fd
LEFT JOIN (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    GROUP BY r.film_id
) ar ON ar.film_id = fd.film_id;
  );
  
[0m02:58:03.893954 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 45: ) ar ON ar.film_id = fd.film_id;
                                        ^

[0m02:58:03.896461 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m02:58:03.899480 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m02:58:03.913614 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 45: ) ar ON ar.film_id = fd.film_id;
                                          ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:58:03.932338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '288b2d3a-c90f-44cf-b1ce-0827de580d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299D1E64440>]}
[0m02:58:03.937108 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.45s]
[0m02:58:03.944667 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m02:58:03.949224 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:03.950736 [debug] [MainThread]: On master: BEGIN
[0m02:58:03.954286 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:04.329625 [debug] [MainThread]: SQL status: BEGIN in 0.376 seconds
[0m02:58:04.330626 [debug] [MainThread]: On master: COMMIT
[0m02:58:04.332215 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:04.332725 [debug] [MainThread]: On master: COMMIT
[0m02:58:04.334739 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:58:04.336752 [debug] [MainThread]: On master: Close
[0m02:58:04.337752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:04.339239 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m02:58:04.340252 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m02:58:04.341251 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m02:58:04.341251 [info ] [MainThread]: 
[0m02:58:04.376677 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m02:58:04.380689 [debug] [MainThread]: Command end result
[0m02:58:04.511359 [info ] [MainThread]: 
[0m02:58:04.515387 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:58:04.520169 [info ] [MainThread]: 
[0m02:58:04.524367 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 45: ) ar ON ar.film_id = fd.film_id;
                                          ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:58:04.527667 [info ] [MainThread]: 
[0m02:58:04.536057 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:58:04.544016 [debug] [MainThread]: Command `dbt run` failed at 02:58:04.543385 after 7.30 seconds
[0m02:58:04.545717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CEF17AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CEF17BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299CFC14C20>]}
[0m02:58:04.546986 [debug] [MainThread]: Flushing usage events
[0m02:59:21.366576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FD624800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FD2D2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FCAAC980>]}


============================== 02:59:21.376211 | 06c7c745-d36b-4f24-a503-b63fa48a8083 ==============================
[0m02:59:21.376211 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:59:21.378948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:59:21.869814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c7c745-d36b-4f24-a503-b63fa48a8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FDD8C1D0>]}
[0m02:59:21.998019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06c7c745-d36b-4f24-a503-b63fa48a8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FD7ABBC0>]}
[0m02:59:21.998019 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:59:22.015774 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:59:22.290315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:59:22.291909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:59:22.354467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06c7c745-d36b-4f24-a503-b63fa48a8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FDDC9490>]}
[0m02:59:22.587297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06c7c745-d36b-4f24-a503-b63fa48a8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FDE16C30>]}
[0m02:59:22.588309 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m02:59:22.590310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c7c745-d36b-4f24-a503-b63fa48a8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FEFA6480>]}
[0m02:59:22.595147 [info ] [MainThread]: 
[0m02:59:22.597671 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:59:22.600368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m02:59:22.927100 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m02:59:22.928119 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m02:59:22.932105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:59:23.055822 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.124 seconds
[0m02:59:23.060296 [debug] [ThreadPool]: On list_res: Close
[0m02:59:23.063398 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m02:59:23.079396 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:59:23.080396 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m02:59:23.081538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:59:23.191201 [debug] [ThreadPool]: SQL status: BEGIN in 0.109 seconds
[0m02:59:23.192287 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m02:59:23.193930 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:59:23.201882 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m02:59:23.204033 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m02:59:23.205138 [debug] [ThreadPool]: On list_res_public: Close
[0m02:59:23.214178 [debug] [MainThread]: Using postgres connection "master"
[0m02:59:23.214178 [debug] [MainThread]: On master: BEGIN
[0m02:59:23.215607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:59:23.295433 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m02:59:23.295433 [debug] [MainThread]: Using postgres connection "master"
[0m02:59:23.295433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:59:23.323187 [debug] [MainThread]: SQL status: SELECT 0 in 0.024 seconds
[0m02:59:23.326081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c7c745-d36b-4f24-a503-b63fa48a8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FF50C200>]}
[0m02:59:23.327335 [debug] [MainThread]: On master: ROLLBACK
[0m02:59:23.328847 [debug] [MainThread]: Using postgres connection "master"
[0m02:59:23.328847 [debug] [MainThread]: On master: BEGIN
[0m02:59:23.332443 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:59:23.333490 [debug] [MainThread]: On master: COMMIT
[0m02:59:23.333490 [debug] [MainThread]: Using postgres connection "master"
[0m02:59:23.333490 [debug] [MainThread]: On master: COMMIT
[0m02:59:23.337499 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:59:23.337499 [debug] [MainThread]: On master: Close
[0m02:59:23.337499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:59:23.337499 [info ] [MainThread]: 
[0m02:59:23.349566 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m02:59:23.350807 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m02:59:23.353600 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m02:59:23.354691 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m02:59:23.379996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m02:59:23.382555 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m02:59:23.485156 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m02:59:23.487150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:59:23.488153 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m02:59:23.489155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:59:23.565432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m02:59:23.566431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m02:59:23.568431 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film.sql

-- This model calculates film-related statistics including actor count, release date, genre name,
-- and average rating from different schemas.

WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, gr.name, f.release_date, cf.id
)

SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    ar.avg_rating
FROM film_data fd
LEFT JOIN (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    GROUP BY r.film_id
) ar ON ar.film_id = fd.film_id;
  );
  
[0m02:59:23.570432 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 45: ) ar ON ar.film_id = fd.film_id;
                                        ^

[0m02:59:23.571433 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m02:59:23.572939 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m02:59:23.585232 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 45: ) ar ON ar.film_id = fd.film_id;
                                          ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:59:23.589448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c7c745-d36b-4f24-a503-b63fa48a8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FCEE8C50>]}
[0m02:59:23.591449 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.23s]
[0m02:59:23.593967 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m02:59:23.597994 [debug] [MainThread]: Using postgres connection "master"
[0m02:59:23.598994 [debug] [MainThread]: On master: BEGIN
[0m02:59:23.599994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:59:23.703651 [debug] [MainThread]: SQL status: BEGIN in 0.104 seconds
[0m02:59:23.705677 [debug] [MainThread]: On master: COMMIT
[0m02:59:23.707961 [debug] [MainThread]: Using postgres connection "master"
[0m02:59:23.710107 [debug] [MainThread]: On master: COMMIT
[0m02:59:23.712280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:59:23.713926 [debug] [MainThread]: On master: Close
[0m02:59:23.715130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:59:23.716201 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m02:59:23.717285 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m02:59:23.718357 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m02:59:23.719443 [info ] [MainThread]: 
[0m02:59:23.722934 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m02:59:23.726216 [debug] [MainThread]: Command end result
[0m02:59:23.807850 [info ] [MainThread]: 
[0m02:59:23.810413 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:59:23.811496 [info ] [MainThread]: 
[0m02:59:23.812511 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 45: ) ar ON ar.film_id = fd.film_id;
                                          ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m02:59:23.815849 [info ] [MainThread]: 
[0m02:59:23.816849 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:59:23.819847 [debug] [MainThread]: Command `dbt run` failed at 02:59:23.819847 after 2.71 seconds
[0m02:59:23.820851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FD2D2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FD6264B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8FD626390>]}
[0m02:59:23.821849 [debug] [MainThread]: Flushing usage events
[0m03:00:50.841815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DC7692B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DC71C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DC71DD60>]}


============================== 03:00:50.847270 | 699c860e-ddb6-4ea6-bf55-b85734c73f4a ==============================
[0m03:00:50.847270 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:00:50.847270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:00:51.374830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '699c860e-ddb6-4ea6-bf55-b85734c73f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DCD7C500>]}
[0m03:00:51.586763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '699c860e-ddb6-4ea6-bf55-b85734c73f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DCBF5550>]}
[0m03:00:51.589564 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:00:51.608521 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:00:51.977747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:00:51.979170 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\film.sql
[0m03:00:52.588229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '699c860e-ddb6-4ea6-bf55-b85734c73f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DD637500>]}
[0m03:00:52.830958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '699c860e-ddb6-4ea6-bf55-b85734c73f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DE912780>]}
[0m03:00:52.831965 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m03:00:52.834052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '699c860e-ddb6-4ea6-bf55-b85734c73f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DD0B0320>]}
[0m03:00:52.837322 [info ] [MainThread]: 
[0m03:00:52.839686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:00:52.840694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m03:00:53.133966 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m03:00:53.135045 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m03:00:53.136683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:53.243543 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.106 seconds
[0m03:00:53.249075 [debug] [ThreadPool]: On list_res: Close
[0m03:00:53.255520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m03:00:53.279003 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:00:53.280016 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m03:00:53.282043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:53.382167 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m03:00:53.386272 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:00:53.386272 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:00:53.397023 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m03:00:53.400547 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m03:00:53.403083 [debug] [ThreadPool]: On list_res_public: Close
[0m03:00:53.419057 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:53.420611 [debug] [MainThread]: On master: BEGIN
[0m03:00:53.421133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:53.530238 [debug] [MainThread]: SQL status: BEGIN in 0.109 seconds
[0m03:00:53.531814 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:53.533607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:00:53.567885 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m03:00:53.570864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '699c860e-ddb6-4ea6-bf55-b85734c73f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DEE88320>]}
[0m03:00:53.572386 [debug] [MainThread]: On master: ROLLBACK
[0m03:00:53.574404 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:53.575417 [debug] [MainThread]: On master: BEGIN
[0m03:00:53.577414 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:00:53.578924 [debug] [MainThread]: On master: COMMIT
[0m03:00:53.579954 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:53.580969 [debug] [MainThread]: On master: COMMIT
[0m03:00:53.582480 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:00:53.584492 [debug] [MainThread]: On master: Close
[0m03:00:53.585503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:00:53.587507 [info ] [MainThread]: 
[0m03:00:53.593021 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m03:00:53.595537 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m03:00:53.597574 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m03:00:53.598674 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m03:00:53.625653 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m03:00:53.632821 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m03:00:53.839652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m03:00:53.840652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:00:53.842160 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m03:00:53.843806 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:00:53.912154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m03:00:53.913835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:00:53.915068 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film.sql

-- This model calculates film-related statistics including actor count, release date, genre name,
-- and average rating from different schemas.

SELECT 
    fa.name AS film_name, 
    COUNT(DISTINCT a.*) AS actor_count, 
    f.release_date, 
    gr.name AS genre_name,
    COALESCE(avg_ratings.avg_rating, 0) AS avg_rating
FROM "res"."SC2"."m_film_actor" a
INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
LEFT JOIN (
    SELECT 
        cf.id AS film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    INNER JOIN "res"."SC3"."c_films" cf ON r.film_id = cf.id
    GROUP BY cf.id
) avg_ratings ON avg_ratings.film_id = fa.id
GROUP BY fa.name, f.release_date, gr.name, avg_ratings.avg_rating;
  );
  
[0m03:00:53.917082 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 35: ...BY fa.name, f.release_date, gr.name, avg_ratings.avg_rating;
                                                                       ^

[0m03:00:53.919101 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m03:00:53.920786 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m03:00:53.934907 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 35: ...BY fa.name, f.release_date, gr.name, avg_ratings.avg_rating;
                                                                         ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m03:00:53.937150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699c860e-ddb6-4ea6-bf55-b85734c73f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DEF160F0>]}
[0m03:00:53.939511 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.34s]
[0m03:00:53.942899 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m03:00:53.946272 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:53.948850 [debug] [MainThread]: On master: BEGIN
[0m03:00:53.950034 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:00:54.051893 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m03:00:54.053427 [debug] [MainThread]: On master: COMMIT
[0m03:00:54.054757 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:54.055802 [debug] [MainThread]: On master: COMMIT
[0m03:00:54.058539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:00:54.063374 [debug] [MainThread]: On master: Close
[0m03:00:54.064999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:54.066644 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m03:00:54.068306 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m03:00:54.069534 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m03:00:54.070410 [info ] [MainThread]: 
[0m03:00:54.072596 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m03:00:54.075315 [debug] [MainThread]: Command end result
[0m03:00:54.167089 [info ] [MainThread]: 
[0m03:00:54.168730 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:00:54.169826 [info ] [MainThread]: 
[0m03:00:54.172099 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 35: ...BY fa.name, f.release_date, gr.name, avg_ratings.avg_rating;
                                                                         ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m03:00:54.174966 [info ] [MainThread]: 
[0m03:00:54.181107 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:00:54.188169 [debug] [MainThread]: Command `dbt run` failed at 03:00:54.187625 after 3.72 seconds
[0m03:00:54.190897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DC28B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DC52BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7DD582B40>]}
[0m03:00:54.192454 [debug] [MainThread]: Flushing usage events
[0m03:02:33.829435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6FBC0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6DD52A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E700E8F50>]}


============================== 03:02:33.839197 | b6580133-22ec-4005-a383-a220f6600393 ==============================
[0m03:02:33.839197 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:02:33.839923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:02:34.299368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6580133-22ec-4005-a383-a220f6600393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E70CC0110>]}
[0m03:02:34.464394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6580133-22ec-4005-a383-a220f6600393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E70754230>]}
[0m03:02:34.466111 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:02:34.491699 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:02:34.833052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:02:34.835176 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\film.sql
[0m03:02:35.423671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6580133-22ec-4005-a383-a220f6600393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7237C0B0>]}
[0m03:02:35.658999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6580133-22ec-4005-a383-a220f6600393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E724A9460>]}
[0m03:02:35.660003 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m03:02:35.660003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6580133-22ec-4005-a383-a220f6600393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7245F200>]}
[0m03:02:35.663760 [info ] [MainThread]: 
[0m03:02:35.665203 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:02:35.667217 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m03:02:35.935899 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m03:02:35.937572 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m03:02:35.939818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:02:36.038871 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.099 seconds
[0m03:02:36.043039 [debug] [ThreadPool]: On list_res: Close
[0m03:02:36.045885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m03:02:36.060950 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:02:36.062755 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m03:02:36.063303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:02:36.162505 [debug] [ThreadPool]: SQL status: BEGIN in 0.098 seconds
[0m03:02:36.163573 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:02:36.164649 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:02:36.175341 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m03:02:36.179695 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m03:02:36.181354 [debug] [ThreadPool]: On list_res_public: Close
[0m03:02:36.192870 [debug] [MainThread]: Using postgres connection "master"
[0m03:02:36.192870 [debug] [MainThread]: On master: BEGIN
[0m03:02:36.195798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:02:36.392865 [debug] [MainThread]: SQL status: BEGIN in 0.197 seconds
[0m03:02:36.395208 [debug] [MainThread]: Using postgres connection "master"
[0m03:02:36.396305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:02:36.416907 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m03:02:36.419466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6580133-22ec-4005-a383-a220f6600393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E71165100>]}
[0m03:02:36.420464 [debug] [MainThread]: On master: ROLLBACK
[0m03:02:36.421461 [debug] [MainThread]: Using postgres connection "master"
[0m03:02:36.422699 [debug] [MainThread]: On master: BEGIN
[0m03:02:36.424020 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:02:36.425206 [debug] [MainThread]: On master: COMMIT
[0m03:02:36.426217 [debug] [MainThread]: Using postgres connection "master"
[0m03:02:36.428220 [debug] [MainThread]: On master: COMMIT
[0m03:02:36.429575 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:02:36.430590 [debug] [MainThread]: On master: Close
[0m03:02:36.431669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:02:36.434747 [info ] [MainThread]: 
[0m03:02:36.440825 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m03:02:36.441827 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m03:02:36.444118 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m03:02:36.445134 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m03:02:36.474583 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m03:02:36.480617 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m03:02:36.607029 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m03:02:36.610042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:02:36.611553 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m03:02:36.612567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:02:36.706960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m03:02:36.708343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:02:36.710361 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film.sql

-- This model calculates film-related statistics including actor count, release date, genre name,
-- and average rating from different schemas.

WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, f.release_date, gr.name, cf.id
)

SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    COALESCE(avg_ratings.avg_rating, 0) AS avg_rating
FROM film_data fd
LEFT JOIN (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    GROUP BY r.film_id
) avg_ratings ON avg_ratings.film_id = fd.film_id;
  );
  
[0m03:02:36.711872 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 45: ) avg_ratings ON avg_ratings.film_id = fd.film_id;
                                                          ^

[0m03:02:36.713458 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m03:02:36.715493 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m03:02:36.724538 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 45: ) avg_ratings ON avg_ratings.film_id = fd.film_id;
                                                            ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m03:02:36.726241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6580133-22ec-4005-a383-a220f6600393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E71120BC0>]}
[0m03:02:36.728222 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.28s]
[0m03:02:36.728222 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m03:02:36.731732 [debug] [MainThread]: Using postgres connection "master"
[0m03:02:36.735192 [debug] [MainThread]: On master: BEGIN
[0m03:02:36.737333 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:02:36.826751 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m03:02:36.828059 [debug] [MainThread]: On master: COMMIT
[0m03:02:36.829073 [debug] [MainThread]: Using postgres connection "master"
[0m03:02:36.830073 [debug] [MainThread]: On master: COMMIT
[0m03:02:36.831647 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:02:36.832601 [debug] [MainThread]: On master: Close
[0m03:02:36.834115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:02:36.835129 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m03:02:36.836510 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m03:02:36.837678 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m03:02:36.838987 [info ] [MainThread]: 
[0m03:02:36.840569 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m03:02:36.842184 [debug] [MainThread]: Command end result
[0m03:02:36.909429 [info ] [MainThread]: 
[0m03:02:36.910443 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:02:36.912967 [info ] [MainThread]: 
[0m03:02:36.913966 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 45: ) avg_ratings ON avg_ratings.film_id = fd.film_id;
                                                            ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m03:02:36.917206 [info ] [MainThread]: 
[0m03:02:36.918264 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:02:36.925013 [debug] [MainThread]: Command `dbt run` failed at 03:02:36.924317 after 3.50 seconds
[0m03:02:36.926772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E710F1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E728D1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7033EDE0>]}
[0m03:02:36.928405 [debug] [MainThread]: Flushing usage events
[0m03:04:33.961601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA167FB860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA18E58170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA18013FE0>]}


============================== 03:04:33.971311 | 18be834d-8431-4b0c-a562-9f657106706d ==============================
[0m03:04:33.971311 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:04:33.973144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:04:34.419616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18be834d-8431-4b0c-a562-9f657106706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA192AB260>]}
[0m03:04:34.575484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18be834d-8431-4b0c-a562-9f657106706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA189E0A40>]}
[0m03:04:34.577596 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:04:34.598744 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:04:35.009536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:04:35.011180 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\film.sql
[0m03:04:35.689043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18be834d-8431-4b0c-a562-9f657106706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1AA18A70>]}
[0m03:04:35.900494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18be834d-8431-4b0c-a562-9f657106706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1AAEAED0>]}
[0m03:04:35.901643 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m03:04:35.903830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18be834d-8431-4b0c-a562-9f657106706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA194D73B0>]}
[0m03:04:35.911403 [info ] [MainThread]: 
[0m03:04:35.914358 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:04:35.916877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m03:04:36.225929 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m03:04:36.227519 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m03:04:36.228716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:36.326840 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.098 seconds
[0m03:04:36.330642 [debug] [ThreadPool]: On list_res: Close
[0m03:04:36.334451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m03:04:36.352169 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:04:36.353368 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m03:04:36.354409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:36.601795 [debug] [ThreadPool]: SQL status: BEGIN in 0.248 seconds
[0m03:04:36.603201 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:04:36.604216 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:04:36.613815 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m03:04:36.617638 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m03:04:36.619256 [debug] [ThreadPool]: On list_res_public: Close
[0m03:04:36.633492 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:36.634607 [debug] [MainThread]: On master: BEGIN
[0m03:04:36.636848 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:04:36.754758 [debug] [MainThread]: SQL status: BEGIN in 0.119 seconds
[0m03:04:36.756987 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:36.758496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:04:36.779890 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m03:04:36.783417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18be834d-8431-4b0c-a562-9f657106706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1A875070>]}
[0m03:04:36.785416 [debug] [MainThread]: On master: ROLLBACK
[0m03:04:36.786417 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:36.787413 [debug] [MainThread]: On master: BEGIN
[0m03:04:36.788909 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:04:36.790548 [debug] [MainThread]: On master: COMMIT
[0m03:04:36.791557 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:36.792884 [debug] [MainThread]: On master: COMMIT
[0m03:04:36.794919 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:04:36.795923 [debug] [MainThread]: On master: Close
[0m03:04:36.797244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:04:36.800256 [info ] [MainThread]: 
[0m03:04:36.806992 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m03:04:36.808455 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m03:04:36.812451 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m03:04:36.813454 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m03:04:36.838950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m03:04:36.843313 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m03:04:36.984547 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m03:04:36.990437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:04:36.992719 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m03:04:36.994504 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:04:37.144076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m03:04:37.145739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:04:37.147010 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film.sql

-- This model calculates film-related statistics including actor count, release date, genre name,
-- and average rating from different schemas.

-- Part 1: Define film_data CTE
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, f.release_date, gr.name, cf.id
)

-- Part 2: Select film statistics from film_data
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    ar.avg_rating
FROM film_data fd

-- Part 3: Calculate average rating with subquery
LEFT JOIN (
    SELECT 
        r.film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    GROUP BY r.film_id
) ar ON ar.film_id = fd.film_id;
  );
  
[0m03:04:37.149858 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 49: ) ar ON ar.film_id = fd.film_id;
                                        ^

[0m03:04:37.151355 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m03:04:37.153687 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m03:04:37.168598 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 49: ) ar ON ar.film_id = fd.film_id;
                                          ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m03:04:37.173467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18be834d-8431-4b0c-a562-9f657106706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA194D6B40>]}
[0m03:04:37.176009 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.36s]
[0m03:04:37.179044 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m03:04:37.183791 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:37.186484 [debug] [MainThread]: On master: BEGIN
[0m03:04:37.188285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:04:37.322180 [debug] [MainThread]: SQL status: BEGIN in 0.134 seconds
[0m03:04:37.323807 [debug] [MainThread]: On master: COMMIT
[0m03:04:37.324889 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:37.326013 [debug] [MainThread]: On master: COMMIT
[0m03:04:37.327625 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:04:37.328350 [debug] [MainThread]: On master: Close
[0m03:04:37.329375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:04:37.330960 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m03:04:37.331955 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m03:04:37.333027 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m03:04:37.333546 [info ] [MainThread]: 
[0m03:04:37.335730 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m03:04:37.339131 [debug] [MainThread]: Command end result
[0m03:04:37.463245 [info ] [MainThread]: 
[0m03:04:37.465470 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:04:37.466515 [info ] [MainThread]: 
[0m03:04:37.468399 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 49: ) ar ON ar.film_id = fd.film_id;
                                          ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m03:04:37.470409 [info ] [MainThread]: 
[0m03:04:37.471410 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:04:37.479714 [debug] [MainThread]: Command `dbt run` failed at 03:04:37.479203 after 3.95 seconds
[0m03:04:37.480726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA1A8F2540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA18FD9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA18D63B00>]}
[0m03:04:37.481728 [debug] [MainThread]: Flushing usage events
[0m03:05:28.039446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3307165A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D330A4D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32FD6AFC0>]}


============================== 03:05:28.050693 | b29b0f99-0d0a-4b48-a505-5dc750790339 ==============================
[0m03:05:28.050693 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:05:28.050693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:05:28.490332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b29b0f99-0d0a-4b48-a505-5dc750790339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32A8FA060>]}
[0m03:05:28.639259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b29b0f99-0d0a-4b48-a505-5dc750790339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D330B3E540>]}
[0m03:05:28.639259 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:05:28.664637 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:05:29.020038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:05:29.021995 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\film.sql
[0m03:05:29.669574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b29b0f99-0d0a-4b48-a505-5dc750790339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D331107620>]}
[0m03:05:29.906185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b29b0f99-0d0a-4b48-a505-5dc750790339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3324098B0>]}
[0m03:05:29.908697 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m03:05:29.911031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29b0f99-0d0a-4b48-a505-5dc750790339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3323C35C0>]}
[0m03:05:29.917678 [info ] [MainThread]: 
[0m03:05:29.920469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:05:29.923405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m03:05:30.163103 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m03:05:30.168288 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m03:05:30.168288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:30.239871 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.071 seconds
[0m03:05:30.243381 [debug] [ThreadPool]: On list_res: Close
[0m03:05:30.244422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m03:05:30.254751 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:05:30.257958 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m03:05:30.259275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:30.362987 [debug] [ThreadPool]: SQL status: BEGIN in 0.106 seconds
[0m03:05:30.362987 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:05:30.368024 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:05:30.376129 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m03:05:30.380798 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m03:05:30.380798 [debug] [ThreadPool]: On list_res_public: Close
[0m03:05:30.399011 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:30.400134 [debug] [MainThread]: On master: BEGIN
[0m03:05:30.401230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:05:30.492043 [debug] [MainThread]: SQL status: BEGIN in 0.091 seconds
[0m03:05:30.493110 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:30.494946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:05:30.515679 [debug] [MainThread]: SQL status: SELECT 0 in 0.024 seconds
[0m03:05:30.523201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29b0f99-0d0a-4b48-a505-5dc750790339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D331106E10>]}
[0m03:05:30.523201 [debug] [MainThread]: On master: ROLLBACK
[0m03:05:30.523201 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:30.523201 [debug] [MainThread]: On master: BEGIN
[0m03:05:30.528241 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:05:30.530927 [debug] [MainThread]: On master: COMMIT
[0m03:05:30.531973 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:30.532992 [debug] [MainThread]: On master: COMMIT
[0m03:05:30.534027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:30.535365 [debug] [MainThread]: On master: Close
[0m03:05:30.536454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:30.538103 [info ] [MainThread]: 
[0m03:05:30.544209 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m03:05:30.545958 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m03:05:30.548244 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m03:05:30.549650 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m03:05:30.572050 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m03:05:30.574260 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m03:05:30.705550 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m03:05:30.708501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:05:30.710296 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m03:05:30.711885 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:05:30.819529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.108 seconds
[0m03:05:30.821730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:05:30.824652 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film.sql

-- This model calculates film-related statistics including actor count, release date, genre name,
-- and average rating from different schemas.

-- Part 1: Define film_data CTE
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, f.release_date, gr.name, cf.id
)

-- Part 2: Select film statistics from film_data
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name
FROM film_data fd
  );
  
[0m03:05:30.856437 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.030 seconds
[0m03:05:30.874160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:05:30.875307 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */
alter table "res"."public"."film__dbt_tmp" rename to "film"
[0m03:05:30.878592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:05:30.937726 [debug] [Thread-1 (]: On model.dbt_proj.film: COMMIT
[0m03:05:30.939350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:05:30.941236 [debug] [Thread-1 (]: On model.dbt_proj.film: COMMIT
[0m03:05:30.943913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:05:30.960771 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."film__dbt_backup"
[0m03:05:30.979047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:05:30.980670 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */
drop table if exists "res"."public"."film__dbt_backup" cascade
[0m03:05:30.982856 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m03:05:30.989681 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m03:05:30.993470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29b0f99-0d0a-4b48-a505-5dc750790339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32E5BB8F0>]}
[0m03:05:30.995688 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.film .................................. [[32mSELECT 19[0m in 0.44s]
[0m03:05:30.997838 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m03:05:31.001082 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:31.002152 [debug] [MainThread]: On master: BEGIN
[0m03:05:31.003252 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:05:31.096476 [debug] [MainThread]: SQL status: BEGIN in 0.095 seconds
[0m03:05:31.096476 [debug] [MainThread]: On master: COMMIT
[0m03:05:31.096476 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:31.096476 [debug] [MainThread]: On master: COMMIT
[0m03:05:31.096476 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:31.102988 [debug] [MainThread]: On master: Close
[0m03:05:31.102988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:31.106184 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m03:05:31.106184 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m03:05:31.106184 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m03:05:31.110689 [info ] [MainThread]: 
[0m03:05:31.110689 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m03:05:31.119346 [debug] [MainThread]: Command end result
[0m03:05:31.210981 [info ] [MainThread]: 
[0m03:05:31.212686 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:05:31.213764 [info ] [MainThread]: 
[0m03:05:31.216039 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:05:31.219664 [debug] [MainThread]: Command `dbt run` succeeded at 03:05:31.219013 after 3.43 seconds
[0m03:05:31.221323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D330A4D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3302985C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3322A3A10>]}
[0m03:05:31.222348 [debug] [MainThread]: Flushing usage events
[0m03:07:58.842727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA21B36720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2148D910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA21290740>]}


============================== 03:07:58.847777 | 2edf0799-0d4f-45b7-a086-7bd333eda010 ==============================
[0m03:07:58.847777 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:07:58.852786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:07:59.319128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2edf0799-0d4f-45b7-a086-7bd333eda010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA21DB1550>]}
[0m03:07:59.469572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2edf0799-0d4f-45b7-a086-7bd333eda010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA20CC6960>]}
[0m03:07:59.473660 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:07:59.492605 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:07:59.827649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:07:59.827649 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\film.sql
[0m03:08:00.402741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2edf0799-0d4f-45b7-a086-7bd333eda010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2230F560>]}
[0m03:08:00.642258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2edf0799-0d4f-45b7-a086-7bd333eda010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA23641520>]}
[0m03:08:00.644067 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m03:08:00.645651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2edf0799-0d4f-45b7-a086-7bd333eda010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA23436780>]}
[0m03:08:00.650127 [info ] [MainThread]: 
[0m03:08:00.652519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:08:00.658249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m03:08:00.941745 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m03:08:00.943869 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m03:08:00.944974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:08:01.034820 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.090 seconds
[0m03:08:01.038067 [debug] [ThreadPool]: On list_res: Close
[0m03:08:01.041289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m03:08:01.052844 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:08:01.057383 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m03:08:01.057383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:08:01.138514 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m03:08:01.140539 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:08:01.142191 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:08:01.156750 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m03:08:01.160656 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m03:08:01.162288 [debug] [ThreadPool]: On list_res_public: Close
[0m03:08:01.174329 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:01.175424 [debug] [MainThread]: On master: BEGIN
[0m03:08:01.176499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:08:01.276274 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m03:08:01.277433 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:01.279091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:08:01.309315 [debug] [MainThread]: SQL status: SELECT 0 in 0.029 seconds
[0m03:08:01.313748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2edf0799-0d4f-45b7-a086-7bd333eda010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA234EB2F0>]}
[0m03:08:01.315360 [debug] [MainThread]: On master: ROLLBACK
[0m03:08:01.316448 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:01.317548 [debug] [MainThread]: On master: BEGIN
[0m03:08:01.319719 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:08:01.322534 [debug] [MainThread]: On master: COMMIT
[0m03:08:01.323773 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:01.324836 [debug] [MainThread]: On master: COMMIT
[0m03:08:01.326472 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:08:01.327572 [debug] [MainThread]: On master: Close
[0m03:08:01.328651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:08:01.328651 [info ] [MainThread]: 
[0m03:08:01.337264 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m03:08:01.339106 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m03:08:01.339106 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m03:08:01.342624 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m03:08:01.365222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m03:08:01.367663 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m03:08:01.483868 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m03:08:01.487881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:08:01.487881 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m03:08:01.487881 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:08:01.575849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.085 seconds
[0m03:08:01.577358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:08:01.577358 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film.sql

-- This model calculates film-related statistics including actor count, release date, genre name,
-- and average rating from different schemas.

-- Part 1: Define film_data CTE
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, f.release_date, gr.name, cf.id
)

-- Part 2: Select film statistics from film_data
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    COALESCE(ar.avg_rating, 0) AS avg_rating
FROM film_data fd

-- Part 3: Calculate average rating with subquery
LEFT JOIN (
    SELECT 
        cf.id AS film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    INNER JOIN "res"."SC3"."c_films" cf ON r.film_id = cf.id
    GROUP BY cf.id
) ar ON ar.film_id = fd.film_id;
  );
  
[0m03:08:01.577358 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 50: ) ar ON ar.film_id = fd.film_id;
                                        ^

[0m03:08:01.577358 [debug] [Thread-1 (]: On model.dbt_proj.film: ROLLBACK
[0m03:08:01.582872 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m03:08:01.595357 [debug] [Thread-1 (]: Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 50: ) ar ON ar.film_id = fd.film_id;
                                          ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m03:08:01.595357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2edf0799-0d4f-45b7-a086-7bd333eda010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA213F8C50>]}
[0m03:08:01.595357 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.film .............................. [[31mERROR[0m in 0.26s]
[0m03:08:01.604413 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m03:08:01.608006 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:01.609216 [debug] [MainThread]: On master: BEGIN
[0m03:08:01.609216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:08:01.722619 [debug] [MainThread]: SQL status: BEGIN in 0.111 seconds
[0m03:08:01.724353 [debug] [MainThread]: On master: COMMIT
[0m03:08:01.725480 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:01.726532 [debug] [MainThread]: On master: COMMIT
[0m03:08:01.728201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:08:01.729951 [debug] [MainThread]: On master: Close
[0m03:08:01.731669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:08:01.733531 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m03:08:01.735093 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m03:08:01.736118 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m03:08:01.737722 [info ] [MainThread]: 
[0m03:08:01.738928 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m03:08:01.741631 [debug] [MainThread]: Command end result
[0m03:08:01.826646 [info ] [MainThread]: 
[0m03:08:01.828307 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:08:01.829940 [info ] [MainThread]: 
[0m03:08:01.832866 [error] [MainThread]:   Database Error in model film (models\example\film.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 50: ) ar ON ar.film_id = fd.film_id;
                                          ^
  compiled Code at target\run\dbt_proj\models\example\film.sql
[0m03:08:01.835315 [info ] [MainThread]: 
[0m03:08:01.837339 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:08:01.841050 [debug] [MainThread]: Command `dbt run` failed at 03:08:01.841050 after 3.35 seconds
[0m03:08:01.842560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA21384980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA21DB0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA234E3B00>]}
[0m03:08:01.843582 [debug] [MainThread]: Flushing usage events
[0m03:08:21.345211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F207FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F45B2E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F1FF0980>]}


============================== 03:08:21.357120 | b644a04a-2e80-4fd5-8125-3d4d719559b2 ==============================
[0m03:08:21.357120 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:08:21.359337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m03:08:21.729473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b644a04a-2e80-4fd5-8125-3d4d719559b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F4AAE900>]}
[0m03:08:21.826184 [debug] [MainThread]: Command `dbt clean` succeeded at 03:08:21.823643 after 0.84 seconds
[0m03:08:21.826184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F3D7B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F4B219A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F3B2A600>]}
[0m03:08:21.829723 [debug] [MainThread]: Flushing usage events
[0m03:08:45.349935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE7F34F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEA7632F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEA7612B0>]}


============================== 03:08:45.357495 | 4141c91a-7abc-43db-aad9-7f7c4a741051 ==============================
[0m03:08:45.357495 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:08:45.357495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:08:45.780236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4141c91a-7abc-43db-aad9-7f7c4a741051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEAC68500>]}
[0m03:08:45.907734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4141c91a-7abc-43db-aad9-7f7c4a741051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEACF7FB0>]}
[0m03:08:45.907734 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:08:45.932488 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:08:45.932488 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:08:45.939832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4141c91a-7abc-43db-aad9-7f7c4a741051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEAA3D130>]}
[0m03:08:49.012518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4141c91a-7abc-43db-aad9-7f7c4a741051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEC4F9640>]}
[0m03:08:49.242669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4141c91a-7abc-43db-aad9-7f7c4a741051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEAE795B0>]}
[0m03:08:49.245161 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m03:08:49.246946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4141c91a-7abc-43db-aad9-7f7c4a741051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEC4730B0>]}
[0m03:08:49.251190 [info ] [MainThread]: 
[0m03:08:49.254071 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:08:49.256800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m03:08:49.478002 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m03:08:49.478002 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m03:08:49.478002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:08:49.587662 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.107 seconds
[0m03:08:49.591491 [debug] [ThreadPool]: On list_res: Close
[0m03:08:49.595311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m03:08:49.610928 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:08:49.612437 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m03:08:49.613450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:08:49.697293 [debug] [ThreadPool]: SQL status: BEGIN in 0.085 seconds
[0m03:08:49.697293 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m03:08:49.697293 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:08:49.708484 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m03:08:49.712497 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m03:08:49.714586 [debug] [ThreadPool]: On list_res_public: Close
[0m03:08:49.726609 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:49.726609 [debug] [MainThread]: On master: BEGIN
[0m03:08:49.726609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:08:49.832303 [debug] [MainThread]: SQL status: BEGIN in 0.104 seconds
[0m03:08:49.832303 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:49.834841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:08:49.857707 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m03:08:49.862545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4141c91a-7abc-43db-aad9-7f7c4a741051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE9B5A4E0>]}
[0m03:08:49.862545 [debug] [MainThread]: On master: ROLLBACK
[0m03:08:49.865973 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:49.866482 [debug] [MainThread]: On master: BEGIN
[0m03:08:49.868151 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:08:49.868151 [debug] [MainThread]: On master: COMMIT
[0m03:08:49.868151 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:49.868151 [debug] [MainThread]: On master: COMMIT
[0m03:08:49.871151 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:08:49.872561 [debug] [MainThread]: On master: Close
[0m03:08:49.872561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:08:49.875240 [info ] [MainThread]: 
[0m03:08:49.881955 [debug] [Thread-1 (]: Began running node model.dbt_proj.film
[0m03:08:49.883346 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film ....................................... [RUN]
[0m03:08:49.886672 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film'
[0m03:08:49.887696 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film
[0m03:08:49.912539 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film"
[0m03:08:49.916480 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film
[0m03:08:50.092439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film"
[0m03:08:50.097471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:08:50.097471 [debug] [Thread-1 (]: On model.dbt_proj.film: BEGIN
[0m03:08:50.100481 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:08:50.195525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.094 seconds
[0m03:08:50.197057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:08:50.198639 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */

  
    

  create  table "res"."public"."film__dbt_tmp"
  
  
    as
  
  (
    -- models/film.sql

-- This model calculates film-related statistics including actor count, release date, genre name,
-- and average rating from different schemas.

-- Part 1: Define film_data CTE
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, f.release_date, gr.name, cf.id
)

-- Part 2: Select film statistics from film_data
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    COALESCE(ar.avg_rating, 0) AS avg_rating
FROM film_data fd

-- Part 3: Calculate average rating with subquery
LEFT JOIN (
    SELECT 
        cf.id AS film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    INNER JOIN "res"."SC3"."c_films" cf ON r.film_id = cf.id
    GROUP BY cf.id
) ar ON ar.film_id = fd.film_id
  );
  
[0m03:08:50.222516 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.022 seconds
[0m03:08:50.235458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:08:50.238444 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */
alter table "res"."public"."film__dbt_tmp" rename to "film"
[0m03:08:50.238444 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:08:50.291033 [debug] [Thread-1 (]: On model.dbt_proj.film: COMMIT
[0m03:08:50.292552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:08:50.293809 [debug] [Thread-1 (]: On model.dbt_proj.film: COMMIT
[0m03:08:50.294827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:08:50.312327 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."film__dbt_backup"
[0m03:08:50.336738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film"
[0m03:08:50.337936 [debug] [Thread-1 (]: On model.dbt_proj.film: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film"} */
drop table if exists "res"."public"."film__dbt_backup" cascade
[0m03:08:50.340078 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:08:50.346089 [debug] [Thread-1 (]: On model.dbt_proj.film: Close
[0m03:08:50.349902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4141c91a-7abc-43db-aad9-7f7c4a741051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEA37CB00>]}
[0m03:08:50.352055 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.film .................................. [[32mSELECT 19[0m in 0.46s]
[0m03:08:50.355430 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film
[0m03:08:50.361643 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:50.363704 [debug] [MainThread]: On master: BEGIN
[0m03:08:50.366657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:08:50.498932 [debug] [MainThread]: SQL status: BEGIN in 0.132 seconds
[0m03:08:50.499998 [debug] [MainThread]: On master: COMMIT
[0m03:08:50.501720 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:50.502744 [debug] [MainThread]: On master: COMMIT
[0m03:08:50.502744 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:08:50.502744 [debug] [MainThread]: On master: Close
[0m03:08:50.502744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:08:50.507273 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m03:08:50.507273 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m03:08:50.507273 [debug] [MainThread]: Connection 'model.dbt_proj.film' was properly closed.
[0m03:08:50.510284 [info ] [MainThread]: 
[0m03:08:50.512396 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m03:08:50.513448 [debug] [MainThread]: Command end result
[0m03:08:50.672023 [info ] [MainThread]: 
[0m03:08:50.687142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:08:50.692746 [info ] [MainThread]: 
[0m03:08:50.697753 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:08:50.724711 [debug] [MainThread]: Command `dbt run` succeeded at 03:08:50.724162 after 5.64 seconds
[0m03:08:50.726910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEB4147D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEA818CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEA818DA0>]}
[0m03:08:50.726910 [debug] [MainThread]: Flushing usage events
[0m10:05:39.304345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD450C4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD48078200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD47E4FE60>]}


============================== 10:05:39.308835 | e0a53317-098b-4b76-a791-4b50fa27d3b9 ==============================
[0m10:05:39.308835 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:05:39.308835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:05:39.335612 [info ] [MainThread]: dbt version: 1.8.3
[0m10:05:39.339118 [info ] [MainThread]: python version: 3.12.2
[0m10:05:39.340810 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m10:05:39.341882 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m10:05:39.426744 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m10:05:39.428754 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m10:05:39.429860 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m10:05:39.431963 [info ] [MainThread]: adapter type: postgres
[0m10:05:39.431963 [info ] [MainThread]: adapter version: 1.8.2
[0m10:05:39.527766 [info ] [MainThread]: Configuration:
[0m10:05:39.529271 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:05:39.530008 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:05:39.531017 [info ] [MainThread]: Required dependencies:
[0m10:05:39.531473 [debug] [MainThread]: Executing "git --help"
[0m10:05:39.565940 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:05:39.567916 [debug] [MainThread]: STDERR: "b''"
[0m10:05:39.567916 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:05:39.568937 [info ] [MainThread]: Connection:
[0m10:05:39.568937 [info ] [MainThread]:   host: localhost
[0m10:05:39.570966 [info ] [MainThread]:   port: 5432
[0m10:05:39.570966 [info ] [MainThread]:   user: postgres
[0m10:05:39.572130 [info ] [MainThread]:   database: res
[0m10:05:39.572130 [info ] [MainThread]:   schema: public
[0m10:05:39.573293 [info ] [MainThread]:   connect_timeout: 10
[0m10:05:39.573293 [info ] [MainThread]:   role: None
[0m10:05:39.574685 [info ] [MainThread]:   search_path: None
[0m10:05:39.575774 [info ] [MainThread]:   keepalives_idle: 0
[0m10:05:39.576836 [info ] [MainThread]:   sslmode: None
[0m10:05:39.576836 [info ] [MainThread]:   sslcert: None
[0m10:05:39.578355 [info ] [MainThread]:   sslkey: None
[0m10:05:39.578861 [info ] [MainThread]:   sslrootcert: None
[0m10:05:39.579884 [info ] [MainThread]:   application_name: dbt
[0m10:05:39.579884 [info ] [MainThread]:   retries: 1
[0m10:05:39.582054 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:05:39.583380 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:05:39.718860 [debug] [MainThread]: Using postgres connection "debug"
[0m10:05:39.718860 [debug] [MainThread]: On debug: select 1 as id
[0m10:05:39.718860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:05:39.785851 [debug] [MainThread]: SQL status: SELECT 1 in 0.066 seconds
[0m10:05:39.788860 [debug] [MainThread]: On debug: Close
[0m10:05:39.788860 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:05:39.788860 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:05:39.788860 [debug] [MainThread]: Command `dbt debug` succeeded at 10:05:39.788860 after 0.66 seconds
[0m10:05:39.788860 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:05:39.788860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD450C4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4896DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD48B1CCB0>]}
[0m10:05:39.794175 [debug] [MainThread]: Flushing usage events
[0m13:29:03.046687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A18424F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1AC31AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1A5CC5F0>]}


============================== 13:29:03.052022 | 66a1fd72-4c2f-47cf-93ca-178e8965bc4b ==============================
[0m13:29:03.052022 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:29:03.052022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m13:29:03.387682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66a1fd72-4c2f-47cf-93ca-178e8965bc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1AFA8F80>]}
[0m13:29:03.460196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66a1fd72-4c2f-47cf-93ca-178e8965bc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1ACB0B30>]}
[0m13:29:03.460196 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:29:03.472522 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:29:03.714000 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:29:03.714550 [debug] [MainThread]: Partial parsing: added file: dbt_proj://models\example\film_2.sql
[0m13:29:03.714550 [debug] [MainThread]: Partial parsing: deleted file: dbt_proj://models\example\film.sql
[0m13:29:04.025712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66a1fd72-4c2f-47cf-93ca-178e8965bc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1C8F9850>]}
[0m13:29:04.147758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66a1fd72-4c2f-47cf-93ca-178e8965bc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1C61EFC0>]}
[0m13:29:04.147758 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m13:29:04.149479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66a1fd72-4c2f-47cf-93ca-178e8965bc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1C7B1EB0>]}
[0m13:29:04.151308 [info ] [MainThread]: 
[0m13:29:04.151308 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:29:04.154181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m13:29:04.295300 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m13:29:04.295300 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m13:29:04.295300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:04.359724 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.061 seconds
[0m13:29:04.361943 [debug] [ThreadPool]: On list_res: Close
[0m13:29:04.361943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m13:29:04.373584 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m13:29:04.373584 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m13:29:04.373584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:04.424668 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m13:29:04.424668 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m13:29:04.424668 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:29:04.429232 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m13:29:04.429232 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m13:29:04.429232 [debug] [ThreadPool]: On list_res_public: Close
[0m13:29:04.440402 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:04.440402 [debug] [MainThread]: On master: BEGIN
[0m13:29:04.442621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:04.484256 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m13:29:04.484256 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:04.484256 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:29:04.502265 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m13:29:04.502265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66a1fd72-4c2f-47cf-93ca-178e8965bc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1C8D45C0>]}
[0m13:29:04.502265 [debug] [MainThread]: On master: ROLLBACK
[0m13:29:04.507889 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:04.508394 [debug] [MainThread]: On master: BEGIN
[0m13:29:04.508394 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:29:04.508394 [debug] [MainThread]: On master: COMMIT
[0m13:29:04.510709 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:04.511216 [debug] [MainThread]: On master: COMMIT
[0m13:29:04.511216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:29:04.511216 [debug] [MainThread]: On master: Close
[0m13:29:04.511216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:04.514337 [info ] [MainThread]: 
[0m13:29:04.520729 [debug] [Thread-1 (]: Began running node model.dbt_proj.film_2
[0m13:29:04.521792 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film_2 ..................................... [RUN]
[0m13:29:04.523665 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film_2'
[0m13:29:04.526053 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film_2
[0m13:29:04.540347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film_2"
[0m13:29:04.543300 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film_2
[0m13:29:04.598987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film_2"
[0m13:29:04.601730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film_2"
[0m13:29:04.601730 [debug] [Thread-1 (]: On model.dbt_proj.film_2: BEGIN
[0m13:29:04.601730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:29:04.657789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m13:29:04.659340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film_2"
[0m13:29:04.660390 [debug] [Thread-1 (]: On model.dbt_proj.film_2: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film_2"} */

  
    

  create  table "res"."public"."film_2__dbt_tmp"
  
  
    as
  
  (
    -- models/film.sql

-- This model calculates film-related statistics including actor count, release date, genre name,
-- and average rating from different schemas.

-- Part 1: Define film_data CTE
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, f.release_date, gr.name, cf.id
)

-- Part 2: Select film statistics from film_data
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    COALESCE(ar.avg_rating, 0) AS avg_rating
FROM film_data fd

-- Part 3: Calculate average rating with subquery
LEFT JOIN (
    SELECT 
        cf.id AS film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    INNER JOIN "res"."SC3"."c_films" cf ON r.film_id = cf.id
    GROUP BY cf.id
) ar ON ar.film_id = fd.film_id
  );
  
[0m13:29:04.685394 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.028 seconds
[0m13:29:04.690906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film_2"
[0m13:29:04.690906 [debug] [Thread-1 (]: On model.dbt_proj.film_2: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film_2"} */
alter table "res"."public"."film_2__dbt_tmp" rename to "film_2"
[0m13:29:04.690906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:29:04.733499 [debug] [Thread-1 (]: On model.dbt_proj.film_2: COMMIT
[0m13:29:04.733499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film_2"
[0m13:29:04.733499 [debug] [Thread-1 (]: On model.dbt_proj.film_2: COMMIT
[0m13:29:04.733499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:29:04.743666 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."film_2__dbt_backup"
[0m13:29:04.743666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film_2"
[0m13:29:04.743666 [debug] [Thread-1 (]: On model.dbt_proj.film_2: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film_2"} */
drop table if exists "res"."public"."film_2__dbt_backup" cascade
[0m13:29:04.753675 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:29:04.755984 [debug] [Thread-1 (]: On model.dbt_proj.film_2: Close
[0m13:29:04.755984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66a1fd72-4c2f-47cf-93ca-178e8965bc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A18A075C0>]}
[0m13:29:04.760640 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.film_2 ................................ [[32mSELECT 19[0m in 0.23s]
[0m13:29:04.761878 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film_2
[0m13:29:04.761878 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:04.761878 [debug] [MainThread]: On master: BEGIN
[0m13:29:04.761878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:04.816555 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m13:29:04.816555 [debug] [MainThread]: On master: COMMIT
[0m13:29:04.822469 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:04.823010 [debug] [MainThread]: On master: COMMIT
[0m13:29:04.824244 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:29:04.824753 [debug] [MainThread]: On master: Close
[0m13:29:04.824753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:04.825711 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m13:29:04.826611 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m13:29:04.828195 [debug] [MainThread]: Connection 'model.dbt_proj.film_2' was properly closed.
[0m13:29:04.829509 [info ] [MainThread]: 
[0m13:29:04.830014 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m13:29:04.831569 [debug] [MainThread]: Command end result
[0m13:29:04.867838 [info ] [MainThread]: 
[0m13:29:04.869060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:04.870071 [info ] [MainThread]: 
[0m13:29:04.871244 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:29:04.872998 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:04.872998 after 2.08 seconds
[0m13:29:04.872998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A18424F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1A46C740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1B562D80>]}
[0m13:29:04.872998 [debug] [MainThread]: Flushing usage events
[0m14:03:22.974380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F974B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FBF42900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FBF43C80>]}


============================== 14:03:22.974380 | ddf51bf6-9f36-43f9-b09e-4e4b8cdfc2cf ==============================
[0m14:03:22.974380 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:03:22.974380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m14:03:23.269943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddf51bf6-9f36-43f9-b09e-4e4b8cdfc2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FC77E3F0>]}
[0m14:03:23.367369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddf51bf6-9f36-43f9-b09e-4e4b8cdfc2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FC3B58B0>]}
[0m14:03:23.367369 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:03:23.372092 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:03:23.594572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:23.595573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:23.632703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddf51bf6-9f36-43f9-b09e-4e4b8cdfc2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FC96F410>]}
[0m14:03:23.767965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddf51bf6-9f36-43f9-b09e-4e4b8cdfc2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FDF3CE60>]}
[0m14:03:23.772471 [info ] [MainThread]: Found 1 model, 7 sources, 415 macros
[0m14:03:23.772471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf51bf6-9f36-43f9-b09e-4e4b8cdfc2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FC9BD100>]}
[0m14:03:23.772471 [info ] [MainThread]: 
[0m14:03:23.772471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:03:23.772471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m14:03:23.892593 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m14:03:23.892593 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m14:03:23.894765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:23.960095 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.065 seconds
[0m14:03:23.961404 [debug] [ThreadPool]: On list_res: Close
[0m14:03:23.963699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m14:03:23.965624 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:03:23.965624 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m14:03:23.965624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:24.029323 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m14:03:24.029817 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m14:03:24.029817 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:03:24.035603 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m14:03:24.037572 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m14:03:24.037572 [debug] [ThreadPool]: On list_res_public: Close
[0m14:03:24.044451 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:24.044451 [debug] [MainThread]: On master: BEGIN
[0m14:03:24.044451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:24.100915 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m14:03:24.100915 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:24.100915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:03:24.116057 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m14:03:24.117657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf51bf6-9f36-43f9-b09e-4e4b8cdfc2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FDF3C140>]}
[0m14:03:24.117657 [debug] [MainThread]: On master: ROLLBACK
[0m14:03:24.117657 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:24.117657 [debug] [MainThread]: On master: BEGIN
[0m14:03:24.121845 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:03:24.121845 [debug] [MainThread]: On master: COMMIT
[0m14:03:24.121845 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:24.121845 [debug] [MainThread]: On master: COMMIT
[0m14:03:24.124335 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:24.124880 [debug] [MainThread]: On master: Close
[0m14:03:24.124880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:24.126493 [info ] [MainThread]: 
[0m14:03:24.132227 [debug] [Thread-1 (]: Began running node model.dbt_proj.film_2
[0m14:03:24.133286 [info ] [Thread-1 (]: 1 of 1 START sql table model public.film_2 ..................................... [RUN]
[0m14:03:24.134305 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.film_2'
[0m14:03:24.135661 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.film_2
[0m14:03:24.145162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.film_2"
[0m14:03:24.148380 [debug] [Thread-1 (]: Began executing node model.dbt_proj.film_2
[0m14:03:24.216274 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.film_2"
[0m14:03:24.218151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film_2"
[0m14:03:24.219165 [debug] [Thread-1 (]: On model.dbt_proj.film_2: BEGIN
[0m14:03:24.220170 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:03:24.279359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m14:03:24.280369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film_2"
[0m14:03:24.281547 [debug] [Thread-1 (]: On model.dbt_proj.film_2: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film_2"} */

  
    

  create  table "res"."public"."film_2__dbt_tmp"
  
  
    as
  
  (
    -- models/film.sql

-- This model calculates film-related statistics including actor count, release date, genre name,
-- and average rating from different schemas.

-- Part 1: Define film_data CTE
WITH film_data AS (
    SELECT 
        fa.name AS film_name, 
        COUNT(DISTINCT a.*) AS actor_count, 
        f.release_date, 
        gr.name AS genre_name,
        cf.id AS film_id
    FROM "res"."SC2"."m_film_actor" a
    INNER JOIN "res"."SC2"."m_film" fa ON a.film_id = fa.id 
    INNER JOIN "res"."SC1"."p_film" f ON f.name = fa.name 
    INNER JOIN "res"."SC1"."p_genre" gr ON f.genre_id = gr.id 
    INNER JOIN "res"."SC3"."c_films" cf ON cf.name = fa.name
    GROUP BY fa.name, f.release_date, gr.name, cf.id
)

-- Part 2: Select film statistics from film_data
SELECT 
    fd.film_name,
    fd.actor_count,
    fd.release_date,
    fd.genre_name,
    COALESCE(ar.avg_rating, 0) AS avg_rating
FROM film_data fd

-- Part 3: Calculate average rating with subquery
LEFT JOIN (
    SELECT 
        cf.id AS film_id, 
        AVG(r.rating) AS avg_rating
    FROM "res"."SC3"."c_ratings" r
    INNER JOIN "res"."SC3"."c_films" cf ON r.film_id = cf.id
    GROUP BY cf.id
) ar ON ar.film_id = fd.film_id
  );
  
[0m14:03:24.296707 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.014 seconds
[0m14:03:24.310963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film_2"
[0m14:03:24.311979 [debug] [Thread-1 (]: On model.dbt_proj.film_2: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film_2"} */
alter table "res"."public"."film_2__dbt_tmp" rename to "film_2"
[0m14:03:24.313251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:24.343992 [debug] [Thread-1 (]: On model.dbt_proj.film_2: COMMIT
[0m14:03:24.343992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film_2"
[0m14:03:24.343992 [debug] [Thread-1 (]: On model.dbt_proj.film_2: COMMIT
[0m14:03:24.343992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:24.359888 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."film_2__dbt_backup"
[0m14:03:24.359888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.film_2"
[0m14:03:24.359888 [debug] [Thread-1 (]: On model.dbt_proj.film_2: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.film_2"} */
drop table if exists "res"."public"."film_2__dbt_backup" cascade
[0m14:03:24.359888 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:03:24.375399 [debug] [Thread-1 (]: On model.dbt_proj.film_2: Close
[0m14:03:24.375399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf51bf6-9f36-43f9-b09e-4e4b8cdfc2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FA1FB890>]}
[0m14:03:24.379094 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.film_2 ................................ [[32mSELECT 19[0m in 0.24s]
[0m14:03:24.380269 [debug] [Thread-1 (]: Finished running node model.dbt_proj.film_2
[0m14:03:24.380269 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:24.380269 [debug] [MainThread]: On master: BEGIN
[0m14:03:24.380269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:24.448938 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m14:03:24.450199 [debug] [MainThread]: On master: COMMIT
[0m14:03:24.450199 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:24.450199 [debug] [MainThread]: On master: COMMIT
[0m14:03:24.450199 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:24.450199 [debug] [MainThread]: On master: Close
[0m14:03:24.450199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:24.450199 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m14:03:24.450199 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m14:03:24.450199 [debug] [MainThread]: Connection 'model.dbt_proj.film_2' was properly closed.
[0m14:03:24.450199 [info ] [MainThread]: 
[0m14:03:24.459198 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m14:03:24.459198 [debug] [MainThread]: Command end result
[0m14:03:24.496524 [info ] [MainThread]: 
[0m14:03:24.498012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:24.499067 [info ] [MainThread]: 
[0m14:03:24.500074 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:03:24.503081 [debug] [MainThread]: Command `dbt run` succeeded at 14:03:24.503081 after 1.80 seconds
[0m14:03:24.504629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FC59DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FE530230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FC472930>]}
[0m14:03:24.505175 [debug] [MainThread]: Flushing usage events
[0m10:30:58.536053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001325A1B7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001325875FA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001325AF48800>]}


============================== 10:30:58.544843 | 3573ac2d-9193-4bc9-a6ab-b4d1262b8413 ==============================
[0m10:30:58.544843 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:30:58.547879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:30:58.599675 [info ] [MainThread]: dbt version: 1.8.3
[0m10:30:58.604771 [info ] [MainThread]: python version: 3.12.2
[0m10:30:58.604771 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m10:30:58.607648 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m10:30:58.769762 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m10:30:58.769762 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m10:30:58.773877 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m10:30:58.776858 [info ] [MainThread]: adapter type: postgres
[0m10:30:58.776858 [info ] [MainThread]: adapter version: 1.8.2
[0m10:30:58.974997 [info ] [MainThread]: Configuration:
[0m10:30:58.980034 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:30:58.980034 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:30:58.982951 [info ] [MainThread]: Required dependencies:
[0m10:30:58.984965 [debug] [MainThread]: Executing "git --help"
[0m10:30:59.069925 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:30:59.071094 [debug] [MainThread]: STDERR: "b''"
[0m10:30:59.072730 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:30:59.074445 [info ] [MainThread]: Connection:
[0m10:30:59.076174 [info ] [MainThread]:   host: localhost
[0m10:30:59.076174 [info ] [MainThread]:   port: 5432
[0m10:30:59.079697 [info ] [MainThread]:   user: postgres
[0m10:30:59.081639 [info ] [MainThread]:   database: res
[0m10:30:59.082677 [info ] [MainThread]:   schema: public
[0m10:30:59.083988 [info ] [MainThread]:   connect_timeout: 10
[0m10:30:59.085507 [info ] [MainThread]:   role: None
[0m10:30:59.086381 [info ] [MainThread]:   search_path: None
[0m10:30:59.086381 [info ] [MainThread]:   keepalives_idle: 0
[0m10:30:59.090031 [info ] [MainThread]:   sslmode: None
[0m10:30:59.091466 [info ] [MainThread]:   sslcert: None
[0m10:30:59.093513 [info ] [MainThread]:   sslkey: None
[0m10:30:59.095025 [info ] [MainThread]:   sslrootcert: None
[0m10:30:59.096654 [info ] [MainThread]:   application_name: dbt
[0m10:30:59.098288 [info ] [MainThread]:   retries: 1
[0m10:30:59.100717 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:30:59.102987 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:30:59.359913 [debug] [MainThread]: Using postgres connection "debug"
[0m10:30:59.359913 [debug] [MainThread]: On debug: select 1 as id
[0m10:30:59.359913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:59.461846 [debug] [MainThread]: SQL status: SELECT 1 in 0.099 seconds
[0m10:30:59.462829 [debug] [MainThread]: On debug: Close
[0m10:30:59.464863 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:30:59.464863 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:30:59.468060 [debug] [MainThread]: Command `dbt debug` succeeded at 10:30:59.468060 after 1.18 seconds
[0m10:30:59.468060 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:30:59.468060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001325A4AE030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001325AC92CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001325B059AF0>]}
[0m10:30:59.468060 [debug] [MainThread]: Flushing usage events
[0m22:54:25.953398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E70D3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E94B00B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E94B0740>]}


============================== 22:54:25.954920 | 84bcad88-f4fe-450a-b082-afcb28196a51 ==============================
[0m22:54:25.954920 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:54:25.959533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:54:25.986449 [info ] [MainThread]: dbt version: 1.8.3
[0m22:54:25.987473 [info ] [MainThread]: python version: 3.12.2
[0m22:54:25.988648 [info ] [MainThread]: python path: C:\Users\ADMIN\desktop\dbt_test\Scripts\python.exe
[0m22:54:25.988860 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m22:54:26.063713 [info ] [MainThread]: Using profiles dir at C:\Users\ADMIN\.dbt
[0m22:54:26.071152 [info ] [MainThread]: Using profiles.yml file at C:\Users\ADMIN\.dbt\profiles.yml
[0m22:54:26.072127 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ADMIN\Desktop\dbt_test\dbt_proj\dbt_project.yml
[0m22:54:26.073300 [info ] [MainThread]: adapter type: postgres
[0m22:54:26.074591 [info ] [MainThread]: adapter version: 1.8.2
[0m22:54:26.170249 [info ] [MainThread]: Configuration:
[0m22:54:26.171298 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:54:26.171298 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:54:26.172309 [info ] [MainThread]: Required dependencies:
[0m22:54:26.173306 [debug] [MainThread]: Executing "git --help"
[0m22:54:26.209231 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:54:26.209231 [debug] [MainThread]: STDERR: "b''"
[0m22:54:26.210318 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:54:26.211324 [info ] [MainThread]: Connection:
[0m22:54:26.212395 [info ] [MainThread]:   host: localhost
[0m22:54:26.213472 [info ] [MainThread]:   port: 5432
[0m22:54:26.213472 [info ] [MainThread]:   user: postgres
[0m22:54:26.214655 [info ] [MainThread]:   database: res
[0m22:54:26.214655 [info ] [MainThread]:   schema: public
[0m22:54:26.216179 [info ] [MainThread]:   connect_timeout: 10
[0m22:54:26.216179 [info ] [MainThread]:   role: None
[0m22:54:26.217212 [info ] [MainThread]:   search_path: None
[0m22:54:26.217212 [info ] [MainThread]:   keepalives_idle: 0
[0m22:54:26.218687 [info ] [MainThread]:   sslmode: None
[0m22:54:26.219696 [info ] [MainThread]:   sslcert: None
[0m22:54:26.219696 [info ] [MainThread]:   sslkey: None
[0m22:54:26.220812 [info ] [MainThread]:   sslrootcert: None
[0m22:54:26.222284 [info ] [MainThread]:   application_name: dbt
[0m22:54:26.223436 [info ] [MainThread]:   retries: 1
[0m22:54:26.224490 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:54:26.226463 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:54:26.339832 [debug] [MainThread]: Using postgres connection "debug"
[0m22:54:26.339832 [debug] [MainThread]: On debug: select 1 as id
[0m22:54:26.340343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:54:26.393759 [debug] [MainThread]: SQL status: SELECT 1 in 0.055 seconds
[0m22:54:26.396212 [debug] [MainThread]: On debug: Close
[0m22:54:26.396212 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:54:26.397865 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:54:26.399301 [debug] [MainThread]: Command `dbt debug` succeeded at 22:54:26.399301 after 0.62 seconds
[0m22:54:26.399301 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:54:26.401237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E9B72E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220EA100FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E9BA2DE0>]}
[0m22:54:26.401237 [debug] [MainThread]: Flushing usage events
[0m22:55:18.437831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C0F61CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C12198530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C122AA5A0>]}


============================== 22:55:18.439739 | a09337c9-e929-4bd5-8040-a14314d35722 ==============================
[0m22:55:18.439739 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:55:18.443296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:55:18.593519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a09337c9-e929-4bd5-8040-a14314d35722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C123FF8C0>]}
[0m22:55:18.625958 [debug] [MainThread]: Command `dbt clean` succeeded at 22:55:18.625958 after 0.31 seconds
[0m22:55:18.627026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C122599A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C11725AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C123DE330>]}
[0m22:55:18.628330 [debug] [MainThread]: Flushing usage events
[0m22:56:06.486479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED3713620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED35E2F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED2EC2FC0>]}


============================== 22:56:06.489442 | 7306c6dc-bb8b-4e3b-a7d7-6a7ce5ba3faa ==============================
[0m22:56:06.489442 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:56:06.489442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:56:06.683141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7306c6dc-bb8b-4e3b-a7d7-6a7ce5ba3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED1544770>]}
[0m22:56:06.803270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7306c6dc-bb8b-4e3b-a7d7-6a7ce5ba3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED381A870>]}
[0m22:56:06.803270 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:56:06.827563 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:56:06.829906 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:56:06.832109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7306c6dc-bb8b-4e3b-a7d7-6a7ce5ba3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED39B2D20>]}
[0m22:56:08.058296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7306c6dc-bb8b-4e3b-a7d7-6a7ce5ba3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED5156A80>]}
[0m22:56:08.153053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7306c6dc-bb8b-4e3b-a7d7-6a7ce5ba3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED538D160>]}
[0m22:56:08.154666 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m22:56:08.154666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7306c6dc-bb8b-4e3b-a7d7-6a7ce5ba3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED531A450>]}
[0m22:56:08.158178 [info ] [MainThread]: 
[0m22:56:08.158178 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:56:08.158178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m22:56:08.267839 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m22:56:08.267839 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m22:56:08.268839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:08.313401 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.047 seconds
[0m22:56:08.313401 [debug] [ThreadPool]: On list_res: Close
[0m22:56:08.313401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m22:56:08.323316 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m22:56:08.323316 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m22:56:08.323316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:08.368249 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m22:56:08.368249 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m22:56:08.368249 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:56:08.377613 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m22:56:08.377613 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m22:56:08.383122 [debug] [ThreadPool]: On list_res_public: Close
[0m22:56:08.384982 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:08.384982 [debug] [MainThread]: On master: BEGIN
[0m22:56:08.384982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:08.423360 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m22:56:08.423360 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:08.423360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:56:08.433402 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m22:56:08.433402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7306c6dc-bb8b-4e3b-a7d7-6a7ce5ba3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED532D820>]}
[0m22:56:08.433402 [debug] [MainThread]: On master: ROLLBACK
[0m22:56:08.438420 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:08.439428 [debug] [MainThread]: On master: BEGIN
[0m22:56:08.439428 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:56:08.441312 [debug] [MainThread]: On master: COMMIT
[0m22:56:08.441312 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:08.441312 [debug] [MainThread]: On master: COMMIT
[0m22:56:08.441312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:56:08.443325 [debug] [MainThread]: On master: Close
[0m22:56:08.443325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:56:08.443325 [info ] [MainThread]: 
[0m22:56:08.447696 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m22:56:08.447696 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m22:56:08.447696 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m22:56:08.451699 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m22:56:08.463417 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m22:56:08.465766 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m22:56:08.517609 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m22:56:08.519608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m22:56:08.520612 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m22:56:08.520612 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:56:08.565864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m22:56:08.565864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m22:56:08.569209 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse_prof_details AS (
    SELECT 
        b.idBonAnalyse, 
        b.dateCreation, 
        b.dateStatut, 
        b.isActuel, 
        b.montantInitial, 
        b.numeroBA, 
        eu.nom AS etablissement_universitaire_nom,
        me.nom AS membreexterne_nom,
        me.prenom AS membreexterne_prenom,
        fac.nom AS faculteecole_nom
    FROM 
        "res"."SC_App1"."bonanalyse" b
    INNER JOIN 
        "res"."SC_App1"."membreexterne" me ON b.idProfesseur = me.idMembreExterne
    INNER JOIN 
        "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me.idMembreExterne = dfac.idProfesseur
    INNER JOIN 
        "res"."SC_App1"."faculteecole" fac ON dfac.idFaculteEcole = fac.idFaculteEcole
    INNER JOIN 
        "res"."SC_App1"."etablissementuniversitaire" eu ON fac.idEtablissementUniversitaire = eu.idEtablissementUniversitaire
    WHERE 
        b.idProfesseur IS NOT NULL 
        AND dfac.idFaculteEcole IS NOT NULL
)
SELECT * FROM bonanalyse_prof_details;
  );
  
[0m22:56:08.574005 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 38: SELECT * FROM bonanalyse_prof_details;
                                              ^

[0m22:56:08.574005 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m22:56:08.576345 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m22:56:08.584119 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 38: SELECT * FROM bonanalyse_prof_details;
                                                ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m22:56:08.588130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7306c6dc-bb8b-4e3b-a7d7-6a7ce5ba3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED31F8B60>]}
[0m22:56:08.588130 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.14s]
[0m22:56:08.588130 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m22:56:08.593138 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:08.593138 [debug] [MainThread]: On master: BEGIN
[0m22:56:08.594679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:56:08.642056 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m22:56:08.643058 [debug] [MainThread]: On master: COMMIT
[0m22:56:08.643564 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:08.643564 [debug] [MainThread]: On master: COMMIT
[0m22:56:08.644573 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:56:08.644573 [debug] [MainThread]: On master: Close
[0m22:56:08.645576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:08.646574 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m22:56:08.647575 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m22:56:08.647974 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m22:56:08.648978 [info ] [MainThread]: 
[0m22:56:08.649979 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m22:56:08.651976 [debug] [MainThread]: Command end result
[0m22:56:08.728096 [info ] [MainThread]: 
[0m22:56:08.729087 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:56:08.729087 [info ] [MainThread]: 
[0m22:56:08.732119 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 38: SELECT * FROM bonanalyse_prof_details;
                                                ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m22:56:08.736446 [info ] [MainThread]: 
[0m22:56:08.736446 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:56:08.738298 [debug] [MainThread]: Command `dbt run` failed at 22:56:08.738298 after 2.39 seconds
[0m22:56:08.739813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED2F9E540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED3854980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED2F56CF0>]}
[0m22:56:08.739813 [debug] [MainThread]: Flushing usage events
[0m23:01:38.450731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202196E8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021755FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020219D092B0>]}


============================== 23:01:38.454376 | 14f1e3fc-29c9-4070-b714-fb8f9bea8582 ==============================
[0m23:01:38.454376 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:01:38.454376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:38.622665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f1e3fc-29c9-4070-b714-fb8f9bea8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020219FDAE40>]}
[0m23:01:38.672667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14f1e3fc-29c9-4070-b714-fb8f9bea8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020219EA2930>]}
[0m23:01:38.672667 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:01:38.684259 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:01:38.822268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:01:38.822268 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\bonanalyse_prof_details.sql
[0m23:01:39.038200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14f1e3fc-29c9-4070-b714-fb8f9bea8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021B845250>]}
[0m23:01:39.125231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14f1e3fc-29c9-4070-b714-fb8f9bea8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021A59A630>]}
[0m23:01:39.125231 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m23:01:39.125231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f1e3fc-29c9-4070-b714-fb8f9bea8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021B701B20>]}
[0m23:01:39.127939 [info ] [MainThread]: 
[0m23:01:39.127939 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:01:39.129977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m23:01:39.214416 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m23:01:39.215537 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m23:01:39.216046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:39.258265 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.043 seconds
[0m23:01:39.258265 [debug] [ThreadPool]: On list_res: Close
[0m23:01:39.258265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m23:01:39.268337 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:01:39.268337 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m23:01:39.268337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:39.303901 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m23:01:39.303901 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:01:39.307984 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:01:39.307984 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m23:01:39.307984 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m23:01:39.307984 [debug] [ThreadPool]: On list_res_public: Close
[0m23:01:39.318971 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:39.318971 [debug] [MainThread]: On master: BEGIN
[0m23:01:39.318971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:39.357941 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m23:01:39.357941 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:39.362076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:39.365230 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m23:01:39.368278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f1e3fc-29c9-4070-b714-fb8f9bea8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021B7A1220>]}
[0m23:01:39.368278 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:39.368278 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:39.368278 [debug] [MainThread]: On master: BEGIN
[0m23:01:39.368278 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:01:39.368278 [debug] [MainThread]: On master: COMMIT
[0m23:01:39.368278 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:39.371789 [debug] [MainThread]: On master: COMMIT
[0m23:01:39.372321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:01:39.372321 [debug] [MainThread]: On master: Close
[0m23:01:39.372321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:01:39.374484 [info ] [MainThread]: 
[0m23:01:39.378044 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m23:01:39.379089 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m23:01:39.380167 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m23:01:39.381262 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m23:01:39.391274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:01:39.391809 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m23:01:39.433014 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:01:39.433014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:01:39.436234 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m23:01:39.437267 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:01:39.478329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:01:39.479387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:01:39.480437 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse_prof_details AS (
    SELECT 
        b.idBonAnalyse, 
        b.dateCreation, 
        b.dateStatut, 
        b.isActuel, 
        b.montantInitial, 
        b.numeroBA, 
        eu.nom AS etablissement_universitaire_nom,
        me.nom AS membreexterne_nom,
        me.prenom AS membreexterne_prenom,
        fac.nom AS faculteecole_nom
    FROM 
        "res"."SC_App1"."bonanalyse" b
    INNER JOIN 
        "res"."SC_App1"."membreexterne" me ON b.idProfesseur = me.idMembreExterne
    INNER JOIN 
        "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me.idMembreExterne = dfac.idProfesseur
    INNER JOIN 
        "res"."SC_App1"."faculteecole" fac ON dfac.idFaculteEcole = fac.idFaculteEcole
    INNER JOIN 
        "res"."SC_App1"."etablissementuniversitaire" eu ON fac.idEtablissementUniversitaire = eu.idEtablissementUniversitaire
    WHERE 
        b.idProfesseur IS NOT NULL 
        AND dfac.idFaculteEcole IS NOT NULL
)
SELECT * FROM bonanalyse_prof_details
  );
  
[0m23:01:39.483423 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne b.idprofesseur n'existe pas
LINE 27:         "res"."SC_App1"."membreexterne" me ON b.idProfesseur...
                                                       ^
HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».

[0m23:01:39.484429 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m23:01:39.485428 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m23:01:39.492455 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la colonne b.idprofesseur n'existe pas
  LINE 27:         "res"."SC_App1"."membreexterne" me ON b.idProfesseur...
                                                         ^
  HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:01:39.494439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14f1e3fc-29c9-4070-b714-fb8f9bea8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021A5A0A70>]}
[0m23:01:39.495440 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.11s]
[0m23:01:39.496403 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m23:01:39.498915 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:39.498915 [debug] [MainThread]: On master: BEGIN
[0m23:01:39.499916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:01:39.540996 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m23:01:39.542042 [debug] [MainThread]: On master: COMMIT
[0m23:01:39.542042 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:39.543044 [debug] [MainThread]: On master: COMMIT
[0m23:01:39.543159 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:01:39.543159 [debug] [MainThread]: On master: Close
[0m23:01:39.544421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:39.544421 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m23:01:39.544421 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m23:01:39.546467 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m23:01:39.547033 [info ] [MainThread]: 
[0m23:01:39.548039 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m23:01:39.549676 [debug] [MainThread]: Command end result
[0m23:01:39.576146 [info ] [MainThread]: 
[0m23:01:39.577326 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:01:39.578404 [info ] [MainThread]: 
[0m23:01:39.579488 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la colonne b.idprofesseur n'existe pas
  LINE 27:         "res"."SC_App1"."membreexterne" me ON b.idProfesseur...
                                                         ^
  HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:01:39.580500 [info ] [MainThread]: 
[0m23:01:39.581507 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:01:39.582496 [debug] [MainThread]: Command `dbt run` failed at 23:01:39.582496 after 1.30 seconds
[0m23:01:39.582496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202192AECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021A0A0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021905C500>]}
[0m23:01:39.583559 [debug] [MainThread]: Flushing usage events
[0m23:04:09.737570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0B1BF620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0D892FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0AB3EF30>]}


============================== 23:04:09.740718 | 9e0f10ad-7f5c-4abd-8630-f10a3724f236 ==============================
[0m23:04:09.740718 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:04:09.740718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:04:09.907794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e0f10ad-7f5c-4abd-8630-f10a3724f236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0DCE1400>]}
[0m23:04:09.957974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e0f10ad-7f5c-4abd-8630-f10a3724f236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0D3B1100>]}
[0m23:04:09.957974 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:04:09.969702 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:04:10.102867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:04:10.102867 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:04:10.132694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e0f10ad-7f5c-4abd-8630-f10a3724f236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0DE66A20>]}
[0m23:04:10.223397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e0f10ad-7f5c-4abd-8630-f10a3724f236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0F348BF0>]}
[0m23:04:10.223397 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m23:04:10.226061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e0f10ad-7f5c-4abd-8630-f10a3724f236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0DE65160>]}
[0m23:04:10.227704 [info ] [MainThread]: 
[0m23:04:10.228749 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:04:10.228749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m23:04:10.312910 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m23:04:10.312910 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m23:04:10.312910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:10.357910 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.042 seconds
[0m23:04:10.357910 [debug] [ThreadPool]: On list_res: Close
[0m23:04:10.357910 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m23:04:10.367590 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:04:10.367590 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m23:04:10.367590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:10.407481 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m23:04:10.407481 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:04:10.409876 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:04:10.412596 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m23:04:10.412596 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m23:04:10.412596 [debug] [ThreadPool]: On list_res_public: Close
[0m23:04:10.421553 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:10.422067 [debug] [MainThread]: On master: BEGIN
[0m23:04:10.422067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:10.457836 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:04:10.457836 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:10.457836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:04:10.465695 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m23:04:10.466201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e0f10ad-7f5c-4abd-8630-f10a3724f236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0F8CCD70>]}
[0m23:04:10.467704 [debug] [MainThread]: On master: ROLLBACK
[0m23:04:10.467704 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:10.467704 [debug] [MainThread]: On master: BEGIN
[0m23:04:10.469313 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:04:10.470357 [debug] [MainThread]: On master: COMMIT
[0m23:04:10.470357 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:10.470899 [debug] [MainThread]: On master: COMMIT
[0m23:04:10.470899 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:04:10.472394 [debug] [MainThread]: On master: Close
[0m23:04:10.472394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:04:10.472394 [info ] [MainThread]: 
[0m23:04:10.477460 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m23:04:10.477460 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m23:04:10.477460 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m23:04:10.480064 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m23:04:10.493525 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:04:10.494030 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m23:04:10.541966 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:04:10.541966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:04:10.541966 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m23:04:10.543862 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:10.583218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:04:10.584229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:04:10.584742 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse_prof_details AS (
    SELECT 
        b.idBonAnalyse, 
        b.dateCreation, 
        b.dateStatut, 
        b.isActuel, 
        b.montantInitial, 
        b.numeroBA, 
        eu.nom AS etablissement_universitaire_nom,
        me.nom AS membreexterne_nom,
        me.prenom AS membreexterne_prenom,
        fac.nom AS faculteecole_nom
    FROM 
        "res"."SC_App1"."bonanalyse" b
    INNER JOIN 
        "res"."SC_App1"."membreexterne" me ON b.idProfesseur = me.idMembreExterne
    INNER JOIN 
        "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me.idMembreExterne = dfac.idProfesseur
    INNER JOIN 
        "res"."SC_App1"."faculteecole" fac ON dfac.idFaculteEcole = fac.idFaculteEcole
    INNER JOIN 
        "res"."SC_App1"."etablissementuniversitaire" eu ON fac.idEtablissementUniversitaire = eu.idEtablissementUniversitaire
    WHERE 
        b.idProfesseur IS NOT NULL 
        AND dfac.idFaculteEcole IS NOT NULL
)
SELECT * FROM bonanalyse_prof_details
  );
  
[0m23:04:10.585752 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne b.idprofesseur n'existe pas
LINE 27:         "res"."SC_App1"."membreexterne" me ON b.idProfesseur...
                                                       ^
HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».

[0m23:04:10.587753 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m23:04:10.589789 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m23:04:10.595433 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la colonne b.idprofesseur n'existe pas
  LINE 27:         "res"."SC_App1"."membreexterne" me ON b.idProfesseur...
                                                         ^
  HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:04:10.596433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e0f10ad-7f5c-4abd-8630-f10a3724f236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0D348CB0>]}
[0m23:04:10.597433 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.12s]
[0m23:04:10.598947 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m23:04:10.600949 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:10.600949 [debug] [MainThread]: On master: BEGIN
[0m23:04:10.601949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:10.643110 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m23:04:10.644431 [debug] [MainThread]: On master: COMMIT
[0m23:04:10.644431 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:10.644431 [debug] [MainThread]: On master: COMMIT
[0m23:04:10.644431 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:04:10.646005 [debug] [MainThread]: On master: Close
[0m23:04:10.646005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:10.647566 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m23:04:10.647566 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m23:04:10.647566 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m23:04:10.647566 [info ] [MainThread]: 
[0m23:04:10.650208 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m23:04:10.650208 [debug] [MainThread]: Command end result
[0m23:04:10.676305 [info ] [MainThread]: 
[0m23:04:10.677815 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:04:10.678512 [info ] [MainThread]: 
[0m23:04:10.679538 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la colonne b.idprofesseur n'existe pas
  LINE 27:         "res"."SC_App1"."membreexterne" me ON b.idProfesseur...
                                                         ^
  HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:04:10.680752 [info ] [MainThread]: 
[0m23:04:10.682186 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:04:10.683797 [debug] [MainThread]: Command `dbt run` failed at 23:04:10.682692 after 1.11 seconds
[0m23:04:10.683874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0B1BF620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0DCE0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0D3B0B60>]}
[0m23:04:10.683874 [debug] [MainThread]: Flushing usage events
[0m23:04:10.994605 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m23:06:23.290944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72516B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72814AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727EBED80>]}


============================== 23:06:23.290944 | 587fc4bc-e810-4228-bf40-d8c655131fc2 ==============================
[0m23:06:23.290944 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:06:23.290944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:06:23.466511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '587fc4bc-e810-4228-bf40-d8c655131fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D728A91040>]}
[0m23:06:23.524881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '587fc4bc-e810-4228-bf40-d8c655131fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72899BC80>]}
[0m23:06:23.526005 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:06:23.530187 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:06:23.668437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:06:23.668437 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\bonanalyse_prof_details.sql
[0m23:06:23.889131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '587fc4bc-e810-4228-bf40-d8c655131fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D728FAF4A0>]}
[0m23:06:23.977063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '587fc4bc-e810-4228-bf40-d8c655131fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72A03E8D0>]}
[0m23:06:23.977063 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m23:06:23.977063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '587fc4bc-e810-4228-bf40-d8c655131fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D728AB1940>]}
[0m23:06:23.977063 [info ] [MainThread]: 
[0m23:06:23.977063 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:06:23.977063 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m23:06:24.069210 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m23:06:24.069210 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m23:06:24.069210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:24.116005 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.044 seconds
[0m23:06:24.117241 [debug] [ThreadPool]: On list_res: Close
[0m23:06:24.118813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m23:06:24.122107 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:06:24.122107 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m23:06:24.122107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:24.164863 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m23:06:24.164863 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:06:24.164863 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:06:24.169029 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m23:06:24.169029 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m23:06:24.169029 [debug] [ThreadPool]: On list_res_public: Close
[0m23:06:24.178316 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:24.178316 [debug] [MainThread]: On master: BEGIN
[0m23:06:24.178316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:24.217394 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m23:06:24.217394 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:24.217394 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:06:24.219489 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m23:06:24.219489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '587fc4bc-e810-4228-bf40-d8c655131fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72A1F0440>]}
[0m23:06:24.226997 [debug] [MainThread]: On master: ROLLBACK
[0m23:06:24.226997 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:24.228020 [debug] [MainThread]: On master: BEGIN
[0m23:06:24.228020 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:06:24.228020 [debug] [MainThread]: On master: COMMIT
[0m23:06:24.228020 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:24.228020 [debug] [MainThread]: On master: COMMIT
[0m23:06:24.228020 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:06:24.228020 [debug] [MainThread]: On master: Close
[0m23:06:24.228020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:06:24.228020 [info ] [MainThread]: 
[0m23:06:24.234212 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m23:06:24.237289 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m23:06:24.237289 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m23:06:24.239243 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m23:06:24.247157 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:24.250206 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m23:06:24.287402 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:24.287402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:24.287402 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m23:06:24.287402 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:06:24.338076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:06:24.339077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:24.339077 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    -- Define the sources
WITH bonanalyse AS (
    SELECT * 
    FROM "res"."SC_App1"."bonanalyse"
),
membreexterne AS (
    SELECT * 
    FROM "res"."SC_App1"."membreexterne"
),
detailfaculteecoleprofesseur AS (
    SELECT * 
    FROM "res"."SC_App1"."detailfaculteecoleprofesseur"
),
faculteecole AS (
    SELECT * 
    FROM "res"."SC_App1"."faculteecole"
),
etablissementuniversitaire AS (
    SELECT * 
    FROM "res"."SC_App1"."etablissementuniversitaire"
)

-- Main Query
SELECT 
    b.idBonAnalyse, 
    b.dateCreation, 
    b.dateStatut, 
    b.isActuel, 
    b.montantInitial, 
    b.numeroBA, 
    eu.nom AS etablissement_universitaire_nom,
    me.nom AS membreexterne_nom,
    me.prenom AS membreexterne_prenom,
    fac.nom AS faculteecole_nom
FROM 
    bonanalyse b
INNER JOIN 
    membreexterne me ON b.idProfesseur = me.idMembreExterne
INNER JOIN 
    detailfaculteecoleprofesseur dfac ON me.idMembreExterne = dfac.idProfesseur
INNER JOIN 
    faculteecole fac ON dfac.idFaculteEcole = fac.idFaculteEcole
INNER JOIN 
    etablissementuniversitaire eu ON fac.idEtablissementUniversitaire = eu.idEtablissementUniversitaire
WHERE 
    b.idProfesseur IS NOT NULL 
    AND dfac.idFaculteEcole IS NOT NULL;
  );
  
[0m23:06:24.340842 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 58:     AND dfac.idFaculteEcole IS NOT NULL;
                                                ^

[0m23:06:24.342350 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m23:06:24.343356 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m23:06:24.348869 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 58:     AND dfac.idFaculteEcole IS NOT NULL;
                                                  ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:06:24.349963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '587fc4bc-e810-4228-bf40-d8c655131fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72A887DA0>]}
[0m23:06:24.351679 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.11s]
[0m23:06:24.351679 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m23:06:24.353388 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:24.355252 [debug] [MainThread]: On master: BEGIN
[0m23:06:24.355762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:06:24.407290 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m23:06:24.407290 [debug] [MainThread]: On master: COMMIT
[0m23:06:24.407290 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:24.407290 [debug] [MainThread]: On master: COMMIT
[0m23:06:24.407290 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:06:24.414890 [debug] [MainThread]: On master: Close
[0m23:06:24.415801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:24.415801 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m23:06:24.415801 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m23:06:24.417308 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m23:06:24.417837 [info ] [MainThread]: 
[0m23:06:24.419614 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m23:06:24.419614 [debug] [MainThread]: Command end result
[0m23:06:24.441305 [info ] [MainThread]: 
[0m23:06:24.447312 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:06:24.447694 [info ] [MainThread]: 
[0m23:06:24.448329 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 58:     AND dfac.idFaculteEcole IS NOT NULL;
                                                  ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:06:24.449341 [info ] [MainThread]: 
[0m23:06:24.450694 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:06:24.452711 [debug] [MainThread]: Command `dbt run` failed at 23:06:24.452711 after 1.33 seconds
[0m23:06:24.453819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72516B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72A2131D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727C6B410>]}
[0m23:06:24.455204 [debug] [MainThread]: Flushing usage events
[0m23:06:28.819984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021869C22B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021867300950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218698BECF0>]}


============================== 23:06:28.823927 | d12bfe10-8a6f-4ef8-9e0b-d66dbacf79ac ==============================
[0m23:06:28.823927 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:06:28.823927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:06:28.943647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12bfe10-8a6f-4ef8-9e0b-d66dbacf79ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021866346780>]}
[0m23:06:28.967126 [debug] [MainThread]: Command `dbt clean` succeeded at 23:06:28.967126 after 0.26 seconds
[0m23:06:28.968050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021869C22B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021866346780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218690AB5F0>]}
[0m23:06:28.969056 [debug] [MainThread]: Flushing usage events
[0m23:06:32.919017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A04DCF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319FFBB0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F5BD820>]}


============================== 23:06:32.922232 | 492d073a-ec83-4031-b14b-087edac1cdc5 ==============================
[0m23:06:32.922232 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:06:32.922232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:06:33.093563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '492d073a-ec83-4031-b14b-087edac1cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A2C68140>]}
[0m23:06:33.141056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '492d073a-ec83-4031-b14b-087edac1cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A3183FB0>]}
[0m23:06:33.147160 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:06:33.152169 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:06:33.156175 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:06:33.157639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '492d073a-ec83-4031-b14b-087edac1cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A36705C0>]}
[0m23:06:34.236108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '492d073a-ec83-4031-b14b-087edac1cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A47AB800>]}
[0m23:06:34.317443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '492d073a-ec83-4031-b14b-087edac1cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A493A180>]}
[0m23:06:34.322776 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m23:06:34.323284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '492d073a-ec83-4031-b14b-087edac1cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A4906F00>]}
[0m23:06:34.324428 [info ] [MainThread]: 
[0m23:06:34.324428 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:06:34.324428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m23:06:34.419974 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m23:06:34.419974 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m23:06:34.419974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:34.463457 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.043 seconds
[0m23:06:34.464656 [debug] [ThreadPool]: On list_res: Close
[0m23:06:34.467070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m23:06:34.474396 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:06:34.474396 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m23:06:34.474396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:34.512880 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m23:06:34.512880 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:06:34.512880 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:06:34.518151 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m23:06:34.518151 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m23:06:34.518151 [debug] [ThreadPool]: On list_res_public: Close
[0m23:06:34.527076 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:34.528142 [debug] [MainThread]: On master: BEGIN
[0m23:06:34.528142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:34.568217 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m23:06:34.568217 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:34.569625 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:06:34.574081 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:06:34.576329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '492d073a-ec83-4031-b14b-087edac1cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A493A330>]}
[0m23:06:34.577478 [debug] [MainThread]: On master: ROLLBACK
[0m23:06:34.578049 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:34.579056 [debug] [MainThread]: On master: BEGIN
[0m23:06:34.580078 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:06:34.580078 [debug] [MainThread]: On master: COMMIT
[0m23:06:34.581277 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:34.582090 [debug] [MainThread]: On master: COMMIT
[0m23:06:34.582090 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:06:34.582090 [debug] [MainThread]: On master: Close
[0m23:06:34.583818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:06:34.585150 [info ] [MainThread]: 
[0m23:06:34.588804 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m23:06:34.588804 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m23:06:34.591279 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m23:06:34.591279 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m23:06:34.602613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:34.604126 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m23:06:34.647259 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:34.647259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:34.647259 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m23:06:34.647259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:06:34.694971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:06:34.695973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:34.695973 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    -- Define the sources
WITH bonanalyse AS (
    SELECT * 
    FROM "res"."SC_App1"."bonanalyse"
),
membreexterne AS (
    SELECT * 
    FROM "res"."SC_App1"."membreexterne"
),
detailfaculteecoleprofesseur AS (
    SELECT * 
    FROM "res"."SC_App1"."detailfaculteecoleprofesseur"
),
faculteecole AS (
    SELECT * 
    FROM "res"."SC_App1"."faculteecole"
),
etablissementuniversitaire AS (
    SELECT * 
    FROM "res"."SC_App1"."etablissementuniversitaire"
)

-- Main Query
SELECT 
    b.idBonAnalyse, 
    b.dateCreation, 
    b.dateStatut, 
    b.isActuel, 
    b.montantInitial, 
    b.numeroBA, 
    eu.nom AS etablissement_universitaire_nom,
    me.nom AS membreexterne_nom,
    me.prenom AS membreexterne_prenom,
    fac.nom AS faculteecole_nom
FROM 
    bonanalyse b
INNER JOIN 
    membreexterne me ON b.idProfesseur = me.idMembreExterne
INNER JOIN 
    detailfaculteecoleprofesseur dfac ON me.idMembreExterne = dfac.idProfesseur
INNER JOIN 
    faculteecole fac ON dfac.idFaculteEcole = fac.idFaculteEcole
INNER JOIN 
    etablissementuniversitaire eu ON fac.idEtablissementUniversitaire = eu.idEtablissementUniversitaire
WHERE 
    b.idProfesseur IS NOT NULL 
    AND dfac.idFaculteEcole IS NOT NULL;
  );
  
[0m23:06:34.697511 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 58:     AND dfac.idFaculteEcole IS NOT NULL;
                                                ^

[0m23:06:34.697511 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m23:06:34.698526 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m23:06:34.704221 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 58:     AND dfac.idFaculteEcole IS NOT NULL;
                                                  ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:06:34.705604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '492d073a-ec83-4031-b14b-087edac1cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A47A9730>]}
[0m23:06:34.705604 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.11s]
[0m23:06:34.706996 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m23:06:34.709680 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:34.710228 [debug] [MainThread]: On master: BEGIN
[0m23:06:34.710228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:06:34.751504 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m23:06:34.751504 [debug] [MainThread]: On master: COMMIT
[0m23:06:34.752727 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:34.752727 [debug] [MainThread]: On master: COMMIT
[0m23:06:34.752727 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:06:34.752727 [debug] [MainThread]: On master: Close
[0m23:06:34.752727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:34.752727 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m23:06:34.752727 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m23:06:34.752727 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m23:06:34.752727 [info ] [MainThread]: 
[0m23:06:34.757235 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m23:06:34.758761 [debug] [MainThread]: Command end result
[0m23:06:34.852151 [info ] [MainThread]: 
[0m23:06:34.857158 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:06:34.857158 [info ] [MainThread]: 
[0m23:06:34.860186 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 58:     AND dfac.idFaculteEcole IS NOT NULL;
                                                  ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:06:34.861194 [info ] [MainThread]: 
[0m23:06:34.862317 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:06:34.865109 [debug] [MainThread]: Command `dbt run` failed at 23:06:34.865109 after 2.07 seconds
[0m23:06:34.866175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A2E24980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A27F4F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A0C248C0>]}
[0m23:06:34.866689 [debug] [MainThread]: Flushing usage events
[0m23:06:42.791359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7337F62D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B734926780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B734926960>]}


============================== 23:06:42.794871 | 4c12e879-6bf2-4b6d-a44e-c78b5d91b00f ==============================
[0m23:06:42.794871 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:06:42.796878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:06:42.931830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c12e879-6bf2-4b6d-a44e-c78b5d91b00f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B734B010D0>]}
[0m23:06:42.957284 [debug] [MainThread]: Command `dbt clean` succeeded at 23:06:42.957284 after 0.29 seconds
[0m23:06:42.957792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B733916FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B734B010D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7340EA6C0>]}
[0m23:06:42.958800 [debug] [MainThread]: Flushing usage events
[0m23:06:47.325754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500BF20200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500DE78590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500DE78E90>]}


============================== 23:06:47.328276 | e2f9281e-4f22-477c-baca-e08c680ca65a ==============================
[0m23:06:47.328276 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:06:47.328276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:06:47.507123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2f9281e-4f22-477c-baca-e08c680ca65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500E73BFE0>]}
[0m23:06:47.561497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2f9281e-4f22-477c-baca-e08c680ca65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500E833FB0>]}
[0m23:06:47.561497 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:06:47.572341 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:06:47.572341 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:06:47.572341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e2f9281e-4f22-477c-baca-e08c680ca65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500E85C860>]}
[0m23:06:48.658183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2f9281e-4f22-477c-baca-e08c680ca65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500E995910>]}
[0m23:06:48.741187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2f9281e-4f22-477c-baca-e08c680ca65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500FF51220>]}
[0m23:06:48.741187 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m23:06:48.746266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f9281e-4f22-477c-baca-e08c680ca65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500FF7E5A0>]}
[0m23:06:48.748401 [info ] [MainThread]: 
[0m23:06:48.748401 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:06:48.750080 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m23:06:48.847193 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m23:06:48.847193 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m23:06:48.848136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:48.897012 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.049 seconds
[0m23:06:48.897012 [debug] [ThreadPool]: On list_res: Close
[0m23:06:48.899654 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m23:06:48.904961 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:06:48.907001 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m23:06:48.907001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:48.947209 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m23:06:48.947209 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:06:48.947209 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:06:48.954696 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m23:06:48.954696 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m23:06:48.957269 [debug] [ThreadPool]: On list_res_public: Close
[0m23:06:48.961432 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:48.961432 [debug] [MainThread]: On master: BEGIN
[0m23:06:48.961432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:49.001091 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m23:06:49.001091 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:49.001091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:06:49.007311 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:06:49.007311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f9281e-4f22-477c-baca-e08c680ca65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500FE77620>]}
[0m23:06:49.007311 [debug] [MainThread]: On master: ROLLBACK
[0m23:06:49.007311 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:49.007311 [debug] [MainThread]: On master: BEGIN
[0m23:06:49.013313 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:06:49.013313 [debug] [MainThread]: On master: COMMIT
[0m23:06:49.014872 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:49.014872 [debug] [MainThread]: On master: COMMIT
[0m23:06:49.014872 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:06:49.014872 [debug] [MainThread]: On master: Close
[0m23:06:49.016879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:06:49.016879 [info ] [MainThread]: 
[0m23:06:49.021522 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m23:06:49.021522 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m23:06:49.021522 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m23:06:49.023620 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m23:06:49.031804 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:49.034126 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m23:06:49.083896 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:49.085875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:49.087805 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m23:06:49.087805 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:06:49.130111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:06:49.131111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:06:49.132110 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    -- Define the sources
WITH bonanalyse AS (
    SELECT * 
    FROM "res"."SC_App1"."bonanalyse"
),
membreexterne AS (
    SELECT * 
    FROM "res"."SC_App1"."membreexterne"
),
detailfaculteecoleprofesseur AS (
    SELECT * 
    FROM "res"."SC_App1"."detailfaculteecoleprofesseur"
),
faculteecole AS (
    SELECT * 
    FROM "res"."SC_App1"."faculteecole"
),
etablissementuniversitaire AS (
    SELECT * 
    FROM "res"."SC_App1"."etablissementuniversitaire"
)

-- Main Query
SELECT 
    b.idBonAnalyse, 
    b.dateCreation, 
    b.dateStatut, 
    b.isActuel, 
    b.montantInitial, 
    b.numeroBA, 
    eu.nom AS etablissement_universitaire_nom,
    me.nom AS membreexterne_nom,
    me.prenom AS membreexterne_prenom,
    fac.nom AS faculteecole_nom
FROM 
    bonanalyse b
INNER JOIN 
    membreexterne me ON b.idProfesseur = me.idMembreExterne
INNER JOIN 
    detailfaculteecoleprofesseur dfac ON me.idMembreExterne = dfac.idProfesseur
INNER JOIN 
    faculteecole fac ON dfac.idFaculteEcole = fac.idFaculteEcole
INNER JOIN 
    etablissementuniversitaire eu ON fac.idEtablissementUniversitaire = eu.idEtablissementUniversitaire
WHERE 
    b.idProfesseur IS NOT NULL 
    AND dfac.idFaculteEcole IS NOT NULL
  );
  
[0m23:06:49.133111 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne b.idprofesseur n'existe pas
LINE 49:     membreexterne me ON b.idProfesseur = me.idMembreExterne
                                 ^
HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».

[0m23:06:49.134113 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m23:06:49.134113 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m23:06:49.140298 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la colonne b.idprofesseur n'existe pas
  LINE 49:     membreexterne me ON b.idProfesseur = me.idMembreExterne
                                   ^
  HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:06:49.140298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f9281e-4f22-477c-baca-e08c680ca65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500DE78E00>]}
[0m23:06:49.140298 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.12s]
[0m23:06:49.144422 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m23:06:49.145576 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:49.147082 [debug] [MainThread]: On master: BEGIN
[0m23:06:49.147082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:06:49.191992 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m23:06:49.193055 [debug] [MainThread]: On master: COMMIT
[0m23:06:49.193559 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:49.193559 [debug] [MainThread]: On master: COMMIT
[0m23:06:49.194655 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:06:49.194655 [debug] [MainThread]: On master: Close
[0m23:06:49.196245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:49.196245 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m23:06:49.196245 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m23:06:49.197249 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m23:06:49.197249 [info ] [MainThread]: 
[0m23:06:49.197249 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m23:06:49.199202 [debug] [MainThread]: Command end result
[0m23:06:49.273388 [info ] [MainThread]: 
[0m23:06:49.273388 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:06:49.275901 [info ] [MainThread]: 
[0m23:06:49.275901 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la colonne b.idprofesseur n'existe pas
  LINE 49:     membreexterne me ON b.idProfesseur = me.idMembreExterne
                                   ^
  HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:06:49.276907 [info ] [MainThread]: 
[0m23:06:49.278178 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:06:49.278178 [debug] [MainThread]: Command `dbt run` failed at 23:06:49.278178 after 2.08 seconds
[0m23:06:49.280504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500DD7A8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500E4DC5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500FFA4980>]}
[0m23:06:49.281008 [debug] [MainThread]: Flushing usage events
[0m23:09:10.351418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDF3DE6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE1692E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDE623020>]}


============================== 23:09:10.352745 | 53c35188-f897-476b-a825-6b8b8378e7d6 ==============================
[0m23:09:10.352745 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:09:10.356757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m23:09:10.482563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53c35188-f897-476b-a825-6b8b8378e7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE1650080>]}
[0m23:09:10.504473 [debug] [MainThread]: Command `dbt clean` succeeded at 23:09:10.504473 after 0.33 seconds
[0m23:09:10.505273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDF3DE6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE19F43E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE1A26AE0>]}
[0m23:09:10.506786 [debug] [MainThread]: Flushing usage events
[0m23:09:14.578354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F026F38170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F026643BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0266400B0>]}


============================== 23:09:14.582898 | 6a4c6ce1-736a-4644-b2a2-33516cbeff30 ==============================
[0m23:09:14.582898 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:09:14.583404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:09:14.748858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a4c6ce1-736a-4644-b2a2-33516cbeff30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F02738B200>]}
[0m23:09:14.803554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a4c6ce1-736a-4644-b2a2-33516cbeff30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0273B00E0>]}
[0m23:09:14.805446 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:09:14.807489 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:09:14.807489 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:09:14.807489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a4c6ce1-736a-4644-b2a2-33516cbeff30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F027501640>]}
[0m23:09:15.871530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a4c6ce1-736a-4644-b2a2-33516cbeff30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F028A7B440>]}
[0m23:09:15.960655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a4c6ce1-736a-4644-b2a2-33516cbeff30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F028B09D90>]}
[0m23:09:15.962681 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m23:09:15.962681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a4c6ce1-736a-4644-b2a2-33516cbeff30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F028B20EC0>]}
[0m23:09:15.964598 [info ] [MainThread]: 
[0m23:09:15.964598 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:09:15.966693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m23:09:16.049376 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m23:09:16.049376 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m23:09:16.050378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:16.091786 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.042 seconds
[0m23:09:16.091786 [debug] [ThreadPool]: On list_res: Close
[0m23:09:16.094027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m23:09:16.096626 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:09:16.101677 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m23:09:16.101677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:16.137642 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m23:09:16.141214 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:09:16.141214 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:09:16.141214 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m23:09:16.146791 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m23:09:16.146791 [debug] [ThreadPool]: On list_res_public: Close
[0m23:09:16.152523 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:16.153568 [debug] [MainThread]: On master: BEGIN
[0m23:09:16.153568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:16.189780 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m23:09:16.189780 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:16.193545 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:09:16.196690 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m23:09:16.199189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a4c6ce1-736a-4644-b2a2-33516cbeff30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F02747D3A0>]}
[0m23:09:16.199189 [debug] [MainThread]: On master: ROLLBACK
[0m23:09:16.199189 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:16.201195 [debug] [MainThread]: On master: BEGIN
[0m23:09:16.201195 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:09:16.203289 [debug] [MainThread]: On master: COMMIT
[0m23:09:16.203289 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:16.203289 [debug] [MainThread]: On master: COMMIT
[0m23:09:16.203289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:09:16.203289 [debug] [MainThread]: On master: Close
[0m23:09:16.206093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:09:16.206600 [info ] [MainThread]: 
[0m23:09:16.206600 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m23:09:16.206600 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m23:09:16.212727 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m23:09:16.213910 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m23:09:16.224183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:09:16.226577 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m23:09:16.271752 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:09:16.273201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:09:16.274668 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m23:09:16.275316 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:09:16.314208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:09:16.314208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:09:16.315236 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    -- Define the sources
WITH bonanalyse AS (
    SELECT * 
    FROM "res"."SC_App1"."bonanalyse"
),
membreexterne AS (
    SELECT * 
    FROM "res"."SC_App1"."membreexterne"
),
detailfaculteecoleprofesseur AS (
    SELECT * 
    FROM "res"."SC_App1"."detailfaculteecoleprofesseur"
),
faculteecole AS (
    SELECT * 
    FROM "res"."SC_App1"."faculteecole"
),
etablissementuniversitaire AS (
    SELECT * 
    FROM "res"."SC_App1"."etablissementuniversitaire"
)

-- Main Query
SELECT 
    b.idBonAnalyse, 
    b.dateCreation, 
    b.dateStatut, 
    b.isActuel, 
    b.montantInitial, 
    b.numeroBA, 
    eu.nom AS etablissement_universitaire_nom,
    me.nom AS membreexterne_nom,
    me.prenom AS membreexterne_prenom,
    fac.nom AS faculteecole_nom
FROM 
    bonanalyse b
INNER JOIN 
    membreexterne me ON bonanalyse.idProfesseur = me.idMembreExterne
INNER JOIN 
    detailfaculteecoleprofesseur dfac ON me.idMembreExterne = dfac.idProfesseur
INNER JOIN 
    faculteecole fac ON dfac.idFaculteEcole = fac.idFaculteEcole
INNER JOIN 
    etablissementuniversitaire eu ON fac.idEtablissementUniversitaire = eu.idEtablissementUniversitaire
WHERE 
    bonanalyse.idProfesseur IS NOT NULL 
    AND dfac.idFaculteEcole IS NOT NULL
  );
  
[0m23:09:16.316742 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  référence invalide d'une entrée de la clause FROM pour la table « bonanalyse »
LINE 49:     membreexterne me ON bonanalyse.idProfesseur = me.idMembr...
                                 ^
HINT:  Peut-être que vous souhaitiez référencer l'alias de la table « b ».

[0m23:09:16.316807 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m23:09:16.317325 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m23:09:16.322972 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  référence invalide d'une entrée de la clause FROM pour la table « bonanalyse »
  LINE 49:     membreexterne me ON bonanalyse.idProfesseur = me.idMembr...
                                   ^
  HINT:  Peut-être que vous souhaitiez référencer l'alias de la table « b ».
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:09:16.323972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4c6ce1-736a-4644-b2a2-33516cbeff30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0275B6B40>]}
[0m23:09:16.323972 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.11s]
[0m23:09:16.326709 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m23:09:16.326709 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:16.326709 [debug] [MainThread]: On master: BEGIN
[0m23:09:16.329620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:09:16.369406 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m23:09:16.369406 [debug] [MainThread]: On master: COMMIT
[0m23:09:16.369406 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:16.369406 [debug] [MainThread]: On master: COMMIT
[0m23:09:16.369406 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:09:16.372924 [debug] [MainThread]: On master: Close
[0m23:09:16.373768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:16.373768 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m23:09:16.373768 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m23:09:16.376855 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m23:09:16.377950 [info ] [MainThread]: 
[0m23:09:16.379088 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m23:09:16.380370 [debug] [MainThread]: Command end result
[0m23:09:16.463657 [info ] [MainThread]: 
[0m23:09:16.464778 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:09:16.465284 [info ] [MainThread]: 
[0m23:09:16.465284 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  référence invalide d'une entrée de la clause FROM pour la table « bonanalyse »
  LINE 49:     membreexterne me ON bonanalyse.idProfesseur = me.idMembr...
                                   ^
  HINT:  Peut-être que vous souhaitiez référencer l'alias de la table « b ».
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:09:16.466791 [info ] [MainThread]: 
[0m23:09:16.468383 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:09:16.470195 [debug] [MainThread]: Command `dbt run` failed at 23:09:16.470195 after 2.01 seconds
[0m23:09:16.471230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0270B9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F02665ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F028AA4320>]}
[0m23:09:16.471230 [debug] [MainThread]: Flushing usage events
[0m23:11:11.829309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001369C65FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001369E852E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001369B844410>]}


============================== 23:11:11.833347 | aa99ba68-8fe2-441b-a541-5dafcc5b5a92 ==============================
[0m23:11:11.833347 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:11:11.833347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m23:11:11.955093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa99ba68-8fe2-441b-a541-5dafcc5b5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001369EC8FB00>]}
[0m23:11:11.977220 [debug] [MainThread]: Command `dbt clean` succeeded at 23:11:11.977220 after 0.33 seconds
[0m23:11:11.978654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001369C65FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001369F194830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001369EC64740>]}
[0m23:11:11.979677 [debug] [MainThread]: Flushing usage events
[0m23:11:16.106052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAD4E12B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FACFF9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FACE0B380>]}


============================== 23:11:16.108256 | 9aeeb571-d522-4a96-bf32-3519cdf7232b ==============================
[0m23:11:16.108256 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:11:16.108256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:11:16.304771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9aeeb571-d522-4a96-bf32-3519cdf7232b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FADB602F0>]}
[0m23:11:16.355968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9aeeb571-d522-4a96-bf32-3519cdf7232b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FADA13C80>]}
[0m23:11:16.355968 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:11:16.366110 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:11:16.371160 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:11:16.371160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9aeeb571-d522-4a96-bf32-3519cdf7232b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAB4D4080>]}
[0m23:11:17.356507 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj.bonanalyse_prof_details' (models\example\bonanalyse_prof_details.sql) depends on a source named 'SC1.p_film' which was not found
[0m23:11:17.356507 [debug] [MainThread]: Command `dbt run` failed at 23:11:17.356507 after 1.37 seconds
[0m23:11:17.356507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAD4E12B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FADFF6FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FAF22D490>]}
[0m23:11:17.356507 [debug] [MainThread]: Flushing usage events
[0m23:11:17.652494 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m23:12:43.835812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001618D80F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001618A0319A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001618C98B2C0>]}


============================== 23:12:43.839941 | acd5f944-9dfc-49e6-bfbc-736752eef577 ==============================
[0m23:12:43.839941 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:12:43.839941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:12:43.978392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acd5f944-9dfc-49e6-bfbc-736752eef577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001618FE3F8F0>]}
[0m23:12:44.003251 [debug] [MainThread]: Command `dbt clean` succeeded at 23:12:44.003251 after 0.34 seconds
[0m23:12:44.003251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001618F17ADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001619073F200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001618F9E9C70>]}
[0m23:12:44.003251 [debug] [MainThread]: Flushing usage events
[0m23:12:48.316098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5D7E3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5FE40170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A606DB440>]}


============================== 23:12:48.327253 | 496d6deb-7712-4ef8-8985-2c0bb3b42133 ==============================
[0m23:12:48.327253 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:12:48.327253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:12:48.495848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '496d6deb-7712-4ef8-8985-2c0bb3b42133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5D5EE5A0>]}
[0m23:12:48.557646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '496d6deb-7712-4ef8-8985-2c0bb3b42133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A60733C80>]}
[0m23:12:48.557646 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:12:48.568384 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:12:48.569596 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:12:48.570101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '496d6deb-7712-4ef8-8985-2c0bb3b42133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5FDA6AE0>]}
[0m23:12:49.616102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '496d6deb-7712-4ef8-8985-2c0bb3b42133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A61E85910>]}
[0m23:12:49.702692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '496d6deb-7712-4ef8-8985-2c0bb3b42133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A61ECCAA0>]}
[0m23:12:49.702692 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m23:12:49.704101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '496d6deb-7712-4ef8-8985-2c0bb3b42133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A61E6CE60>]}
[0m23:12:49.706070 [info ] [MainThread]: 
[0m23:12:49.707078 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:49.707078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m23:12:49.794715 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m23:12:49.794715 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m23:12:49.794715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:49.836125 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.042 seconds
[0m23:12:49.836125 [debug] [ThreadPool]: On list_res: Close
[0m23:12:49.841789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m23:12:49.846030 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:12:49.846030 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m23:12:49.846030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:49.888445 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m23:12:49.889224 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:12:49.889224 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:12:49.892587 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m23:12:49.896140 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m23:12:49.896140 [debug] [ThreadPool]: On list_res_public: Close
[0m23:12:49.898535 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:49.898535 [debug] [MainThread]: On master: BEGIN
[0m23:12:49.898535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:12:49.939548 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m23:12:49.943346 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:49.943891 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:12:49.945935 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m23:12:49.945935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '496d6deb-7712-4ef8-8985-2c0bb3b42133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A60CE6750>]}
[0m23:12:49.945935 [debug] [MainThread]: On master: ROLLBACK
[0m23:12:49.945935 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:49.945935 [debug] [MainThread]: On master: BEGIN
[0m23:12:49.952985 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:12:49.952985 [debug] [MainThread]: On master: COMMIT
[0m23:12:49.952985 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:49.952985 [debug] [MainThread]: On master: COMMIT
[0m23:12:49.952985 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:12:49.952985 [debug] [MainThread]: On master: Close
[0m23:12:49.955996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:12:49.955996 [info ] [MainThread]: 
[0m23:12:49.959544 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m23:12:49.959544 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m23:12:49.962284 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m23:12:49.963342 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m23:12:49.972393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:12:49.974534 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m23:12:50.019992 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:12:50.019992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:12:50.022928 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m23:12:50.022928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:12:50.063921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:12:50.063921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:12:50.064976 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse AS (
    SELECT * 
    FROM "res"."SC_App1"."bonanalyse"
),
membreexterne AS (
    SELECT * 
    FROM "res"."SC_App1"."membreexterne"
),
detailfaculteecoleprofesseur AS (
    SELECT * 
    FROM "res"."SC_App1"."detailfaculteecoleprofesseur"
),
faculteecole AS (
    SELECT * 
    FROM "res"."SC_App1"."faculteecole"
),
etablissementuniversitaire AS (
    SELECT * 
    FROM "res"."SC_App1"."etablissementuniversitaire"
)

-- Main Query
SELECT 
    b.idBonAnalyse, 
    b.dateCreation, 
    b.dateStatut, 
    b.isActuel, 
    b.montantInitial, 
    b.numeroBA, 
    eu.nom AS etablissement_universitaire_nom,
    me.nom AS membreexterne_nom,
    me.prenom AS membreexterne_prenom,
    fac.nom AS faculteecole_nom
FROM 
    bonanalyse b
INNER JOIN 
    membreexterne me ON b.idProfesseur = me.idMembreExterne
INNER JOIN 
    detailfaculteecoleprofesseur dfac ON me.idMembreExterne = dfac.idProfesseur
INNER JOIN 
    faculteecole fac ON dfac.idFaculteEcole = fac.idFaculteEcole
INNER JOIN 
    etablissementuniversitaire eu ON fac.idEtablissementUniversitaire = eu.idEtablissementUniversitaire
WHERE 
    b.idProfesseur IS NOT NULL 
    AND dfac.idFaculteEcole IS NOT NULL
  );
  
[0m23:12:50.066166 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne b.idprofesseur n'existe pas
LINE 48:     membreexterne me ON b.idProfesseur = me.idMembreExterne
                                 ^
HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».

[0m23:12:50.067074 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m23:12:50.067074 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m23:12:50.074074 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la colonne b.idprofesseur n'existe pas
  LINE 48:     membreexterne me ON b.idProfesseur = me.idMembreExterne
                                   ^
  HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:12:50.074579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '496d6deb-7712-4ef8-8985-2c0bb3b42133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A607D5640>]}
[0m23:12:50.076229 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.11s]
[0m23:12:50.077282 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m23:12:50.077282 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:50.077282 [debug] [MainThread]: On master: BEGIN
[0m23:12:50.080677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:12:50.120251 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m23:12:50.120251 [debug] [MainThread]: On master: COMMIT
[0m23:12:50.120251 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:50.120251 [debug] [MainThread]: On master: COMMIT
[0m23:12:50.120251 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:12:50.122590 [debug] [MainThread]: On master: Close
[0m23:12:50.122590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:50.123824 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m23:12:50.124422 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m23:12:50.124422 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m23:12:50.125990 [info ] [MainThread]: 
[0m23:12:50.127185 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m23:12:50.129306 [debug] [MainThread]: Command end result
[0m23:12:50.204091 [info ] [MainThread]: 
[0m23:12:50.204091 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:12:50.206169 [info ] [MainThread]: 
[0m23:12:50.206677 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la colonne b.idprofesseur n'existe pas
  LINE 48:     membreexterne me ON b.idProfesseur = me.idMembreExterne
                                   ^
  HINT:  Peut-être que vous souhaitiez référencer la colonne « b.idProfesseur ».
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m23:12:50.207677 [info ] [MainThread]: 
[0m23:12:50.209282 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:12:50.211644 [debug] [MainThread]: Command `dbt run` failed at 23:12:50.210289 after 2.00 seconds
[0m23:12:50.211644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5FB76CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A61E5CE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A61F4C950>]}
[0m23:12:50.211644 [debug] [MainThread]: Flushing usage events
[0m23:46:18.381602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019971E497F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001996ECB7CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019972978EF0>]}


============================== 23:46:18.386833 | 0b16d358-1fdb-4947-9a0e-6a85126d4d9e ==============================
[0m23:46:18.386833 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:46:18.388230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:46:18.529505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b16d358-1fdb-4947-9a0e-6a85126d4d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199726AF860>]}
[0m23:46:18.569707 [debug] [MainThread]: Command `dbt clean` succeeded at 23:46:18.568159 after 0.36 seconds
[0m23:46:18.570716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019972210950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199726AF860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019972716C30>]}
[0m23:46:18.571720 [debug] [MainThread]: Flushing usage events
[0m23:48:18.968163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146DE34F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146FD52FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214707E12B0>]}


============================== 23:48:18.970332 | c364ee9a-d800-41f7-98aa-069822bc8e73 ==============================
[0m23:48:18.970332 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:48:18.970332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m23:48:19.289341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c364ee9a-d800-41f7-98aa-069822bc8e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214704E3E30>]}
[0m23:48:19.381817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c364ee9a-d800-41f7-98aa-069822bc8e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021470819130>]}
[0m23:48:19.381817 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:48:19.404723 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:48:19.407288 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:48:19.409359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c364ee9a-d800-41f7-98aa-069822bc8e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021470ADD550>]}
[0m23:48:21.369498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c364ee9a-d800-41f7-98aa-069822bc8e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021472224B90>]}
[0m23:48:21.529455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c364ee9a-d800-41f7-98aa-069822bc8e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002147218F140>]}
[0m23:48:21.529455 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m23:48:21.529455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c364ee9a-d800-41f7-98aa-069822bc8e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021471096AB0>]}
[0m23:48:21.529455 [info ] [MainThread]: 
[0m23:48:21.538044 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:48:21.541007 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m23:48:21.689277 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m23:48:21.689277 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m23:48:21.689277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:21.802345 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.104 seconds
[0m23:48:21.806614 [debug] [ThreadPool]: On list_res: Close
[0m23:48:21.809514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m23:48:21.819171 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:48:21.819171 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m23:48:21.823240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:21.889060 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m23:48:21.889060 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m23:48:21.889060 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:48:21.899469 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m23:48:21.899469 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m23:48:21.899469 [debug] [ThreadPool]: On list_res_public: Close
[0m23:48:21.914269 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:21.914269 [debug] [MainThread]: On master: BEGIN
[0m23:48:21.914269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:48:21.979202 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m23:48:21.979202 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:21.979202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:48:21.993802 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:48:21.998471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c364ee9a-d800-41f7-98aa-069822bc8e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021472196BA0>]}
[0m23:48:21.999017 [debug] [MainThread]: On master: ROLLBACK
[0m23:48:22.000069 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:22.001462 [debug] [MainThread]: On master: BEGIN
[0m23:48:22.001462 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:48:22.004712 [debug] [MainThread]: On master: COMMIT
[0m23:48:22.006954 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:22.008081 [debug] [MainThread]: On master: COMMIT
[0m23:48:22.009101 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:48:22.011499 [debug] [MainThread]: On master: Close
[0m23:48:22.011499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:48:22.015584 [info ] [MainThread]: 
[0m23:48:22.023267 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m23:48:22.024638 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m23:48:22.026909 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m23:48:22.026909 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m23:48:22.043239 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:48:22.049373 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m23:48:22.145322 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m23:48:22.149946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:48:22.149946 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m23:48:22.152413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:48:22.227472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m23:48:22.229113 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:48:22.229113 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    -- This model combines details from multiple tables to provide comprehensive information about BonAnalyse records
WITH bonanalyse_data AS (
    SELECT 
        b."idBonAnalyse", 
        b."dateCreation", 
        b."dateStatut", 
        b."isActuel", 
        b."montantInitial", 
        b."numeroBA", 
        eu.nom AS etablissement_universitaire_nom,
        me.nom AS membreexterne_nom,
        me.prenom AS membreexterne_prenom,
        fac.nom AS faculteecole_nom
    FROM 
        "res"."SC_App1"."bonanalyse" b
    INNER JOIN 
        "res"."SC_App1"."membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
    INNER JOIN 
        "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
    INNER JOIN 
        "res"."SC_App1"."faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
    INNER JOIN 
        "res"."SC_App1"."etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
    WHERE 
        b."idProfesseur" IS NOT NULL 
        AND dfac."idFaculteEcole" IS NOT NULL
)
SELECT * FROM bonanalyse_data
  );
  
[0m23:48:22.244101 [debug] [Thread-1 (]: SQL status: SELECT 80 in 0.016 seconds
[0m23:48:22.309361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:48:22.314456 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details__dbt_tmp" rename to "bonanalyse_prof_details"
[0m23:48:22.315698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:48:22.352769 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m23:48:22.352769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:48:22.352769 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m23:48:22.355728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:48:22.369291 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."bonanalyse_prof_details__dbt_backup"
[0m23:48:22.387153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m23:48:22.389188 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
drop table if exists "res"."public"."bonanalyse_prof_details__dbt_backup" cascade
[0m23:48:22.389188 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:48:22.393615 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m23:48:22.399249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c364ee9a-d800-41f7-98aa-069822bc8e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214700F8C20>]}
[0m23:48:22.399249 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.bonanalyse_prof_details ............... [[32mSELECT 80[0m in 0.37s]
[0m23:48:22.403110 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m23:48:22.408307 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:22.409429 [debug] [MainThread]: On master: BEGIN
[0m23:48:22.411350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:48:22.499202 [debug] [MainThread]: SQL status: BEGIN in 0.091 seconds
[0m23:48:22.499202 [debug] [MainThread]: On master: COMMIT
[0m23:48:22.499202 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:22.499202 [debug] [MainThread]: On master: COMMIT
[0m23:48:22.505698 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:48:22.505698 [debug] [MainThread]: On master: Close
[0m23:48:22.507410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:22.508923 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m23:48:22.510025 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m23:48:22.510025 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m23:48:22.512587 [info ] [MainThread]: 
[0m23:48:22.515295 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m23:48:22.517924 [debug] [MainThread]: Command end result
[0m23:48:22.582175 [info ] [MainThread]: 
[0m23:48:22.582175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:22.582175 [info ] [MainThread]: 
[0m23:48:22.590877 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:48:22.595977 [debug] [MainThread]: Command `dbt run` succeeded at 23:48:22.594694 after 3.88 seconds
[0m23:48:22.595977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146DE34F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021472119970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146FC6B410>]}
[0m23:48:22.595977 [debug] [MainThread]: Flushing usage events
[0m00:04:53.145165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1DCF8FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1D1A0F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1D1A1CA0>]}


============================== 00:04:53.160984 | 3668e188-2d33-4c4b-a9a2-ac5b6f57b652 ==============================
[0m00:04:53.160984 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:04:53.162159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:04:53.422977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3668e188-2d33-4c4b-a9a2-ac5b6f57b652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1DCFB440>]}
[0m00:04:53.491025 [debug] [MainThread]: Command `dbt clean` succeeded at 00:04:53.491025 after 0.72 seconds
[0m00:04:53.494559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1B8D47A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1DFDF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1DCF8FE0>]}
[0m00:04:53.497112 [debug] [MainThread]: Flushing usage events
[0m00:05:05.566281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6B4C66C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6A932FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6B4C6750>]}


============================== 00:05:05.574194 | 474591ea-ef19-4a55-a045-6f3acb4e9009 ==============================
[0m00:05:05.574194 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:05:05.576950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:05:06.167815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '474591ea-ef19-4a55-a045-6f3acb4e9009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6B67AF60>]}
[0m00:05:06.330585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '474591ea-ef19-4a55-a045-6f3acb4e9009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6B542930>]}
[0m00:05:06.333782 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:05:06.373615 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:05:06.377872 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:05:06.378465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '474591ea-ef19-4a55-a045-6f3acb4e9009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6B81CBC0>]}
[0m00:05:09.570366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '474591ea-ef19-4a55-a045-6f3acb4e9009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6CEAA360>]}
[0m00:05:09.755806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '474591ea-ef19-4a55-a045-6f3acb4e9009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6B8914F0>]}
[0m00:05:09.756960 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m00:05:09.758839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '474591ea-ef19-4a55-a045-6f3acb4e9009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6CD0EE70>]}
[0m00:05:09.762854 [info ] [MainThread]: 
[0m00:05:09.764975 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:05:09.766240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m00:05:09.967219 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m00:05:09.968434 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m00:05:09.969605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:10.074416 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.105 seconds
[0m00:05:10.074416 [debug] [ThreadPool]: On list_res: Close
[0m00:05:10.134793 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m00:05:10.159166 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m00:05:10.161011 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m00:05:10.162148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:10.250257 [debug] [ThreadPool]: SQL status: BEGIN in 0.088 seconds
[0m00:05:10.251484 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m00:05:10.252799 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:05:10.262781 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m00:05:10.266013 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m00:05:10.267043 [debug] [ThreadPool]: On list_res_public: Close
[0m00:05:10.278085 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:10.279535 [debug] [MainThread]: On master: BEGIN
[0m00:05:10.280134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:05:10.367985 [debug] [MainThread]: SQL status: BEGIN in 0.091 seconds
[0m00:05:10.367985 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:10.373844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:05:10.385159 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m00:05:10.387997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '474591ea-ef19-4a55-a045-6f3acb4e9009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6D49D310>]}
[0m00:05:10.389084 [debug] [MainThread]: On master: ROLLBACK
[0m00:05:10.390830 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:10.392039 [debug] [MainThread]: On master: BEGIN
[0m00:05:10.393648 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:05:10.395254 [debug] [MainThread]: On master: COMMIT
[0m00:05:10.396953 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:10.398179 [debug] [MainThread]: On master: COMMIT
[0m00:05:10.400025 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:05:10.401094 [debug] [MainThread]: On master: Close
[0m00:05:10.403303 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:05:10.405171 [info ] [MainThread]: 
[0m00:05:10.414916 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m00:05:10.416808 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m00:05:10.419681 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m00:05:10.421000 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m00:05:10.445175 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m00:05:10.448419 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m00:05:10.562457 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m00:05:10.567551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m00:05:10.569267 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m00:05:10.571691 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:05:10.672717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.101 seconds
[0m00:05:10.674453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m00:05:10.676202 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    -- This model combines details from multiple tables to provide comprehensive information about BonAnalyse records
WITH bonanalyse_data AS (
    SELECT DISTINCT
        b."idBonAnalyse", 
        b."dateCreation", 
        b."dateStatut", 
        b."isActuel", 
        b."montantInitial", 
        b."numeroBA", 
        eu.nom AS etablissement_universitaire_nom,
        me.nom AS membreexterne_nom,
        me.prenom AS membreexterne_prenom,
        fac.nom AS faculteecole_nom
    FROM 
        "res"."SC_App1"."bonanalyse" b
    INNER JOIN 
        "res"."SC_App1"."membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
    INNER JOIN 
        "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
    INNER JOIN 
        "res"."SC_App1"."faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
    INNER JOIN 
        "res"."SC_App1"."etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
    WHERE 
        b."idProfesseur" IS NOT NULL 
        AND dfac."idFaculteEcole" IS NOT NULL
)
SELECT * FROM bonanalyse_data
  );
  
[0m00:05:10.708272 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.030 seconds
[0m00:05:10.796532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m00:05:10.798161 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details" rename to "bonanalyse_prof_details__dbt_backup"
[0m00:05:10.802820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:05:10.812107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m00:05:10.813780 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details__dbt_tmp" rename to "bonanalyse_prof_details"
[0m00:05:10.816325 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:05:10.892706 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m00:05:10.894365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m00:05:10.895448 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m00:05:10.898794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:05:10.917346 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."bonanalyse_prof_details__dbt_backup"
[0m00:05:10.934168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m00:05:10.935790 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
drop table if exists "res"."public"."bonanalyse_prof_details__dbt_backup" cascade
[0m00:05:10.943191 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m00:05:10.950685 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m00:05:10.954580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '474591ea-ef19-4a55-a045-6f3acb4e9009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6D529520>]}
[0m00:05:10.956237 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.bonanalyse_prof_details ............... [[32mSELECT 10[0m in 0.53s]
[0m00:05:10.960024 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m00:05:10.963654 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:10.965460 [debug] [MainThread]: On master: BEGIN
[0m00:05:10.966512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:05:11.063173 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m00:05:11.064311 [debug] [MainThread]: On master: COMMIT
[0m00:05:11.065604 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:11.067248 [debug] [MainThread]: On master: COMMIT
[0m00:05:11.069019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:05:11.070203 [debug] [MainThread]: On master: Close
[0m00:05:11.072063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:05:11.073248 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m00:05:11.074340 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m00:05:11.075404 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m00:05:11.076950 [info ] [MainThread]: 
[0m00:05:11.079606 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m00:05:11.083420 [debug] [MainThread]: Command end result
[0m00:05:11.190115 [info ] [MainThread]: 
[0m00:05:11.192585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:05:11.194705 [info ] [MainThread]: 
[0m00:05:11.196874 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:05:11.201259 [debug] [MainThread]: Command `dbt run` succeeded at 00:05:11.201075 after 5.95 seconds
[0m00:05:11.202928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6D363500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6B14C6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC6D3F9520>]}
[0m00:05:11.204072 [debug] [MainThread]: Flushing usage events
[0m01:03:36.403524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E1886CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E1B035730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E1ABAB5F0>]}


============================== 01:03:36.413276 | 2c015d7a-a4f2-4981-b3b8-fc2c0edb24a2 ==============================
[0m01:03:36.413276 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:03:36.415057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:03:36.706366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c015d7a-a4f2-4981-b3b8-fc2c0edb24a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E18EA4710>]}
[0m01:03:36.795305 [debug] [MainThread]: Command `dbt clean` succeeded at 01:03:36.795305 after 0.76 seconds
[0m01:03:36.796394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E1A036FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E1B504830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E1B3FE330>]}
[0m01:03:36.796394 [debug] [MainThread]: Flushing usage events
[0m01:03:46.031013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E019D5A6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E019040890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01956BFE0>]}


============================== 01:03:46.042635 | f109967f-206c-45a6-9839-b437e49d7553 ==============================
[0m01:03:46.042635 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:03:46.045325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m01:03:46.553882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f109967f-206c-45a6-9839-b437e49d7553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01A04B2F0>]}
[0m01:03:46.748035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f109967f-206c-45a6-9839-b437e49d7553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E017AA0950>]}
[0m01:03:46.752464 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:03:46.781492 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:03:46.784015 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:03:46.786583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f109967f-206c-45a6-9839-b437e49d7553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01A1176B0>]}
[0m01:03:50.480271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f109967f-206c-45a6-9839-b437e49d7553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E018E53020>]}
[0m01:03:50.807665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f109967f-206c-45a6-9839-b437e49d7553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01B7CF4A0>]}
[0m01:03:50.811682 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:03:50.814697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f109967f-206c-45a6-9839-b437e49d7553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01A5E6660>]}
[0m01:03:50.816214 [info ] [MainThread]: 
[0m01:03:50.822775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:03:50.826324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:03:51.131891 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:03:51.134540 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:03:51.136613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:51.250828 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.115 seconds
[0m01:03:51.254693 [debug] [ThreadPool]: On list_res: Close
[0m01:03:51.259608 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:03:51.286303 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:03:51.287994 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:03:51.287994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:51.380961 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m01:03:51.386573 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:03:51.387650 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:03:51.396549 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m01:03:51.402896 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:03:51.402896 [debug] [ThreadPool]: On list_res_public: Close
[0m01:03:51.416364 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:51.419421 [debug] [MainThread]: On master: BEGIN
[0m01:03:51.420681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:03:51.526263 [debug] [MainThread]: SQL status: BEGIN in 0.105 seconds
[0m01:03:51.527279 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:51.528607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:03:51.537676 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m01:03:51.543703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f109967f-206c-45a6-9839-b437e49d7553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01B6EEDE0>]}
[0m01:03:51.545517 [debug] [MainThread]: On master: ROLLBACK
[0m01:03:51.546556 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:51.546556 [debug] [MainThread]: On master: BEGIN
[0m01:03:51.546556 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:03:51.546556 [debug] [MainThread]: On master: COMMIT
[0m01:03:51.551796 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:51.553221 [debug] [MainThread]: On master: COMMIT
[0m01:03:51.553221 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:03:51.556246 [debug] [MainThread]: On master: Close
[0m01:03:51.557829 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:03:51.559842 [info ] [MainThread]: 
[0m01:03:51.569171 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:03:51.571386 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:03:51.575570 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:03:51.576086 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:03:51.594868 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:03:51.601894 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:03:51.713288 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:03:51.716308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:03:51.716308 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:03:51.716308 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:03:51.812707 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m01:03:51.814319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:03:51.815428 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    -- This model combines details from multiple tables to provide comprehensive information about BonAnalyse records
WITH bonanalyse_data AS (
    SELECT DISTINCT
        b."idBonAnalyse", 
        b."dateCreation", 
        b."dateStatut", 
        b."isActuel", 
        b."montantInitial", 
        b."numeroBA", 
        eu.nom AS etablissement_universitaire_nom,
        concat(me.nom, ' ', me.prenom) AS professeur,
        me.email,
		concat(fac.nom, ' - ', eu.nom) AS faculteecole_nom,
        me.cin AS cin
    FROM 
        "bonanalyse" b
    INNER JOIN 
        "membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
    INNER JOIN 
        "detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
    INNER JOIN 
        "faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
    INNER JOIN 
        "etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
    WHERE 
        b."idProfesseur" IS NOT NULL 
        AND dfac."idFaculteEcole" IS NOT NULL;
)
SELECT * FROM bonanalyse_data
  );
  
[0m01:03:51.817669 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 38:         AND dfac."idFaculteEcole" IS NOT NULL;
                                                      ^

[0m01:03:51.819406 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m01:03:51.819406 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:03:51.851408 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 38:         AND dfac."idFaculteEcole" IS NOT NULL;
                                                        ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:03:51.856420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f109967f-206c-45a6-9839-b437e49d7553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01BF1E5D0>]}
[0m01:03:51.858169 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.28s]
[0m01:03:51.862538 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:03:51.866555 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:51.868638 [debug] [MainThread]: On master: BEGIN
[0m01:03:51.868638 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:03:51.966452 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m01:03:51.966452 [debug] [MainThread]: On master: COMMIT
[0m01:03:51.966452 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:51.966452 [debug] [MainThread]: On master: COMMIT
[0m01:03:51.966452 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:03:51.966452 [debug] [MainThread]: On master: Close
[0m01:03:51.974466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:51.976380 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:03:51.977499 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:03:51.977499 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:03:51.980159 [info ] [MainThread]: 
[0m01:03:51.982682 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m01:03:51.986283 [debug] [MainThread]: Command end result
[0m01:03:52.151580 [info ] [MainThread]: 
[0m01:03:52.151580 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:03:52.155607 [info ] [MainThread]: 
[0m01:03:52.156163 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 38:         AND dfac."idFaculteEcole" IS NOT NULL;
                                                        ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:03:52.161198 [info ] [MainThread]: 
[0m01:03:52.162725 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:03:52.167416 [debug] [MainThread]: Command `dbt run` failed at 01:03:52.166395 after 7.17 seconds
[0m01:03:52.167416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E019D5A6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E017B366F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E017B375F0>]}
[0m01:03:52.171729 [debug] [MainThread]: Flushing usage events
[0m01:04:09.334005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA06697C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA0A34980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA0668380>]}


============================== 01:04:09.336661 | 1c7d78ee-90b6-459a-8d1d-482254a23feb ==============================
[0m01:04:09.336661 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:04:09.341206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:04:09.701029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c7d78ee-90b6-459a-8d1d-482254a23feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA0FE7F20>]}
[0m01:04:09.811140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c7d78ee-90b6-459a-8d1d-482254a23feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E9FFDF260>]}
[0m01:04:09.811140 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:04:09.832254 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:04:10.122975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:04:10.122975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:04:10.192741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c7d78ee-90b6-459a-8d1d-482254a23feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA116B4D0>]}
[0m01:04:10.357767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c7d78ee-90b6-459a-8d1d-482254a23feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA270A2D0>]}
[0m01:04:10.366891 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:04:10.368566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c7d78ee-90b6-459a-8d1d-482254a23feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA0F815B0>]}
[0m01:04:10.375144 [info ] [MainThread]: 
[0m01:04:10.384882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:04:10.388332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:04:10.606514 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:04:10.606514 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:04:10.609059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:10.706559 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.096 seconds
[0m01:04:10.709341 [debug] [ThreadPool]: On list_res: Close
[0m01:04:10.712148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:04:10.728237 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:04:10.729856 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:04:10.731567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:10.847320 [debug] [ThreadPool]: SQL status: BEGIN in 0.115 seconds
[0m01:04:10.847320 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:04:10.847320 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:04:10.856574 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m01:04:10.866232 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:04:10.867341 [debug] [ThreadPool]: On list_res_public: Close
[0m01:04:10.881084 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:10.881084 [debug] [MainThread]: On master: BEGIN
[0m01:04:10.881084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:04:10.990037 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m01:04:10.990037 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:10.994429 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:04:11.006326 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m01:04:11.010911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c7d78ee-90b6-459a-8d1d-482254a23feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA2C4CC20>]}
[0m01:04:11.013485 [debug] [MainThread]: On master: ROLLBACK
[0m01:04:11.013485 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:11.016666 [debug] [MainThread]: On master: BEGIN
[0m01:04:11.019184 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:04:11.019753 [debug] [MainThread]: On master: COMMIT
[0m01:04:11.021611 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:11.023245 [debug] [MainThread]: On master: COMMIT
[0m01:04:11.024377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:04:11.026398 [debug] [MainThread]: On master: Close
[0m01:04:11.027411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:04:11.030089 [info ] [MainThread]: 
[0m01:04:11.041879 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:04:11.043152 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:04:11.047174 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:04:11.050393 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:04:11.071620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:04:11.073016 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:04:11.203444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:04:11.219821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:04:11.219821 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:04:11.223347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:04:11.329505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.108 seconds
[0m01:04:11.334081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:04:11.336107 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    -- This model combines details from multiple tables to provide comprehensive information about BonAnalyse records
WITH bonanalyse_data AS (
    SELECT DISTINCT
        b."idBonAnalyse", 
        b."dateCreation", 
        b."dateStatut", 
        b."isActuel", 
        b."montantInitial", 
        b."numeroBA", 
        eu.nom AS etablissement_universitaire_nom,
        concat(me.nom, ' ', me.prenom) AS professeur,
        me.email,
		concat(fac.nom, ' - ', eu.nom) AS faculteecole_nom,
        me.cin AS cin
    FROM 
        "bonanalyse" b
    INNER JOIN 
        "membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
    INNER JOIN 
        "detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
    INNER JOIN 
        "faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
    INNER JOIN 
        "etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
    WHERE 
        b."idProfesseur" IS NOT NULL 
        AND dfac."idFaculteEcole" IS NOT NULL;
)
SELECT * FROM bonanalyse_data
  );
  
[0m01:04:11.337746 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 38:         AND dfac."idFaculteEcole" IS NOT NULL;
                                                      ^

[0m01:04:11.340106 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m01:04:11.340654 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:04:11.357061 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 38:         AND dfac."idFaculteEcole" IS NOT NULL;
                                                        ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:04:11.357061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c7d78ee-90b6-459a-8d1d-482254a23feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA0668BF0>]}
[0m01:04:11.363285 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.31s]
[0m01:04:11.366468 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:04:11.371562 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:11.371562 [debug] [MainThread]: On master: BEGIN
[0m01:04:11.371562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:04:11.481657 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m01:04:11.483824 [debug] [MainThread]: On master: COMMIT
[0m01:04:11.484376 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:11.484376 [debug] [MainThread]: On master: COMMIT
[0m01:04:11.486499 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:04:11.487513 [debug] [MainThread]: On master: Close
[0m01:04:11.487513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:11.487513 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:04:11.487513 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:04:11.487513 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:04:11.487513 [info ] [MainThread]: 
[0m01:04:11.495620 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m01:04:11.497191 [debug] [MainThread]: Command end result
[0m01:04:11.557199 [info ] [MainThread]: 
[0m01:04:11.559097 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:04:11.560706 [info ] [MainThread]: 
[0m01:04:11.563132 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 38:         AND dfac."idFaculteEcole" IS NOT NULL;
                                                        ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:04:11.566426 [info ] [MainThread]: 
[0m01:04:11.568868 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:04:11.569982 [debug] [MainThread]: Command `dbt run` failed at 01:04:11.569982 after 2.48 seconds
[0m01:04:11.569982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA0A34980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA0D89160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA2585C40>]}
[0m01:04:11.569982 [debug] [MainThread]: Flushing usage events
[0m01:04:29.929348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA24A7DEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA21A72F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA24A7C230>]}


============================== 01:04:29.936465 | 7895cf07-5eb3-4b3a-932b-c4395cf75dfb ==============================
[0m01:04:29.936465 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:04:29.937644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:04:30.298307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7895cf07-5eb3-4b3a-932b-c4395cf75dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA2531ABA0>]}
[0m01:04:30.432700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7895cf07-5eb3-4b3a-932b-c4395cf75dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA2536B260>]}
[0m01:04:30.436290 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:04:30.454721 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:04:30.798326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:04:30.798326 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\bonanalyse_prof_details.sql
[0m01:04:31.314463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7895cf07-5eb3-4b3a-932b-c4395cf75dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA26B42480>]}
[0m01:04:31.479642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7895cf07-5eb3-4b3a-932b-c4395cf75dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA26C205F0>]}
[0m01:04:31.484331 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:04:31.486538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7895cf07-5eb3-4b3a-932b-c4395cf75dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA25948530>]}
[0m01:04:31.490929 [info ] [MainThread]: 
[0m01:04:31.491767 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:04:31.494451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:04:31.663550 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:04:31.664091 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:04:31.664091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:31.741872 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.077 seconds
[0m01:04:31.743193 [debug] [ThreadPool]: On list_res: Close
[0m01:04:31.747901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:04:31.757676 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:04:31.757676 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:04:31.757676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:31.842655 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m01:04:31.844629 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:04:31.846140 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:04:31.852604 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m01:04:31.856353 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:04:31.856353 [debug] [ThreadPool]: On list_res_public: Close
[0m01:04:31.868323 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:31.868878 [debug] [MainThread]: On master: BEGIN
[0m01:04:31.868878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:04:31.940754 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m01:04:31.943267 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:31.943267 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:04:31.954175 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m01:04:31.956853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7895cf07-5eb3-4b3a-932b-c4395cf75dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA26C399D0>]}
[0m01:04:31.956963 [debug] [MainThread]: On master: ROLLBACK
[0m01:04:31.958114 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:31.959506 [debug] [MainThread]: On master: BEGIN
[0m01:04:31.960681 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:04:31.961691 [debug] [MainThread]: On master: COMMIT
[0m01:04:31.961691 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:31.961691 [debug] [MainThread]: On master: COMMIT
[0m01:04:31.961691 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:04:31.961691 [debug] [MainThread]: On master: Close
[0m01:04:31.967301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:04:31.968982 [info ] [MainThread]: 
[0m01:04:31.974822 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:04:31.977365 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:04:31.977365 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:04:31.977365 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:04:31.991820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:04:31.996333 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:04:32.086038 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:04:32.086038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:04:32.089111 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:04:32.090204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:04:32.162697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m01:04:32.164526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:04:32.164526 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    -- This model combines details from multiple tables to provide comprehensive information about BonAnalyse records
WITH bonanalyse_data AS (
    SELECT DISTINCT
        b."idBonAnalyse", 
        b."dateCreation", 
        b."dateStatut", 
        b."isActuel", 
        b."montantInitial", 
        b."numeroBA", 
        eu.nom AS etablissement_universitaire_nom,
        concat(me.nom, ' ', me.prenom) AS professeur,
        me.email,
		concat(fac.nom, ' - ', eu.nom) AS faculteecole_nom,
        me.cin AS cin
    FROM 
        "bonanalyse" b
    INNER JOIN 
        "membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
    INNER JOIN 
        "detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
    INNER JOIN 
        "faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
    INNER JOIN 
        "etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
    WHERE 
        b."idProfesseur" IS NOT NULL 
        AND dfac."idFaculteEcole" IS NOT NULL
)
SELECT * FROM bonanalyse_data
  );
  
[0m01:04:32.166034 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « bonanalyse » n'existe pas
LINE 27:         "bonanalyse" b
                 ^

[0m01:04:32.166034 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m01:04:32.166034 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:04:32.180461 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la relation « bonanalyse » n'existe pas
  LINE 27:         "bonanalyse" b
                   ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:04:32.185020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7895cf07-5eb3-4b3a-932b-c4395cf75dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA24A7CA40>]}
[0m01:04:32.186239 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.21s]
[0m01:04:32.188090 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:04:32.190488 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:32.193551 [debug] [MainThread]: On master: BEGIN
[0m01:04:32.193551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:04:32.304919 [debug] [MainThread]: SQL status: BEGIN in 0.112 seconds
[0m01:04:32.307507 [debug] [MainThread]: On master: COMMIT
[0m01:04:32.308020 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:32.309123 [debug] [MainThread]: On master: COMMIT
[0m01:04:32.309123 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:04:32.309123 [debug] [MainThread]: On master: Close
[0m01:04:32.309123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:32.309123 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:04:32.309123 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:04:32.309123 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:04:32.317209 [info ] [MainThread]: 
[0m01:04:32.318221 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m01:04:32.319671 [debug] [MainThread]: Command end result
[0m01:04:32.420945 [info ] [MainThread]: 
[0m01:04:32.423961 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:04:32.425993 [info ] [MainThread]: 
[0m01:04:32.429260 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la relation « bonanalyse » n'existe pas
  LINE 27:         "bonanalyse" b
                   ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:04:32.432273 [info ] [MainThread]: 
[0m01:04:32.433796 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:04:32.437502 [debug] [MainThread]: Command `dbt run` failed at 01:04:32.437502 after 2.75 seconds
[0m01:04:32.442353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA21A72F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA26B61760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA24EF4B30>]}
[0m01:04:32.444078 [debug] [MainThread]: Flushing usage events
[0m01:05:59.771846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C644C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C646690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C6466C0>]}


============================== 01:05:59.780041 | cd1abfba-74de-4be6-9c92-47b424a864d7 ==============================
[0m01:05:59.780041 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:05:59.784110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:06:00.143926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd1abfba-74de-4be6-9c92-47b424a864d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C6C34A0>]}
[0m01:06:00.199124 [debug] [MainThread]: Command `dbt clean` succeeded at 01:06:00.199124 after 0.90 seconds
[0m01:06:00.203686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C501AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C384800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C453800>]}
[0m01:06:00.206198 [debug] [MainThread]: Flushing usage events
[0m01:06:08.149710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015780408410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157803DAFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157FD33B050>]}


============================== 01:06:08.155972 | 7393296a-9d7c-44fa-a511-6ba75769f741 ==============================
[0m01:06:08.155972 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:06:08.155972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:06:08.632095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7393296a-9d7c-44fa-a511-6ba75769f741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015780DC0B30>]}
[0m01:06:08.899537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7393296a-9d7c-44fa-a511-6ba75769f741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015780D23C80>]}
[0m01:06:08.906113 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:06:08.952543 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:06:08.956494 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:06:08.967665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7393296a-9d7c-44fa-a511-6ba75769f741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157FFCE1460>]}
[0m01:06:11.751570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7393296a-9d7c-44fa-a511-6ba75769f741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157FFB2AD50>]}
[0m01:06:11.925826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7393296a-9d7c-44fa-a511-6ba75769f741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578134BC20>]}
[0m01:06:11.927899 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:06:11.929462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7393296a-9d7c-44fa-a511-6ba75769f741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157825ABB90>]}
[0m01:06:11.933072 [info ] [MainThread]: 
[0m01:06:11.935798 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:06:11.937569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:06:12.288760 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:06:12.288760 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:06:12.288760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:12.381447 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.093 seconds
[0m01:06:12.386090 [debug] [ThreadPool]: On list_res: Close
[0m01:06:12.389893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:06:12.406188 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:06:12.406188 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:06:12.406188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:12.501857 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m01:06:12.502957 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:06:12.502957 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:06:12.512733 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m01:06:12.516016 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:06:12.516016 [debug] [ThreadPool]: On list_res_public: Close
[0m01:06:12.527135 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:12.527289 [debug] [MainThread]: On master: BEGIN
[0m01:06:12.528850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:06:12.618332 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m01:06:12.618332 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:12.623847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:06:12.636110 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m01:06:12.639684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7393296a-9d7c-44fa-a511-6ba75769f741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015782525CD0>]}
[0m01:06:12.641706 [debug] [MainThread]: On master: ROLLBACK
[0m01:06:12.643807 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:12.643807 [debug] [MainThread]: On master: BEGIN
[0m01:06:12.648358 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:06:12.649368 [debug] [MainThread]: On master: COMMIT
[0m01:06:12.650140 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:12.651152 [debug] [MainThread]: On master: COMMIT
[0m01:06:12.652569 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:06:12.653657 [debug] [MainThread]: On master: Close
[0m01:06:12.654739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:06:12.657382 [info ] [MainThread]: 
[0m01:06:12.665888 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:06:12.667063 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:06:12.671363 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:06:12.671363 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:06:12.694603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:06:12.700105 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:06:12.861504 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:06:12.867583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:06:12.872561 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:06:12.872561 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:06:12.975945 [debug] [Thread-1 (]: SQL status: BEGIN in 0.103 seconds
[0m01:06:12.977735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:06:12.977735 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    -- This model combines details from multiple tables to provide comprehensive information about BonAnalyse records
WITH bonanalyse_data AS (
    SELECT DISTINCT
        b."idBonAnalyse", 
        b."dateCreation", 
        b."dateStatut", 
        b."isActuel", 
        b."montantInitial", 
        b."numeroBA", 
        eu.nom AS etablissement_universitaire_nom,
        concat(me.nom, ' ', me.prenom) AS professeur,
        me.email,
		concat(fac.nom, ' - ', eu.nom) AS faculteecole_nom,
        me.cin AS cin
    FROM 
        "bonanalyse" b
    INNER JOIN 
        "membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
    INNER JOIN 
        "detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
    INNER JOIN 
        "faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
    INNER JOIN 
        "etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
    WHERE 
        b."idProfesseur" IS NOT NULL 
        AND dfac."idFaculteEcole" IS NOT NULL
)
SELECT * FROM bonanalyse_data
  );
  
[0m01:06:12.981255 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « bonanalyse » n'existe pas
LINE 27:         "bonanalyse" b
                 ^

[0m01:06:12.981255 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m01:06:12.985775 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:06:13.005875 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la relation « bonanalyse » n'existe pas
  LINE 27:         "bonanalyse" b
                   ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:06:13.010945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7393296a-9d7c-44fa-a511-6ba75769f741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578021A4E0>]}
[0m01:06:13.014301 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.34s]
[0m01:06:13.015906 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:06:13.023013 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:13.024798 [debug] [MainThread]: On master: BEGIN
[0m01:06:13.025827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:06:13.156025 [debug] [MainThread]: SQL status: BEGIN in 0.131 seconds
[0m01:06:13.157706 [debug] [MainThread]: On master: COMMIT
[0m01:06:13.157706 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:13.157706 [debug] [MainThread]: On master: COMMIT
[0m01:06:13.160724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:06:13.162769 [debug] [MainThread]: On master: Close
[0m01:06:13.165868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:13.166917 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:06:13.169946 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:06:13.171289 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:06:13.173588 [info ] [MainThread]: 
[0m01:06:13.173588 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m01:06:13.177219 [debug] [MainThread]: Command end result
[0m01:06:13.343359 [info ] [MainThread]: 
[0m01:06:13.348851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:06:13.349963 [info ] [MainThread]: 
[0m01:06:13.354145 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  la relation « bonanalyse » n'existe pas
  LINE 27:         "bonanalyse" b
                   ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:06:13.357183 [info ] [MainThread]: 
[0m01:06:13.357183 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:06:13.367160 [debug] [MainThread]: Command `dbt run` failed at 01:06:13.365972 after 5.52 seconds
[0m01:06:13.367160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157801BDDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015780912600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015780978E00>]}
[0m01:06:13.370679 [debug] [MainThread]: Flushing usage events
[0m01:08:09.620563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA864EE6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA88739DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA887382F0>]}


============================== 01:08:09.630696 | 37d3b796-4123-457e-b42d-96004c9fa2d2 ==============================
[0m01:08:09.630696 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:08:09.633024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:08:10.051767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37d3b796-4123-457e-b42d-96004c9fa2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA890C7860>]}
[0m01:08:10.153675 [debug] [MainThread]: Command `dbt clean` succeeded at 01:08:10.153166 after 1.05 seconds
[0m01:08:10.155437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA88B23DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA890A31A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA883935F0>]}
[0m01:08:10.156464 [debug] [MainThread]: Flushing usage events
[0m01:08:19.067844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74184B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B744EF9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B744DF92B0>]}


============================== 01:08:19.081201 | fdb41eb1-d9e8-4716-8fdd-6677a586f170 ==============================
[0m01:08:19.081201 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:08:19.081718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:08:19.737909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdb41eb1-d9e8-4716-8fdd-6677a586f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B744CF6A20>]}
[0m01:08:19.887273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdb41eb1-d9e8-4716-8fdd-6677a586f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B745193C80>]}
[0m01:08:19.887273 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:08:19.914716 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:08:19.916424 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:08:19.918590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fdb41eb1-d9e8-4716-8fdd-6677a586f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7456AF8F0>]}
[0m01:08:23.597589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdb41eb1-d9e8-4716-8fdd-6677a586f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7467626F0>]}
[0m01:08:23.979946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdb41eb1-d9e8-4716-8fdd-6677a586f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74693E0C0>]}
[0m01:08:23.987201 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:08:23.989226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdb41eb1-d9e8-4716-8fdd-6677a586f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B744F920F0>]}
[0m01:08:23.999021 [info ] [MainThread]: 
[0m01:08:24.001200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:08:24.005314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:08:24.298767 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:08:24.298767 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:08:24.298767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:24.412160 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.107 seconds
[0m01:08:24.415671 [debug] [ThreadPool]: On list_res: Close
[0m01:08:24.421529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:08:24.441975 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:08:24.445498 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:08:24.447076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:24.544620 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m01:08:24.546216 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:08:24.546733 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:08:24.559451 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m01:08:24.564461 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:08:24.565510 [debug] [ThreadPool]: On list_res_public: Close
[0m01:08:24.584356 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:24.585469 [debug] [MainThread]: On master: BEGIN
[0m01:08:24.585469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:08:24.685222 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m01:08:24.685222 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:24.685222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:08:24.700547 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m01:08:24.700547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdb41eb1-d9e8-4716-8fdd-6677a586f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7467D6F90>]}
[0m01:08:24.705563 [debug] [MainThread]: On master: ROLLBACK
[0m01:08:24.705563 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:24.709158 [debug] [MainThread]: On master: BEGIN
[0m01:08:24.710425 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:08:24.712195 [debug] [MainThread]: On master: COMMIT
[0m01:08:24.714289 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:24.715300 [debug] [MainThread]: On master: COMMIT
[0m01:08:24.718124 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:08:24.718642 [debug] [MainThread]: On master: Close
[0m01:08:24.721257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:08:24.722323 [info ] [MainThread]: 
[0m01:08:24.735492 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:08:24.735492 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:08:24.735492 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:08:24.743478 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:08:24.771341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:08:24.780227 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:08:24.935356 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:08:24.941794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:08:24.944550 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:08:24.946144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:08:25.078732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.132 seconds
[0m01:08:25.081241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:08:25.085607 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse_data AS (
              SELECT DISTINCT
                  b."idBonAnalyse", 
                  b."dateCreation", 
                  b."dateStatut", 
                  b."isActuel", 
                  b."montantInitial", 
                  b."numeroBA", 
                  eu.nom AS etablissement_universitaire_nom,
                  me.nom AS membreexterne_nom,
                  me.prenom AS membreexterne_prenom,
                  fac.nom AS faculteecole_nom
              FROM 
                  "res"."SC_App1"."bonanalyse" b
              INNER JOIN 
                  "res"."SC_App1"."membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
              INNER JOIN 
                  "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
              INNER JOIN 
                  "res"."SC_App1"."faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
              INNER JOIN 
                  "res"."SC_App1"."etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
              WHERE 
                  b."idProfesseur" IS NOT NULL 
                  AND dfac."idFaculteEcole" IS NOT NULL
          )
          SELECT * FROM bonanalyse_data;
  );
  
[0m01:08:25.088138 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 38:           SELECT * FROM bonanalyse_data;
                                                ^

[0m01:08:25.090414 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m01:08:25.092594 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:08:25.117519 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 38:           SELECT * FROM bonanalyse_data;
                                                  ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:08:25.121859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdb41eb1-d9e8-4716-8fdd-6677a586f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7447DCA40>]}
[0m01:08:25.125419 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.38s]
[0m01:08:25.125419 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:08:25.131480 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:25.131480 [debug] [MainThread]: On master: BEGIN
[0m01:08:25.135495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:08:25.238951 [debug] [MainThread]: SQL status: BEGIN in 0.107 seconds
[0m01:08:25.243829 [debug] [MainThread]: On master: COMMIT
[0m01:08:25.245333 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:25.247928 [debug] [MainThread]: On master: COMMIT
[0m01:08:25.248981 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:08:25.250301 [debug] [MainThread]: On master: Close
[0m01:08:25.251526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:25.253174 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:08:25.253174 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:08:25.255902 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:08:25.258212 [info ] [MainThread]: 
[0m01:08:25.259443 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m01:08:25.264144 [debug] [MainThread]: Command end result
[0m01:08:25.445417 [info ] [MainThread]: 
[0m01:08:25.447272 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:08:25.450182 [info ] [MainThread]: 
[0m01:08:25.450692 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 38:           SELECT * FROM bonanalyse_data;
                                                  ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:08:25.455496 [info ] [MainThread]: 
[0m01:08:25.458015 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:08:25.463015 [debug] [MainThread]: Command `dbt run` failed at 01:08:25.463015 after 7.19 seconds
[0m01:08:25.463015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B744E3CB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B744C7C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B744C7F3E0>]}
[0m01:08:25.465581 [debug] [MainThread]: Flushing usage events
[0m01:08:38.584311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB50083E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB5072E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB500B050>]}


============================== 01:08:38.592446 | a09610fc-3c93-4a97-a3bf-94139f812447 ==============================
[0m01:08:38.592446 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:08:38.595530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m01:08:38.953674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a09610fc-3c93-4a97-a3bf-94139f812447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB58F77D0>]}
[0m01:08:39.018423 [debug] [MainThread]: Command `dbt clean` succeeded at 01:08:39.015408 after 0.69 seconds
[0m01:08:39.020757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB5072E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB48D5BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB572BE00>]}
[0m01:08:39.022302 [debug] [MainThread]: Flushing usage events
[0m01:08:48.888210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF6A22A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF8A2BBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF8A2B680>]}


============================== 01:08:48.896696 | a88181cd-a756-4711-b2ad-a7b56166e7c8 ==============================
[0m01:08:48.896696 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:08:48.899403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m01:08:49.308022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a88181cd-a756-4711-b2ad-a7b56166e7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF8F84980>]}
[0m01:08:49.479118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a88181cd-a756-4711-b2ad-a7b56166e7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF98500B0>]}
[0m01:08:49.485644 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:08:49.508928 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:08:49.512194 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:08:49.515416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a88181cd-a756-4711-b2ad-a7b56166e7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF989D7F0>]}
[0m01:08:52.665601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a88181cd-a756-4711-b2ad-a7b56166e7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFAFB4BC0>]}
[0m01:08:52.960910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a88181cd-a756-4711-b2ad-a7b56166e7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFAFFE9C0>]}
[0m01:08:52.963755 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:08:52.971555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88181cd-a756-4711-b2ad-a7b56166e7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF9F26480>]}
[0m01:08:52.977908 [info ] [MainThread]: 
[0m01:08:52.980213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:08:52.985513 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:08:53.256727 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:08:53.258231 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:08:53.261684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:53.411738 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.151 seconds
[0m01:08:53.417613 [debug] [ThreadPool]: On list_res: Close
[0m01:08:53.421839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:08:53.461179 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:08:53.465715 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:08:53.465715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:53.570368 [debug] [ThreadPool]: SQL status: BEGIN in 0.104 seconds
[0m01:08:53.570368 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:08:53.572384 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:08:53.584826 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m01:08:53.587655 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:08:53.590973 [debug] [ThreadPool]: On list_res_public: Close
[0m01:08:53.599648 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:53.605215 [debug] [MainThread]: On master: BEGIN
[0m01:08:53.605215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:08:53.765848 [debug] [MainThread]: SQL status: BEGIN in 0.159 seconds
[0m01:08:53.767773 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:53.769104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:08:53.782941 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m01:08:53.786956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88181cd-a756-4711-b2ad-a7b56166e7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF9DA15E0>]}
[0m01:08:53.789118 [debug] [MainThread]: On master: ROLLBACK
[0m01:08:53.791651 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:53.791651 [debug] [MainThread]: On master: BEGIN
[0m01:08:53.795476 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:08:53.797095 [debug] [MainThread]: On master: COMMIT
[0m01:08:53.798964 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:53.800208 [debug] [MainThread]: On master: COMMIT
[0m01:08:53.800208 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:08:53.800208 [debug] [MainThread]: On master: Close
[0m01:08:53.805338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:08:53.813827 [info ] [MainThread]: 
[0m01:08:53.824116 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:08:53.827282 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:08:53.833073 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:08:53.835153 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:08:53.880515 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:08:53.885545 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:08:54.177684 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:08:54.183406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:08:54.185524 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:08:54.187539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:08:54.311863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.127 seconds
[0m01:08:54.315150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:08:54.316739 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse_data AS (
              SELECT DISTINCT
                  b."idBonAnalyse", 
                  b."dateCreation", 
                  b."dateStatut", 
                  b."isActuel", 
                  b."montantInitial", 
                  b."numeroBA", 
                  eu.nom AS etablissement_universitaire_nom,
                  me.nom AS membreexterne_nom,
                  me.prenom AS membreexterne_prenom,
                  fac.nom AS faculteecole_nom
              FROM 
                  "res"."SC_App1"."bonanalyse" b
              INNER JOIN 
                  "res"."SC_App1"."membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
              INNER JOIN 
                  "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
              INNER JOIN 
                  "res"."SC_App1"."faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
              INNER JOIN 
                  "res"."SC_App1"."etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
              WHERE 
                  b."idProfesseur" IS NOT NULL 
                  AND dfac."idFaculteEcole" IS NOT NULL
          )
          SELECT * FROM bonanalyse_data;
  );
  
[0m01:08:54.319329 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 38:           SELECT * FROM bonanalyse_data;
                                                ^

[0m01:08:54.319329 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: ROLLBACK
[0m01:08:54.319329 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:08:54.335181 [debug] [Thread-1 (]: Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 38:           SELECT * FROM bonanalyse_data;
                                                  ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:08:54.342962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a88181cd-a756-4711-b2ad-a7b56166e7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF8EB8B60>]}
[0m01:08:54.346545 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.bonanalyse_prof_details ........... [[31mERROR[0m in 0.51s]
[0m01:08:54.355365 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:08:54.359107 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:54.361311 [debug] [MainThread]: On master: BEGIN
[0m01:08:54.364458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:08:54.475453 [debug] [MainThread]: SQL status: BEGIN in 0.113 seconds
[0m01:08:54.478811 [debug] [MainThread]: On master: COMMIT
[0m01:08:54.480376 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:54.481547 [debug] [MainThread]: On master: COMMIT
[0m01:08:54.482963 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:08:54.482963 [debug] [MainThread]: On master: Close
[0m01:08:54.485488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:54.486561 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:08:54.487857 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:08:54.487857 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:08:54.487857 [info ] [MainThread]: 
[0m01:08:54.492303 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m01:08:54.495527 [debug] [MainThread]: Command end result
[0m01:08:54.640359 [info ] [MainThread]: 
[0m01:08:54.642437 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:08:54.644499 [info ] [MainThread]: 
[0m01:08:54.646951 [error] [MainThread]:   Database Error in model bonanalyse_prof_details (models\example\bonanalyse_prof_details.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 38:           SELECT * FROM bonanalyse_data;
                                                  ^
  compiled Code at target\run\dbt_proj\models\example\bonanalyse_prof_details.sql
[0m01:08:54.648207 [info ] [MainThread]: 
[0m01:08:54.651884 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:08:54.651884 [debug] [MainThread]: Command `dbt run` failed at 01:08:54.651884 after 6.25 seconds
[0m01:08:54.655410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF94D9B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF94D8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF9F79430>]}
[0m01:08:54.655410 [debug] [MainThread]: Flushing usage events
[0m01:09:08.128919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DE4E5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DB964F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DDDA92B0>]}


============================== 01:09:08.136551 | 48335753-99a8-4e7f-9426-de73b95ce028 ==============================
[0m01:09:08.136551 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:09:08.139747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:09:08.619526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48335753-99a8-4e7f-9426-de73b95ce028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DE664170>]}
[0m01:09:08.775617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48335753-99a8-4e7f-9426-de73b95ce028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DE763C80>]}
[0m01:09:08.785615 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:09:08.808617 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:09:09.125534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:09:09.125534 [debug] [MainThread]: Partial parsing: updated file: dbt_proj://models\example\bonanalyse_prof_details.sql
[0m01:09:09.949055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48335753-99a8-4e7f-9426-de73b95ce028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DFE23440>]}
[0m01:09:10.218856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48335753-99a8-4e7f-9426-de73b95ce028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DFC4AFC0>]}
[0m01:09:10.218856 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:09:10.218856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48335753-99a8-4e7f-9426-de73b95ce028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DDD7F8F0>]}
[0m01:09:10.225383 [info ] [MainThread]: 
[0m01:09:10.225383 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:09:10.228888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:09:10.423924 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:09:10.425554 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:09:10.427104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:10.511822 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.085 seconds
[0m01:09:10.515494 [debug] [ThreadPool]: On list_res: Close
[0m01:09:10.519060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:09:10.529092 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:09:10.534030 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:09:10.534030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:10.612057 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m01:09:10.613713 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:09:10.613713 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:09:10.620025 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m01:09:10.625096 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:09:10.627520 [debug] [ThreadPool]: On list_res_public: Close
[0m01:09:10.636683 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:10.636683 [debug] [MainThread]: On master: BEGIN
[0m01:09:10.636683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:09:10.716343 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m01:09:10.716343 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:10.719449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:09:10.728118 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m01:09:10.728118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48335753-99a8-4e7f-9426-de73b95ce028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DFEF9EE0>]}
[0m01:09:10.728118 [debug] [MainThread]: On master: ROLLBACK
[0m01:09:10.735264 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:10.735264 [debug] [MainThread]: On master: BEGIN
[0m01:09:10.735264 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:09:10.740295 [debug] [MainThread]: On master: COMMIT
[0m01:09:10.740295 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:10.740295 [debug] [MainThread]: On master: COMMIT
[0m01:09:10.743316 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:09:10.743316 [debug] [MainThread]: On master: Close
[0m01:09:10.745435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:09:10.745435 [info ] [MainThread]: 
[0m01:09:10.755478 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:09:10.755478 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:09:10.759223 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:09:10.759223 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:09:10.780459 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:09:10.787542 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:09:10.896509 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:09:10.905359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:09:10.907453 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:09:10.908599 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:09:11.003165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.094 seconds
[0m01:09:11.005490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:09:11.007554 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse_data AS (
              SELECT DISTINCT
                  b."idBonAnalyse", 
                  b."dateCreation", 
                  b."dateStatut", 
                  b."isActuel", 
                  b."montantInitial", 
                  b."numeroBA", 
                  eu.nom AS etablissement_universitaire_nom,
                  me.nom AS membreexterne_nom,
                  me.prenom AS membreexterne_prenom,
                  fac.nom AS faculteecole_nom
              FROM 
                  "res"."SC_App1"."bonanalyse" b
              INNER JOIN 
                  "res"."SC_App1"."membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
              INNER JOIN 
                  "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
              INNER JOIN 
                  "res"."SC_App1"."faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
              INNER JOIN 
                  "res"."SC_App1"."etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
              WHERE 
                  b."idProfesseur" IS NOT NULL 
                  AND dfac."idFaculteEcole" IS NOT NULL
          )
          SELECT * FROM bonanalyse_data
  );
  
[0m01:09:11.039505 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.032 seconds
[0m01:09:11.061464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:09:11.065484 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details" rename to "bonanalyse_prof_details__dbt_backup"
[0m01:09:11.068125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:09:11.079471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:09:11.080684 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details__dbt_tmp" rename to "bonanalyse_prof_details"
[0m01:09:11.082423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:09:11.128945 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m01:09:11.128945 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:09:11.131295 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m01:09:11.133818 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:09:11.145289 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."bonanalyse_prof_details__dbt_backup"
[0m01:09:11.159217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:09:11.159217 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
drop table if exists "res"."public"."bonanalyse_prof_details__dbt_backup" cascade
[0m01:09:11.165568 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:09:11.170298 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:09:11.175407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48335753-99a8-4e7f-9426-de73b95ce028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DC0C7950>]}
[0m01:09:11.175407 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.bonanalyse_prof_details ............... [[32mSELECT 11[0m in 0.41s]
[0m01:09:11.180055 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:09:11.184159 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:11.185488 [debug] [MainThread]: On master: BEGIN
[0m01:09:11.185488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:09:11.277894 [debug] [MainThread]: SQL status: BEGIN in 0.091 seconds
[0m01:09:11.279013 [debug] [MainThread]: On master: COMMIT
[0m01:09:11.279524 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:11.279524 [debug] [MainThread]: On master: COMMIT
[0m01:09:11.282198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:09:11.283717 [debug] [MainThread]: On master: Close
[0m01:09:11.285227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:11.285227 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:09:11.287941 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:09:11.287941 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:09:11.287941 [info ] [MainThread]: 
[0m01:09:11.292134 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m01:09:11.295148 [debug] [MainThread]: Command end result
[0m01:09:11.388217 [info ] [MainThread]: 
[0m01:09:11.391777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:09:11.391777 [info ] [MainThread]: 
[0m01:09:11.395292 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:09:11.400204 [debug] [MainThread]: Command `dbt run` succeeded at 01:09:11.400204 after 3.55 seconds
[0m01:09:11.404624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DE4C9A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DB59B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DDC02FC0>]}
[0m01:09:11.405133 [debug] [MainThread]: Flushing usage events
[0m01:11:11.086075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461C2CFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461DDCE360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461B44B320>]}


============================== 01:11:11.095566 | 97d94ca6-b87e-4dbb-a29e-167f902601e9 ==============================
[0m01:11:11.095566 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:11:11.096581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m01:11:11.401189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97d94ca6-b87e-4dbb-a29e-167f902601e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461E26A4B0>]}
[0m01:11:11.458482 [debug] [MainThread]: Command `dbt clean` succeeded at 01:11:11.457271 after 0.96 seconds
[0m01:11:11.459496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461F20F140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461E8435F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001461ED720C0>]}
[0m01:11:11.460545 [debug] [MainThread]: Flushing usage events
[0m01:11:18.307077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65507CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E657AB2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65548B080>]}


============================== 01:11:18.313087 | 30c26566-aeb1-40a2-bf9a-4f39e7a5184a ==============================
[0m01:11:18.313087 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:11:18.315164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:11:18.666454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30c26566-aeb1-40a2-bf9a-4f39e7a5184a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65585CAA0>]}
[0m01:11:18.790657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30c26566-aeb1-40a2-bf9a-4f39e7a5184a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E657DBA930>]}
[0m01:11:18.793210 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:11:18.809499 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:11:18.815660 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:11:18.817616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30c26566-aeb1-40a2-bf9a-4f39e7a5184a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E657ED6AE0>]}
[0m01:11:21.894710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30c26566-aeb1-40a2-bf9a-4f39e7a5184a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65965A510>]}
[0m01:11:22.186387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30c26566-aeb1-40a2-bf9a-4f39e7a5184a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6595CEBD0>]}
[0m01:11:22.189902 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:11:22.189902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c26566-aeb1-40a2-bf9a-4f39e7a5184a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6595D4A40>]}
[0m01:11:22.196460 [info ] [MainThread]: 
[0m01:11:22.199970 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:11:22.204831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:11:22.429485 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:11:22.429485 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:11:22.431504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:22.602192 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.169 seconds
[0m01:11:22.606128 [debug] [ThreadPool]: On list_res: Close
[0m01:11:22.612587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:11:22.630345 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:11:22.630345 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:11:22.634911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:22.750115 [debug] [ThreadPool]: SQL status: BEGIN in 0.118 seconds
[0m01:11:22.755690 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:11:22.755690 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:11:22.768293 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m01:11:22.772617 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:11:22.774984 [debug] [ThreadPool]: On list_res_public: Close
[0m01:11:22.784642 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:22.789693 [debug] [MainThread]: On master: BEGIN
[0m01:11:22.789693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:11:22.889663 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m01:11:22.889663 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:22.893772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:11:22.907239 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m01:11:22.912322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c26566-aeb1-40a2-bf9a-4f39e7a5184a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6595CFFE0>]}
[0m01:11:22.915894 [debug] [MainThread]: On master: ROLLBACK
[0m01:11:22.915894 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:22.918219 [debug] [MainThread]: On master: BEGIN
[0m01:11:22.918219 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:11:22.921712 [debug] [MainThread]: On master: COMMIT
[0m01:11:22.922727 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:22.924832 [debug] [MainThread]: On master: COMMIT
[0m01:11:22.924832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:11:22.924832 [debug] [MainThread]: On master: Close
[0m01:11:22.930890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:22.932200 [info ] [MainThread]: 
[0m01:11:22.940440 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:11:22.943304 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:11:22.945858 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:11:22.947371 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:11:22.970109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:11:22.974748 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:11:23.115906 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:11:23.119117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:11:23.119117 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:11:23.124696 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:11:23.219809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m01:11:23.220828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:11:23.221959 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse_data AS (
              SELECT DISTINCT
                  b."idBonAnalyse", 
                  b."dateCreation", 
                  b."dateStatut", 
                  b."isActuel", 
                  b."montantInitial", 
                  b."numeroBA", 
                  eu.nom AS etablissement_universitaire_nom,
                  me.nom AS membreexterne_nom,
                  me.prenom AS membreexterne_prenom,
                  fac.nom AS faculteecole_nom
              FROM 
                  "res"."SC_App1"."bonanalyse" b
              INNER JOIN 
                  "res"."SC_App1"."membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
              INNER JOIN 
                  "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
              INNER JOIN 
                  "res"."SC_App1"."faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
              INNER JOIN 
                  "res"."SC_App1"."etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
              WHERE 
                  b."idProfesseur" IS NOT NULL 
                  AND dfac."idFaculteEcole" IS NOT NULL
          )
          SELECT * FROM bonanalyse_data
  );
  
[0m01:11:23.245026 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.022 seconds
[0m01:11:23.331585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:11:23.336187 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details" rename to "bonanalyse_prof_details__dbt_backup"
[0m01:11:23.338217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:23.344731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:11:23.345812 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details__dbt_tmp" rename to "bonanalyse_prof_details"
[0m01:11:23.348341 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:23.391350 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m01:11:23.395095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:11:23.396107 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m01:11:23.400140 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:11:23.415170 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."bonanalyse_prof_details__dbt_backup"
[0m01:11:23.424769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:11:23.428865 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
drop table if exists "res"."public"."bonanalyse_prof_details__dbt_backup" cascade
[0m01:11:23.436128 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:11:23.437651 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:11:23.448063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c26566-aeb1-40a2-bf9a-4f39e7a5184a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E659CEBA40>]}
[0m01:11:23.450195 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.bonanalyse_prof_details ............... [[32mSELECT 11[0m in 0.50s]
[0m01:11:23.451325 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:11:23.456035 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:23.456035 [debug] [MainThread]: On master: BEGIN
[0m01:11:23.456035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:11:23.565040 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m01:11:23.568597 [debug] [MainThread]: On master: COMMIT
[0m01:11:23.570169 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:23.570686 [debug] [MainThread]: On master: COMMIT
[0m01:11:23.570686 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:11:23.573482 [debug] [MainThread]: On master: Close
[0m01:11:23.575029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:23.576077 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:11:23.577089 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:11:23.578710 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:11:23.578710 [info ] [MainThread]: 
[0m01:11:23.578710 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m01:11:23.586110 [debug] [MainThread]: Command end result
[0m01:11:23.678666 [info ] [MainThread]: 
[0m01:11:23.681123 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:23.681123 [info ] [MainThread]: 
[0m01:11:23.684641 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:11:23.687782 [debug] [MainThread]: Command `dbt run` succeeded at 01:11:23.687782 after 5.62 seconds
[0m01:11:23.689300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E657B7C740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65450B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6594395B0>]}
[0m01:11:23.689300 [debug] [MainThread]: Flushing usage events
[0m01:18:57.181972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C97560FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C977B94980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C977ED4260>]}


============================== 01:18:57.186507 | be1400c6-7a9b-483c-8176-9102488e4bce ==============================
[0m01:18:57.186507 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:18:57.186507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:18:57.663260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be1400c6-7a9b-483c-8176-9102488e4bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C97808AFC0>]}
[0m01:18:57.836602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be1400c6-7a9b-483c-8176-9102488e4bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9780B1880>]}
[0m01:18:57.839705 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:18:57.874366 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:18:58.324597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:18:58.324597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:18:58.411672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be1400c6-7a9b-483c-8176-9102488e4bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9785FC890>]}
[0m01:18:58.708493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be1400c6-7a9b-483c-8176-9102488e4bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9797A0B30>]}
[0m01:18:58.709722 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:18:58.709722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be1400c6-7a9b-483c-8176-9102488e4bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9796DC110>]}
[0m01:18:58.715869 [info ] [MainThread]: 
[0m01:18:58.716886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:18:58.721863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:18:58.977473 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:18:58.979624 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:18:58.981382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:59.071365 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.092 seconds
[0m01:18:59.073377 [debug] [ThreadPool]: On list_res: Close
[0m01:18:59.073377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:18:59.093436 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:18:59.093436 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:18:59.093436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:59.176203 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m01:18:59.176203 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:18:59.178759 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:18:59.189440 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m01:18:59.193464 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:18:59.194600 [debug] [ThreadPool]: On list_res_public: Close
[0m01:18:59.211120 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:59.212226 [debug] [MainThread]: On master: BEGIN
[0m01:18:59.213350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:59.293461 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m01:18:59.293461 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:59.293461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:18:59.309446 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m01:18:59.312295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be1400c6-7a9b-483c-8176-9102488e4bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C979D290A0>]}
[0m01:18:59.313486 [debug] [MainThread]: On master: ROLLBACK
[0m01:18:59.313486 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:59.315499 [debug] [MainThread]: On master: BEGIN
[0m01:18:59.318957 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:18:59.320207 [debug] [MainThread]: On master: COMMIT
[0m01:18:59.321384 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:59.321937 [debug] [MainThread]: On master: COMMIT
[0m01:18:59.323567 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:18:59.323567 [debug] [MainThread]: On master: Close
[0m01:18:59.326881 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:59.326881 [info ] [MainThread]: 
[0m01:18:59.334275 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:18:59.334275 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:18:59.334275 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:18:59.341517 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:18:59.363207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:18:59.367029 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:18:59.480116 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:18:59.484685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:18:59.488876 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:18:59.491204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:18:59.593752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.103 seconds
[0m01:18:59.596159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:18:59.597244 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse_data AS (
              SELECT DISTINCT
                  b."idBonAnalyse", 
                  b."dateCreation", 
                  b."dateStatut", 
                  b."isActuel", 
                  b."montantInitial", 
                  b."numeroBA", 
                  eu.nom AS etablissement_universitaire_nom,
                  me.nom AS membreexterne_nom,
                  me.prenom AS membreexterne_prenom,
                  fac.nom AS faculteecole_nom
              FROM 
                  "res"."SC_App1"."bonanalyse" b
              INNER JOIN 
                  "res"."SC_App1"."membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
              INNER JOIN 
                  "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
              INNER JOIN 
                  "res"."SC_App1"."faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
              INNER JOIN 
                  "res"."SC_App1"."etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
              WHERE 
                  b."idProfesseur" IS NOT NULL 
                  AND dfac."idFaculteEcole" IS NOT NULL
          )
          SELECT * FROM bonanalyse_data
  );
  
[0m01:18:59.633336 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.033 seconds
[0m01:18:59.649806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:18:59.652245 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details" rename to "bonanalyse_prof_details__dbt_backup"
[0m01:18:59.653278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:59.661508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:18:59.663611 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details__dbt_tmp" rename to "bonanalyse_prof_details"
[0m01:18:59.667118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:59.722440 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m01:18:59.723453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:18:59.724505 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m01:18:59.728036 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:18:59.748393 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."bonanalyse_prof_details__dbt_backup"
[0m01:18:59.766683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:18:59.766683 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
drop table if exists "res"."public"."bonanalyse_prof_details__dbt_backup" cascade
[0m01:18:59.774745 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:18:59.776386 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:18:59.785182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be1400c6-7a9b-483c-8176-9102488e4bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9797BEAB0>]}
[0m01:18:59.787860 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.bonanalyse_prof_details ............... [[32mSELECT 11[0m in 0.45s]
[0m01:18:59.790791 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:18:59.793401 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:59.793401 [debug] [MainThread]: On master: BEGIN
[0m01:18:59.796082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:59.899736 [debug] [MainThread]: SQL status: BEGIN in 0.104 seconds
[0m01:18:59.901806 [debug] [MainThread]: On master: COMMIT
[0m01:18:59.903324 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:59.903324 [debug] [MainThread]: On master: COMMIT
[0m01:18:59.907087 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:18:59.907087 [debug] [MainThread]: On master: Close
[0m01:18:59.907087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:59.913606 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:18:59.915168 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:18:59.916188 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:18:59.916188 [info ] [MainThread]: 
[0m01:18:59.920897 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m01:18:59.923293 [debug] [MainThread]: Command end result
[0m01:19:00.023222 [info ] [MainThread]: 
[0m01:19:00.035940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:19:00.059001 [info ] [MainThread]: 
[0m01:19:00.074537 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:19:00.091202 [debug] [MainThread]: Command `dbt run` succeeded at 01:19:00.090104 after 3.81 seconds
[0m01:19:00.095220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C97560FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9796DC3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C97803E8D0>]}
[0m01:19:00.099379 [debug] [MainThread]: Flushing usage events
[0m01:21:26.924918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE51E699A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE51E6BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE51E69A90>]}


============================== 01:21:26.929017 | f423e538-b6c7-4c90-ae43-7c2aea9567c0 ==============================
[0m01:21:26.929017 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:21:26.933161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:21:27.231404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f423e538-b6c7-4c90-ae43-7c2aea9567c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE51B9F8C0>]}
[0m01:21:27.307730 [debug] [MainThread]: Command `dbt clean` succeeded at 01:21:27.306461 after 1.14 seconds
[0m01:21:27.309176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE51E36630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE51F9E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE5214EB10>]}
[0m01:21:27.311021 [debug] [MainThread]: Flushing usage events
[0m01:21:33.988059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE5A3B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE7BFE780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE7BFC230>]}


============================== 01:21:33.998735 | 7e424251-c4f7-4b01-ae8f-e3162dd06f3b ==============================
[0m01:21:33.998735 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:21:34.004359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:21:34.369031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e424251-c4f7-4b01-ae8f-e3162dd06f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE85DCFB0>]}
[0m01:21:34.479956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e424251-c4f7-4b01-ae8f-e3162dd06f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE85B3C80>]}
[0m01:21:34.483078 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:21:34.502849 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:21:34.502849 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:21:34.509082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e424251-c4f7-4b01-ae8f-e3162dd06f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE8576AE0>]}
[0m01:21:36.843220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e424251-c4f7-4b01-ae8f-e3162dd06f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE85B0830>]}
[0m01:21:37.048090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e424251-c4f7-4b01-ae8f-e3162dd06f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE9C7D670>]}
[0m01:21:37.049757 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:21:37.049757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e424251-c4f7-4b01-ae8f-e3162dd06f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE9C40C50>]}
[0m01:21:37.052840 [info ] [MainThread]: 
[0m01:21:37.052840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:21:37.059028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:21:37.265977 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:21:37.267498 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:21:37.269009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:37.366739 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.097 seconds
[0m01:21:37.370905 [debug] [ThreadPool]: On list_res: Close
[0m01:21:37.374328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:21:37.389001 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:21:37.389001 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:21:37.391755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:37.484992 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m01:21:37.484992 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:21:37.484992 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:21:37.501144 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m01:21:37.505982 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:21:37.507597 [debug] [ThreadPool]: On list_res_public: Close
[0m01:21:37.524893 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:37.524893 [debug] [MainThread]: On master: BEGIN
[0m01:21:37.524893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:21:37.619169 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m01:21:37.622762 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:37.622762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:21:37.633155 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m01:21:37.636730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e424251-c4f7-4b01-ae8f-e3162dd06f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE9C6A600>]}
[0m01:21:37.637277 [debug] [MainThread]: On master: ROLLBACK
[0m01:21:37.637277 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:37.637277 [debug] [MainThread]: On master: BEGIN
[0m01:21:37.640839 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:21:37.640839 [debug] [MainThread]: On master: COMMIT
[0m01:21:37.642965 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:37.644538 [debug] [MainThread]: On master: COMMIT
[0m01:21:37.646074 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:21:37.647682 [debug] [MainThread]: On master: Close
[0m01:21:37.647682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:21:37.651670 [info ] [MainThread]: 
[0m01:21:37.655175 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:21:37.659750 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:21:37.661719 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:21:37.662784 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:21:37.687789 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:21:37.687789 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:21:37.799739 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:21:37.802764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:21:37.802764 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:21:37.802764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:21:37.906348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.100 seconds
[0m01:21:37.907439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:21:37.908941 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse_data AS (
              SELECT DISTINCT
                  b."idBonAnalyse", 
                  b."dateCreation", 
                  b."dateStatut", 
                  b."isActuel", 
                  b."montantInitial", 
                  b."numeroBA", 
                  eu.nom AS etablissement_universitaire_nom,
                  concat(me.prenom, ' - ', me.nom) AS professeur,
                  me.cin,
                  concat(fac.nom, ' - ', eu.nom) AS faculteecole_nom
              FROM 
                  "res"."SC_App1"."bonanalyse" b
              INNER JOIN 
                  "res"."SC_App1"."membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
              INNER JOIN 
                  "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
              INNER JOIN 
                  "res"."SC_App1"."faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
              INNER JOIN 
                  "res"."SC_App1"."etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
              WHERE 
                  b."idProfesseur" IS NOT NULL 
                  AND dfac."idFaculteEcole" IS NOT NULL
          )
          SELECT * FROM bonanalyse_data
  );
  
[0m01:21:37.941400 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.031 seconds
[0m01:21:38.038030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:21:38.043081 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details" rename to "bonanalyse_prof_details__dbt_backup"
[0m01:21:38.043081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:21:38.054486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:21:38.054999 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details__dbt_tmp" rename to "bonanalyse_prof_details"
[0m01:21:38.057492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:21:38.122674 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m01:21:38.128854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:21:38.128854 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m01:21:38.133377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:21:38.152068 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."bonanalyse_prof_details__dbt_backup"
[0m01:21:38.162766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:21:38.165877 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
drop table if exists "res"."public"."bonanalyse_prof_details__dbt_backup" cascade
[0m01:21:38.173212 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m01:21:38.179666 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:21:38.184524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e424251-c4f7-4b01-ae8f-e3162dd06f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE9B31970>]}
[0m01:21:38.187614 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.bonanalyse_prof_details ............... [[32mSELECT 11[0m in 0.52s]
[0m01:21:38.190090 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:21:38.192815 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:38.194727 [debug] [MainThread]: On master: BEGIN
[0m01:21:38.196781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:21:38.283104 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m01:21:38.288162 [debug] [MainThread]: On master: COMMIT
[0m01:21:38.288162 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:38.288162 [debug] [MainThread]: On master: COMMIT
[0m01:21:38.288162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:21:38.292311 [debug] [MainThread]: On master: Close
[0m01:21:38.292838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:38.292838 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:21:38.295675 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:21:38.297073 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:21:38.299482 [info ] [MainThread]: 
[0m01:21:38.299482 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m01:21:38.304084 [debug] [MainThread]: Command end result
[0m01:21:38.386487 [info ] [MainThread]: 
[0m01:21:38.389118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:21:38.390182 [info ] [MainThread]: 
[0m01:21:38.392690 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:21:38.397136 [debug] [MainThread]: Command `dbt run` succeeded at 01:21:38.397136 after 4.65 seconds
[0m01:21:38.400598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE5A3B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE9BF5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE8369520>]}
[0m01:21:38.402859 [debug] [MainThread]: Flushing usage events
[0m01:22:28.596110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002324D2FD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002324DF06E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023250D01C70>]}


============================== 01:22:28.602629 | b6cb4c6a-4655-400e-bfc8-af51bc15b9e7 ==============================
[0m01:22:28.602629 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:22:28.602629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m01:22:28.844782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6cb4c6a-4655-400e-bfc8-af51bc15b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023250118E00>]}
[0m01:22:28.896318 [debug] [MainThread]: Command `dbt clean` succeeded at 01:22:28.896318 after 0.57 seconds
[0m01:22:28.896318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002324D2FD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023250191E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023250C16CC0>]}
[0m01:22:28.896318 [debug] [MainThread]: Flushing usage events
[0m01:22:37.297867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E179823860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E178EDB2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17C6266F0>]}


============================== 01:22:37.304597 | 35d29083-49da-4a60-9316-3e4303a28f6f ==============================
[0m01:22:37.304597 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:22:37.304597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ADMIN\\Desktop\\dbt_test\\dbt_proj\\logs', 'profiles_dir': 'C:\\Users\\ADMIN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:22:37.753968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35d29083-49da-4a60-9316-3e4303a28f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17C8CCAD0>]}
[0m01:22:37.904182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35d29083-49da-4a60-9316-3e4303a28f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17C7A7770>]}
[0m01:22:37.912830 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:22:37.937064 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:22:37.937064 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:22:37.942615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35d29083-49da-4a60-9316-3e4303a28f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17C8A7B60>]}
[0m01:22:41.234985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35d29083-49da-4a60-9316-3e4303a28f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17C6A3440>]}
[0m01:22:41.442585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35d29083-49da-4a60-9316-3e4303a28f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17DFB1070>]}
[0m01:22:41.442585 [info ] [MainThread]: Found 1 model, 5 sources, 415 macros
[0m01:22:41.442585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d29083-49da-4a60-9316-3e4303a28f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17DF8BA40>]}
[0m01:22:41.451301 [info ] [MainThread]: 
[0m01:22:41.452821 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:22:41.458028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res'
[0m01:22:41.726640 [debug] [ThreadPool]: Using postgres connection "list_res"
[0m01:22:41.726640 [debug] [ThreadPool]: On list_res: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res"} */

    select distinct nspname from pg_namespace
  
[0m01:22:41.729621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:41.833567 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.104 seconds
[0m01:22:41.839574 [debug] [ThreadPool]: On list_res: Close
[0m01:22:41.844554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_res_public'
[0m01:22:41.859369 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:22:41.862880 [debug] [ThreadPool]: On list_res_public: BEGIN
[0m01:22:41.866805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:41.955305 [debug] [ThreadPool]: SQL status: BEGIN in 0.089 seconds
[0m01:22:41.955305 [debug] [ThreadPool]: Using postgres connection "list_res_public"
[0m01:22:41.955305 [debug] [ThreadPool]: On list_res_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "list_res_public"} */
select
      'res' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'res' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:22:41.966582 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m01:22:41.971711 [debug] [ThreadPool]: On list_res_public: ROLLBACK
[0m01:22:41.972770 [debug] [ThreadPool]: On list_res_public: Close
[0m01:22:41.984572 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:41.984572 [debug] [MainThread]: On master: BEGIN
[0m01:22:41.984572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:22:42.073040 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m01:22:42.077437 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:42.077950 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:22:42.089140 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m01:22:42.089140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d29083-49da-4a60-9316-3e4303a28f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17C9F53A0>]}
[0m01:22:42.092691 [debug] [MainThread]: On master: ROLLBACK
[0m01:22:42.092691 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:42.095334 [debug] [MainThread]: On master: BEGIN
[0m01:22:42.098038 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:22:42.099073 [debug] [MainThread]: On master: COMMIT
[0m01:22:42.099073 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:42.099073 [debug] [MainThread]: On master: COMMIT
[0m01:22:42.102585 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:22:42.104017 [debug] [MainThread]: On master: Close
[0m01:22:42.106216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:22:42.107260 [info ] [MainThread]: 
[0m01:22:42.118012 [debug] [Thread-1 (]: Began running node model.dbt_proj.bonanalyse_prof_details
[0m01:22:42.120169 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bonanalyse_prof_details .................... [RUN]
[0m01:22:42.123023 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_proj.bonanalyse_prof_details'
[0m01:22:42.124350 [debug] [Thread-1 (]: Began compiling node model.dbt_proj.bonanalyse_prof_details
[0m01:22:42.147184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:22:42.157130 [debug] [Thread-1 (]: Began executing node model.dbt_proj.bonanalyse_prof_details
[0m01:22:42.292513 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj.bonanalyse_prof_details"
[0m01:22:42.295178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:22:42.300124 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: BEGIN
[0m01:22:42.302735 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:22:42.407789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.104 seconds
[0m01:22:42.408310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:22:42.409586 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */

  
    

  create  table "res"."public"."bonanalyse_prof_details__dbt_tmp"
  
  
    as
  
  (
    WITH bonanalyse_data AS (
              SELECT DISTINCT
                  b."idBonAnalyse", 
                  b."dateCreation", 
                  b."dateStatut", 
                  b."isActuel", 
                  b."montantInitial", 
                  b."numeroBA", 
                  eu.nom AS etablissement_universitaire_nom,
                  concat(me.prenom, ' ', me.nom) AS professeur,
                  me.cin,
                  concat(fac.nom, ' - ', eu.nom) AS faculteecole_nom
              FROM 
                  "res"."SC_App1"."bonanalyse" b
              INNER JOIN 
                  "res"."SC_App1"."membreexterne" me ON b."idProfesseur" = me."idMembreExterne"
              INNER JOIN 
                  "res"."SC_App1"."detailfaculteecoleprofesseur" dfac ON me."idMembreExterne" = dfac."idProfesseur"
              INNER JOIN 
                  "res"."SC_App1"."faculteecole" fac ON dfac."idFaculteEcole" = fac."idFaculteEcole"
              INNER JOIN 
                  "res"."SC_App1"."etablissementuniversitaire" eu ON fac."idEtablissementUniversitaire" = eu."idEtablissementUniversitaire"
              WHERE 
                  b."idProfesseur" IS NOT NULL 
                  AND dfac."idFaculteEcole" IS NOT NULL
          )
          SELECT * FROM bonanalyse_data
  );
  
[0m01:22:42.427621 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.017 seconds
[0m01:22:42.512835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:22:42.514382 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details" rename to "bonanalyse_prof_details__dbt_backup"
[0m01:22:42.514382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:22:42.523006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:22:42.528019 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
alter table "res"."public"."bonanalyse_prof_details__dbt_tmp" rename to "bonanalyse_prof_details"
[0m01:22:42.529855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:22:42.578434 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m01:22:42.578434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:22:42.580963 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: COMMIT
[0m01:22:42.582542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:22:42.598654 [debug] [Thread-1 (]: Applying DROP to: "res"."public"."bonanalyse_prof_details__dbt_backup"
[0m01:22:42.605598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_proj.bonanalyse_prof_details"
[0m01:22:42.605598 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_proj", "target_name": "dev", "node_id": "model.dbt_proj.bonanalyse_prof_details"} */
drop table if exists "res"."public"."bonanalyse_prof_details__dbt_backup" cascade
[0m01:22:42.613873 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:22:42.613873 [debug] [Thread-1 (]: On model.dbt_proj.bonanalyse_prof_details: Close
[0m01:22:42.622854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d29083-49da-4a60-9316-3e4303a28f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17DFF94F0>]}
[0m01:22:42.624780 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.bonanalyse_prof_details ............... [[32mSELECT 11[0m in 0.49s]
[0m01:22:42.624780 [debug] [Thread-1 (]: Finished running node model.dbt_proj.bonanalyse_prof_details
[0m01:22:42.628290 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:42.630341 [debug] [MainThread]: On master: BEGIN
[0m01:22:42.630341 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:22:42.742912 [debug] [MainThread]: SQL status: BEGIN in 0.111 seconds
[0m01:22:42.744454 [debug] [MainThread]: On master: COMMIT
[0m01:22:42.745511 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:42.747552 [debug] [MainThread]: On master: COMMIT
[0m01:22:42.747552 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:22:42.747552 [debug] [MainThread]: On master: Close
[0m01:22:42.751416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:42.751416 [debug] [MainThread]: Connection 'list_res' was properly closed.
[0m01:22:42.753045 [debug] [MainThread]: Connection 'list_res_public' was properly closed.
[0m01:22:42.754518 [debug] [MainThread]: Connection 'model.dbt_proj.bonanalyse_prof_details' was properly closed.
[0m01:22:42.754518 [info ] [MainThread]: 
[0m01:22:42.758037 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m01:22:42.761391 [debug] [MainThread]: Command end result
[0m01:22:42.982922 [info ] [MainThread]: 
[0m01:22:42.986779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:22:42.994018 [info ] [MainThread]: 
[0m01:22:42.995383 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:22:43.016062 [debug] [MainThread]: Command `dbt run` succeeded at 01:22:43.014545 after 5.95 seconds
[0m01:22:43.016062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E179823860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17E6E97F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E17A39EE70>]}
[0m01:22:43.021358 [debug] [MainThread]: Flushing usage events
